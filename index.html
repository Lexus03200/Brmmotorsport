<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BRMOTORSPORT - Performance Automobile</title>
    <!-- Intégration de Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Intégration de React et ReactDOM CDN -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <!-- Intégration de Babel pour transpiler le JSX directement dans le navigateur -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- Firebase CDN Imports (AJOUTÉS POUR LA GESTION D'UPLOAD ET DE CONTENU) -->
    <script type="module">
      import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
      import { getAuth, signInWithCustomToken, onAuthStateChanged, signInAnonymously } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
      import { getFirestore, doc, getDoc, setDoc, collection, onSnapshot, query, addDoc, deleteDoc } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";
      import { getStorage, ref, uploadBytes, getDownloadURL, deleteObject } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-storage.js";

      // Expose Firebase services to the global window object for use in text/babel script
      window.firebase = {
        initializeApp,
        getAuth, signInWithCustomToken, onAuthStateChanged, signInAnonymously,
        getFirestore, doc, getDoc, setDoc, collection, onSnapshot, query, addDoc, deleteDoc,
        getStorage, ref, uploadBytes, getDownloadURL, deleteObject
      };
    </script>

    <style>
        /* Importation de la police Inter */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            margin: 0;
            padding: 0;
            overflow-x: hidden; /* Empêche le défilement horizontal */
        }
        /* Keyframes pour les animations */
        @keyframes fadeInDown {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        @keyframes bounceIn {
            0%, 20%, 40%, 60%, 80%, 100% {
                transition-timing-function: cubic-bezier(0.215, 0.610, 0.355, 1.000);
            }
            0% { opacity: 0; transform: scale3d(.3, .3, .3); }
            20% { transform: scale3d(1.1, 1.1, 1.1); }
            40% { transform: scale3d(.9, .9, .9); }
            60% { opacity: 1; transform: scale3d(1.03, 1.03, 1.03); }
            80% { transform: scale3d(.97, .97, .97); }
            100% { opacity: 1; transform: scale3d(1, 1, 1); }
        }
        @keyframes blob {
            0% { transform: translate(0px, 0px) scale(1); }
            33% { transform: translate(30px, -50px) scale(1.1); }
            66% { transform: translate(-20px, 20px) scale(0.9); }
            100% { transform: translate(0px, 0px) scale(1); }
        }
        /* Nouvelle animation pour le défilement de la bannière */
        @keyframes scrollText {
            0% { transform: translateX(0%); }
            100% { transform: translateX(-100%); }
        }
        /* Nouvelle animation pour le titre - Coulissement depuis la gauche */
        @keyframes slideInFromLeft {
            from {
                transform: translateX(-100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
        /* Nouvelle animation pour l'effet de vibration (plus douce) */
        @keyframes vibrate {
            0% { transform: translate(0px, 0px); }
            25% { transform: translate(-0.5px, 0.5px); } /* Mouvement réduit */
            50% { transform: translate(0.5px, -0.5px); }
            75% { transform: translate(-0.5px, -0.5px); }
            100% { transform: translate(0px, 0px); }
        }

        .animate-fade-in-down { animation: fadeInDown 0.8s ease-out forwards; }
        .animate-fade-in-up { animation: fadeInUp 0.8s ease-out forwards; }
        .animate-fade-in { animation: fadeIn 0.8s ease-out forwards; }
        .animate-bounce-in { animation: bounceIn 1s; }
        .animate-blob { animation: blob 7s infinite; }
        .animate-vibrate { animation: vibrate 0.15s ease-in-out infinite; } /* Vitesse ajustée à 0.15s */
        .animation-delay-2000 { animation-delay: 2s; }
        .animation-delay-4000 { animation-delay: 4s; }
        /* Style pour l'animation de défilement */
        .scrolling-banner-text {
            display: inline-block;
            white-space: nowrap;
            animation: scrollText 30s linear infinite; /* 30s pour la durée, linear pour un mouvement fluide, infinite pour la répétition */
        }
        /* Pour assurer que le texte déborde et puisse défiler */
        .scrolling-banner-container {
            overflow: hidden;
        }
        /* Application de l'animation de coulissement pour le titre */
        .animate-slide-in-left {
            animation: slideInFromLeft 1s ease-out forwards; /* Durée et type d'animation */
        }

        /* Styles supplémentaires pour des effets visuels */
        h1, h2 {
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5); /* Ombre subtile pour la profondeur */
        }
        /* Utilitaire pour décalage d'animation */
        .delay-animation {
            animation-delay: var(--delay-factor);
        }

        /* Styles spécifiques pour la Lightbox (modale) */
        .lightbox-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 100;
            animation: fadeIn 0.3s ease-out forwards;
        }

        .lightbox-content {
            position: relative;
            max-width: 90%;
            max-height: 90%;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .lightbox-image {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
            border-radius: 0.75rem;
        }

        .lightbox-button {
            background-color: rgba(0, 0, 0, 0.5);
            color: white;
            padding: 0.75rem;
            border-radius: 9999px; /* fully rounded */
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background-color 0.2s ease-in-out;
            cursor: pointer;
            position: absolute;
            z-index: 101;
        }

        .lightbox-button:hover {
            background-color: rgba(0, 0, 0, 0.8);
        }

        .lightbox-close-button {
            top: 1rem;
            right: 1rem;
        }

        .lightbox-prev-button {
            left: 1rem;
            top: 50%;
            transform: translateY(-50%);
        }

        .lightbox-next-button {
            right: 1rem;
            top: 50%;
            transform: translateY(-50%);
        }
    </style>
</head>
<body class="min-h-screen bg-black font-inter">
    <!-- Section Audio de fond -->
    <audio id="background-music" autoplay loop volume="0.01" style="display:none;">
        <source src="musique.mp3" type="audio/mpeg">
        Votre navigateur ne supporte pas l'élément audio.
    </audio>

    <div id="root"></div>

    <!-- Le type du script a été changé en "text/babel" pour le transpiler -->
    <script type="text/babel">
        // Récupère les hooks React depuis l'objet global React
        const { useState, useEffect, useRef, createContext, useContext } = React;

        // Définition des instances Firebase (initialisées dans le composant App)
        let firebaseApp, db, storage;

        // --- Icônes Lucide React ---
        const CarIcon = () => (
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="lucide lucide-car">
            <path d="M19 17H5c-1.1 0-2 .9-2 2v2h18v-2c0-1.1-.9-2-2-2Z"/><path d="M7 17V5h12v12"/><path d="M18 10h-8"/><path d="M10 10v7"/>
          </svg>
        );

        const HandshakeIcon = () => (
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="lucide lucude-handshake">
            <path d="M12.23 20.73a4.7 4.7 0 0 0 6.64-6.64L12.23 7.07l-2.06 2.06"/><path d="M16 16l-3.23 3.23a4.7 4.7 0 0 1-6.64-6.64L9.07 7.07l2.06 2.06"/><path d="M14 10l-2.06 2.06"/><path d="m10 14 2.06-2.06"/>
          </svg>
        );

        const WrenchIcon = () => (
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="lucide lucide-wrench">
            <path d="M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-3.77 3.77a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 [Circular Object]"/>
            <path d="M5.5 12.5l-3-3L12.5 2.5l3 3z"/>
          </svg>
        );

        const CalendarIcon = () => (
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="lucide lucide-calendar-days">
            <path d="M8 2v4"/><path d="M16 2v4"/><rect width="18" height="18" x="3" y="4" rx="2"/><path d="M3 10h18"/><path d="M8 14h.01"/><path d="M12 14h.01"/><path d="M16 14h.01"/><path d="M8 18h.01"/><path d="M12 18h.01"/><path d="M16 18h.01"/>
          </svg>
        );

        const UsersIcon = () => (
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="lucide lucide-users">
            <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M22 21v-2a4 4 0 0 0-3-3.87L16 16"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/>
          </svg>
        );

        const RssIcon = () => (
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="lucide lucide-rss">
            <path d="M4 11a9 9 0 0 1 9 9"/><path d="M4 4a16 16 0 0 1 16 16"/><circle cx="5" cy="19" r="1"/>
          </svg>
        );

        const PhoneIcon = () => (
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="lucide lucide-phone">
            <path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-3.07-8.63A2 2 0 0 1 4.11 2H7c.43 0 .79.27.94.66.14.39.07.82-.2 1.1L5.05 6.05c-.35.35-.5.85-.34 1.34A19.79 19.79 0 0 0 16.92 19c.49.16.99.01 1.34-.34l2.29-2.29c.28-.27.71-.34 1.1-.2.39.14.66.5.66.94Z"/>
          </svg>
        );

        const MailIcon = () => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="lucide lucide-mail">
              <rect width="20" height="16" x="2" y="4" rx="2"/><path d="m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7"/>
            </svg>
        );

        const InstagramIcon = () => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="lucide lucide-instagram">
              <rect width="20" height="20" x="2" y="2" rx="5" ry="5"/><path d="M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z"/><line x1="17.5" x2="17.5" y1="6.5" y2="6.5"/>
            </svg>
        );

        const PlayIcon = () => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="lucide lucide-play">
                <polygon points="5 3 19 12 5 21 5 3"/>
            </svg>
        );

        const PauseIcon = () => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="lucide lucide-pause">
                <rect x="6" y="4" width="4" height="16" rx="1"/><rect x="14" y="4" width="4" height="16" rx="1"/>
            </svg>
        );

        const StarIcon = () => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="lucide lucide-star">
                <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/>
            </svg>
        );

        const ArrowLeftIcon = () => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="lucide lucide-arrow-left">
                <path d="m12 19-7-7 7-7"/><path d="M19 12H5"/>
            </svg>
        );

        const ArrowRightIcon = () => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="lucide lucide-arrow-right">
                <path d="M5 12h14"/><path d="m12 5 7 7-7 7"/>
            </svg>
        );

        const XIcon = () => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="lucide lucide-x">
                <path d="M18 6 6 18"/><path d="m6 6 12 12"/>
            </svg>
        );

        // --- Contexte pour la gestion du contenu éditable ---
        // Le contexte va maintenant aussi passer les instances Firebase Firestore et Storage
        const ContentContext = createContext();

        // Fonction utilitaire pour définir une propriété imbriquée par un chemin (similaire à lodash.set)
        const setNestedProperty = (obj, path, value) => {
            const pathParts = path.split('.');
            let current = obj;
            for (let i = 0; i < pathParts.length; i++) {
                const part = pathParts[i];
                const isLastPart = (i === pathParts.length - 1);
                const isArrayIndex = !isNaN(parseInt(part)) && String(parseInt(part)) === part;

                if (isLastPart) {
                    current[isArrayIndex ? parseInt(part) : part] = value;
                } else {
                    if (isArrayIndex) {
                        if (!Array.isArray(current)) {
                            console.warn(`setNestedProperty: Tentative de navigation par index de tableau ${part} sur un non-tableau :`, current);
                            return obj;
                        }
                        if (current[parseInt(part)] === undefined || current[parseInt(part)] === null) {
                            current[parseInt(part)] = {};
                        }
                        current = current[parseInt(part)];
                    } else {
                        if (typeof current[part] !== 'object' || current[part] === null) {
                            current[part] = {};
                        }
                        current = current[part];
                    }
                }
            }
            return obj;
        };

        // Composant pour l'édition de texte in-situ (utilisé hors du panneau admin pour l'affichage direct)
        const EditableText = ({ tag: Tag, contentKey, isAdminAuthenticated, className }) => {
            const { content, updateContent } = useContext(ContentContext);
            const path = contentKey.split('.');

            const getValue = (obj, p) => {
                let current = obj;
                for (let i = 0; i < p.length; i++) {
                    const part = p[i];
                    const isArrayIndex = !isNaN(parseInt(part)) && String(parseInt(part)) === part;

                    if (isArrayIndex) {
                        if (Array.isArray(current) && current[parseInt(part)] !== undefined) {
                            current = current[parseInt(part)];
                        } else {
                            return `[Contenu manquant ou invalide: ${contentKey}]`;
                        }
                    } else {
                        if (current && typeof current === 'object' && current.hasOwnProperty(part)) {
                            current = current[part];
                        } else {
                            return `[Contenu manquant: ${contentKey}]`;
                        }
                    }
                }
                return current;
            };

            const textValue = content ? getValue(content, contentKey.split('.')) : `Chargement...`;

            const handleChange = (e) => {
                const newValue = e.target.value;
                updateContent(contentKey, newValue);
            };

            if (isAdminAuthenticated) {
                if (Tag === 'h1' || Tag === 'h2') {
                    return (
                        <input
                            type="text"
                            value={typeof textValue === 'string' ? textValue : ''}
                            onChange={handleChange}
                            className={`${className} bg-gray-700 text-white rounded p-2 focus:ring-2 focus:ring-blue-500 w-full`}
                        />
                    );
                }
                return (
                    <textarea
                        value={typeof textValue === 'string' ? textValue : ''}
                        onChange={handleChange}
                        className={`${className} bg-gray-700 text-white rounded p-2 focus:ring-2 focus:ring-blue-500 w-full min-h-[50px]`}
                        rows={typeof textValue === 'string' ? Math.max(3, textValue.split('\n').length) : 3}
                    />
                );
            }

            return <Tag className={className}>{typeof textValue === 'string' ? textValue : `[Contenu invalide: ${contentKey}]`}</Tag>;
        };

        // Composant de la bannière défilante
        const ScrollingBanner = () => {
            const bannerText = "BRMOTORSPORT • VOTRE SATISFACTION EST NOTRE PRIORITÉ • ";
            const repeatedText = Array(10).fill(bannerText).join('');

            return (
                <div className="w-full bg-red-700 text-white text-lg font-bold py-2 overflow-hidden whitespace-nowrap fixed top-0 left-0 z-50 shadow-md">
                    <div className="scrolling-banner-container">
                        <span className="scrolling-banner-text">
                            {repeatedText}
                        </span>
                        <span className="scrolling-banner-text" aria-hidden="true">
                            {repeatedText}
                        </span>
                    </div>
                </div>
            );
        };

        // Composant de la barre de navigation
        const Navbar = ({ setCurrentPage, isAdminAuthenticated, handleLogout }) => {
          const [isOpen, setIsOpen] = useState(false);

          const toggleMenu = () => {
            setIsOpen(!isOpen);
          };

          return (
            <nav className="bg-gray-900 bg-opacity-90 backdrop-blur-sm p-4 fixed w-full z-50 shadow-lg rounded-b-lg mt-12">
              <div className="container mx-auto flex justify-between items-center px-4">
                <div className="text-3xl md:text-4xl font-extrabold tracking-widest drop-shadow-lg opacity-0 animate-slide-in-left">
                  <span className="text-red-500">BR</span>
                  <span className="text-white">MOTOR</span>
                  <span className="text-blue-500">SPORT</span>
                </div>

                <div className="md:hidden">
                  <button onClick={toggleMenu} className="text-gray-300 hover:text-red-500 focus:outline-none focus:ring-2 focus:ring-red-500 rounded-lg p-2">
                    <svg className="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                      <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d={isOpen ? "M6 18L18 6M6 6l12 12" : "M4 6h16M4 12h16M4 18h16"}></path>
                    </svg>
                  </button>
                </div>

                <div className="hidden md:flex space-x-8">
                  <NavItem icon={<CarIcon />} text="Accueil" page="accueil" setCurrentPage={setCurrentPage} />
                  <NavItem icon={<StarIcon />} text="Voiture Vitrine" page="voiture-vitrine" setCurrentPage={setCurrentPage} />
                  <NavItem icon={<RssIcon />} text="Blog" page="blog" setCurrentPage={setCurrentPage} />
                  <NavItem icon={<UsersIcon />} text="Qui Sommes-nous" page="qui-sommes-nous" setCurrentPage={setCurrentPage} />
                  <NavItem icon={<PhoneIcon />} text="Contact" page="contact" setCurrentPage={setCurrentPage} />
                  {isAdminAuthenticated ? (
                      <NavItem text="Déconnexion" page="accueil" setCurrentPage={setCurrentPage} onClick={handleLogout} />
                  ) : (
                      <NavItem text="Admin" page="admin-login" setCurrentPage={setCurrentPage} />
                  )}
                </div>
              </div>

              <div className={`md:hidden absolute top-full left-0 w-full bg-gray-900 bg-opacity-95 backdrop-blur-sm shadow-lg
                             transform transition-transform duration-300 ease-in-out ${isOpen ? 'translate-x-0' : '-translate-x-full'} z-40`}>
                <div className="flex flex-col items-center py-4 space-y-4">
                  <NavItem icon={<CarIcon />} text="Accueil" page="accueil" setCurrentPage={setCurrentPage} onClick={() => setIsOpen(false)} />
                  <NavItem icon={<StarIcon />} text="Voiture Vitrine" page="voiture-vitrine" setCurrentPage={setCurrentPage} onClick={() => setIsOpen(false)} />
                  <NavItem icon={<RssIcon />} text="Blog" page="blog" setCurrentPage={setCurrentPage} onClick={() => setIsOpen(false)} />
                  <NavItem icon={<UsersIcon />} text="Qui Sommes-nous" page="qui-sommes-nous" setCurrentPage={setCurrentPage} onClick={() => setIsOpen(false)} />
                  <NavItem icon={<PhoneIcon />} text="Contact" page="contact" setCurrentPage={setCurrentPage} onClick={() => setIsOpen(false)} />
                  {isAdminAuthenticated ? (
                      <NavItem text="Déconnexion" page="accueil" setCurrentPage={setCurrentPage} onClick={() => { handleLogout(); setIsOpen(false); }} />
                  ) : (
                      <NavItem text="Admin" page="admin-login" setCurrentPage={setCurrentPage} onClick={() => setIsOpen(false)} />
                  )}
                </div>
              </div>
            </nav>
          );
        };

        // Composant d'élément de navigation
        const NavItem = ({ icon, text, page, setCurrentPage, onClick }) => (
          <button
            onClick={() => {
              setCurrentPage(page);
              if (onClick) onClick();
            }}
            className="flex items-center text-gray-300 hover:text-red-500 transition duration-300 ease-in-out transform hover:scale-105
                       px-3 py-2 rounded-lg text-sm font-medium focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-opacity-50"
          >
            {icon && <span className="mr-2 text-xl">{icon}</span>}
            {text}
          </button>
        );

        // Composant Page d'Accueil
        const HomePage = ({ setCurrentPage, isAdminAuthenticated }) => {
            return (
                <div className="min-h-screen bg-gradient-to-br from-blue-950 to-emerald-950 text-white pt-40 pb-12 font-inter">
                    {/* Effets visuels de fond (blobs animés) */}
                    <div className="absolute top-0 left-0 w-full h-full opacity-10 pointer-events-none">
                        <div className="absolute w-64 h-64 bg-red-600 rounded-full mix-blend-multiply filter blur-xl opacity-70 animate-blob top-10 left-1/4"></div>
                        <div className="absolute w-72 h-72 bg-blue-600 rounded-full mix-blend-multiply filter blur-xl opacity-70 animate-blob animation-delay-2000 top-1/2 right-1/4"></div>
                        <div className="absolute w-80 h-80 bg-green-600 rounded-full mix-blend-multiply filter blur-xl opacity-70 animate-blob animation-delay-4000 bottom-10 left-1/2"></div>
                    </div>

                    <div className="container mx-auto px-6 relative z-10">
                        {/* Section Titre principal et description */}
                        <section className="text-center mb-20">
                            <EditableText
                                tag="h1"
                                contentKey="home.mainTitle"
                                isAdminAuthenticated={isAdminAuthenticated}
                                className="text-6xl md:text-7xl font-extrabold mb-6 leading-tight drop-shadow-lg animate-fade-in-down animate-vibrate"
                            />
                            <EditableText
                                tag="p"
                                contentKey="home.description"
                                isAdminAuthenticated={isAdminAuthenticated}
                                className="text-xl md:text-2xl text-gray-300 max-w-3xl mx-auto mt-10 animate-fade-in-up"
                            />
                            {/* Boutons d'appel à l'action */}
                            <div className="flex flex-col sm:flex-row justify-center space-y-4 sm:space-y-0 sm:space-x-6 mt-8">
                                <button
                                    onClick={() => setCurrentPage('blog')}
                                    className="bg-red-600 hover:bg-red-700 text-white font-bold py-3 px-8 rounded-full shadow-lg transition duration-300 ease-in-out transform hover:scale-105 active:scale-95 animate-bounce-in"
                                >
                                    Découvrez notre blog
                                </button>
                                <button
                                    onClick={() => setCurrentPage('voiture-vitrine')}
                                    className="bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-8 rounded-full shadow-lg transition duration-300 ease-in-out transform hover:scale-105 active:scale-95 animate-bounce-in"
                                >
                                    Découvrez également notre voiture vitrine
                                </button>
                            </div>
                        </section>

                        {/* Section Message de contact cliquable */}
                        <section className="text-center bg-gray-800 p-8 rounded-2xl shadow-xl border border-gray-700 mb-20 animate-fade-in-up">
                            <a
                                href="#"
                                onClick={(e) => { e.preventDefault(); setCurrentPage('contact'); }}
                                className="block text-xl text-gray-200 leading-relaxed max-w-3xl mx-auto font-semibold text-red-400 hover:underline cursor-pointer"
                            >
                                <EditableText
                                    tag="span"
                                    contentKey="home.contactMessage"
                                    isAdminAuthenticated={isAdminAuthenticated}
                                    className="font-semibold text-red-400"
                                />
                            </a>
                        </section>

                        {/* Section Nos Offres */}
                        <section className="mb-20">
                            <EditableText
                                tag="h2"
                                contentKey="home.offerTitle"
                                isAdminAuthenticated={isAdminAuthenticated}
                                className="text-5xl font-bold text-center mb-12 text-red-400 animate-fade-in"
                            />
                            <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8">
                                {[
                                    { icon: <CarIcon />, titleKey: "home.offer1Title", descriptionKey: "home.offer1Description" },
                                    { icon: <span className="text-3xl">🚀</span>, titleKey: "home.offer2Title", descriptionKey: "home.offer2Description" },
                                    { icon: <span className="text-3xl">📈</span>, titleKey: "home.offer3Title", descriptionKey: "home.offer3Description" },
                                    { icon: <span className="text-3xl">💡</span>, titleKey: "home.offer4Title", descriptionKey: "home.offer4Description" }
                                ].map((service, index) => (
                                    <ServiceCard
                                        key={index}
                                        icon={service.icon}
                                        titleKey={service.titleKey}
                                        descriptionKey={service.descriptionKey}
                                        isAdminAuthenticated={isAdminAuthenticated}
                                        style={{ '--delay-factor': `${index * 200}ms` }}
                                    />
                                ))}
                            </div>
                        </section>

                        {/* Section Pourquoi nous faire confiance */}
                        <section className="mb-20">
                            <EditableText
                                tag="h2"
                                contentKey="home.trustTitle"
                                isAdminAuthenticated={isAdminAuthenticated}
                                className="text-5xl font-bold text-center mb-12 text-blue-400 animate-fade-in"
                            />
                            <div className="grid grid-cols-1 md:grid-cols-2 gap-8">
                                {[
                                    { icon: <span className="text-3xl">⏱️</span>, titleKey: "home.trust1Title", descriptionKey: "home.trust1Description" },
                                    { icon: <HandshakeIcon />, titleKey: "home.trust2Title", descriptionKey: "home.trust2Description" },
                                    { icon: <span className="text-3xl">🏆</span>, titleKey: "home.trust3Title", descriptionKey: "home.trust3Description" },
                                    { icon: <span className="text-3xl">⭐</span>, titleKey: "home.trust4Title", descriptionKey: "home.trust4Description" }
                                ].map((trust, index) => (
                                    <TrustCard
                                        key={index}
                                        icon={trust.icon}
                                        titleKey={trust.titleKey}
                                        descriptionKey={trust.descriptionKey}
                                        isAdminAuthenticated={isAdminAuthenticated}
                                        style={{ '--delay-factor': `${index * 200}ms` }}
                                    />
                                ))}
                            </div>
                        </section>

                        {/* Section L'équipe (avec image de Rémy Bruyant) */}
                        <section className="text-center mb-20 bg-gray-800 p-12 rounded-2xl shadow-xl transform transition duration-500 hover:scale-[1.02] hover:shadow-2xl">
                            <EditableText
                                tag="h2"
                                contentKey="home.teamTitle"
                                isAdminAuthenticated={isAdminAuthenticated}
                                className="text-4xl font-bold mb-6 text-orange-400 animate-fade-in"
                            />
                            <EditableText
                                tag="p"
                                contentKey="home.teamDescription"
                                isAdminAuthenticated={isAdminAuthenticated}
                                className="text-xl text-gray-200 leading-relaxed max-w-4xl mx-auto"
                            />
                            <div className="mt-8">
                                <ImageOfRemyBruyant
                                    className="mx-auto rounded-full border-4 border-red-500 shadow-lg w-32 h-32 object-cover"
                                />
                            </div>
                        </section>
                    </div>
                </div>
            );
        };

        // Nouveau composant pour l'image de Rémy Bruyant
        const ImageOfRemyBruyant = ({ className }) => {
            const imageUrl = "https://placehold.co/150x150/000/FFF?text=Remy";
            return (
                <img
                    src={imageUrl}
                    alt="Portrait de Rémy Bruyant"
                    className={className}
                    onError={(e) => { e.target.onerror = null; e.target.src="https://placehold.co/150x150/000/FFF?text=Rémy+Bruyant"; }}
                />
            );
        };

        // Composant Carte de Service
        const ServiceCard = ({ icon, titleKey, descriptionKey, style, isAdminAuthenticated }) => (
          <div className="group bg-gray-800 p-8 rounded-xl shadow-lg flex flex-col items-center text-center transition duration-300 ease-in-out transform hover:scale-105 hover:bg-gray-700 border border-gray-700 hover:border-red-500 animate-fade-in-up delay-animation" style={style}>
            <div className="text-red-500 mb-4 text-5xl transition-colors duration-300 group-hover:text-red-400">{icon}</div>
            <EditableText
                tag="h3"
                contentKey={titleKey}
                isAdminAuthenticated={isAdminAuthenticated}
                className="text-2xl font-semibold mb-3 text-white transition-colors duration-300 group-hover:text-red-200"
            />
            <EditableText
                tag="p"
                contentKey={descriptionKey}
                isAdminAuthenticated={isAdminAuthenticated}
                className="text-gray-300"
            />
          </div>
        );

        // Composant Carte de Confiance
        const TrustCard = ({ icon, titleKey, descriptionKey, style, isAdminAuthenticated }) => (
          <div className="group bg-gray-800 p-8 rounded-xl shadow-lg flex flex-col items-center text-center transition duration-300 ease-in-out transform hover:scale-105 hover:bg-gray-700 border border-gray-700 hover:border-blue-500 animate-fade-in-up delay-animation" style={style}>
            <div className="text-blue-500 mb-4 text-5xl transition-colors duration-300 group-hover:text-blue-400">{icon}</div>
            <EditableText
                tag="h3"
                contentKey={titleKey}
                isAdminAuthenticated={isAdminAuthenticated}
                className="text-2xl font-semibold mb-3 text-white transition-colors duration-300 group-hover:text-blue-200"
            />
            <EditableText
                tag="p"
                contentKey={descriptionKey}
                isAdminAuthenticated={isAdminAuthenticated}
                className="text-gray-300"
            />
          </div>
        );

        // Composant Carte de Blog
        const BlogPostCard = ({ post, style }) => (
          <div className="bg-gray-800 rounded-xl shadow-lg overflow-hidden transform transition duration-300 ease-in-out hover:scale-105 hover:shadow-2xl hover:shadow-green-500/50 border border-gray-700 hover:border-green-400 animate-fade-in-up delay-animation" style={style}>
            <img
              src={post.image}
              alt={post.title}
              className="w-full h-64 object-cover object-center transform transition duration-500 hover:scale-110"
              onError={(e) => { e.target.onerror = null; console.error(`ERREUR DE CHARGEMENT D'IMAGE pour l'article "${post.title}": Vérifiez le nom du fichier (${post.image}) et son emplacement.`); e.target.src=`https://placehold.co/600x400/000/FFF?text=Image+non+trouvée`; }}
            />
            <div className="p-6">
              <h3 className="text-2xl font-bold mb-3 text-white leading-tight">{post.title}</h3>
              <p className="text-gray-300 mb-4">{post.description}</p>
              <button className="bg-gradient-to-r from-green-500 to-teal-500 text-white font-semibold py-2 px-6 rounded-full hover:from-green-600 hover:to-teal-600 transition duration-300 ease-in-out shadow-md">
                Lire la suite
              </button>
            </div>
          </div>
        );

        // Composant Page Blog
        const BlogPage = ({ isAdminAuthenticated }) => {
          const { content } = useContext(ContentContext);
          const blogPosts = content?.blog?.posts || [];

          return (
            <div className="min-h-screen bg-gradient-to-br from-blue-950 to-emerald-950 text-white pt-40 pb-12 font-inter">
              <div className="container mx-auto px-6">
                <EditableText
                    tag="h1"
                    contentKey="blog.mainTitle"
                    isAdminAuthenticated={isAdminAuthenticated}
                    className="text-5xl font-extrabold text-center mb-12 text-green-400 animate-fade-in-down animate-vibrate"
                />
                <EditableText
                    tag="p"
                    contentKey="blog.description"
                    isAdminAuthenticated={isAdminAuthenticated}
                    className="text-xl text-center text-gray-300 max-w-3xl mx-auto mb-10 animate-fade-in-up"
                />

                <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-10">
                  {blogPosts.length > 0 ? (
                    blogPosts.map((post, index) => (
                      <BlogPostCard
                        key={post.id || `blog-post-${index}`}
                        post={post}
                        style={{ '--delay-factor': `${index * 150}ms` }}
                      />
                    ))
                  ) : (
                    <p className="col-span-full text-center text-gray-400 text-2xl mt-10">
                      Aucun article de blog à afficher pour le moment.
                    </p>
                  )}
                </div>
              </div>
            </div>
          );
        };


        // Composant Input Field (réutilisable)
        const InputField = ({ label, type, placeholder, required = false, value, onChange, name }) => (
          <div>
            <label htmlFor={name || label} className="block text-gray-300 text-sm font-bold mb-2">
              {label} {required && <span className="text-red-500">*</span>}
            </label>
            <input
              id={name || label}
              type={type}
              name={name}
              placeholder={placeholder}
              required={required}
              value={value}
              onChange={onChange}
              className="shadow appearance-none border border-gray-700 rounded-lg w-full py-3 px-4 bg-gray-700 text-white leading-tight focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent transition duration-200"
            />
          </div>
        );

        // Composant TextArea Field (réutilisable)
        const TextAreaField = ({ label, placeholder, required = false, value, onChange, name }) => (
          <div>
            <label htmlFor={name || label} className="block text-gray-300 text-sm font-bold mb-2">
              {label} {required && <span className="text-red-500">*</span>}
            </label>
            <textarea
              id={name || label}
              name={name}
              placeholder={placeholder}
              required={required}
              rows="5"
              value={value}
              onChange={onChange}
              className="shadow appearance-none border border-gray-700 rounded-lg w-full py-3 px-4 bg-gray-700 text-white leading-tight focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent transition duration-200 resize-y"
            ></textarea>
          </div>
        );


        // Composant Page Qui Sommes-nous
        const AboutUsPage = ({ isAdminAuthenticated }) => {
            return (
                <div className="min-h-screen bg-gradient-to-br from-blue-950 to-emerald-950 text-white pt-40 pb-12 font-inter">
                    <div className="container mx-auto px-6 max-w-4xl">
                        <EditableText
                            tag="h1"
                            contentKey="aboutUs.mainTitle"
                            isAdminAuthenticated={isAdminAuthenticated}
                            className="text-5xl font-extrabold text-center mb-12 text-yellow-400 animate-fade-in-down animate-vibrate"
                        />
                        <EditableText
                            tag="p"
                            contentKey="aboutUs.description"
                            isAdminAuthenticated={isAdminAuthenticated}
                            className="text-xl text-center text-gray-300 max-w-3xl mx-auto mb-10 animate-fade-in-up"
                        />

                        <section className="bg-gray-800 p-8 rounded-2xl shadow-xl border border-gray-700 mb-12 animate-fade-in-up">
                            <EditableText
                                tag="h2"
                                contentKey="aboutUs.historyTitle"
                                isAdminAuthenticated={isAdminAuthenticated}
                                className="text-4xl font-bold mb-6 text-yellow-300 text-center"
                            />
                            <EditableText
                                tag="p"
                                contentKey="aboutUs.historyParagraph1"
                                isAdminAuthenticated={isAdminAuthenticated}
                                className="text-lg text-gray-300 leading-relaxed mb-6"
                            />
                            <EditableText
                                tag="p"
                                contentKey="aboutUs.historyParagraph2"
                                isAdminAuthenticated={isAdminAuthenticated}
                                className="text-lg text-gray-300 leading-relaxed"
                            />
                        </section>

                        <section className="bg-gray-800 p-8 rounded-2xl shadow-xl border border-gray-700 animate-fade-in-up">
                            <EditableText
                                tag="h2"
                                contentKey="aboutUs.valuesTitle"
                                isAdminAuthenticated={isAdminAuthenticated}
                                className="text-4xl font-bold mb-6 text-yellow-300 text-center"
                            />
                            <div className="grid grid-cols-1 md:grid-cols-2 gap-8">
                                <ValueCard
                                    titleKey="aboutUs.value1Title"
                                    descriptionKey="aboutUs.value1Description"
                                    icon={<WrenchIcon />}
                                    isAdminAuthenticated={isAdminAuthenticated}
                                />
                                <ValueCard
                                    titleKey="aboutUs.value2Title"
                                    descriptionKey="aboutUs.value2Description"
                                    icon={<span className="text-3xl">✨</span>}
                                    isAdminAuthenticated={isAdminAuthenticated}
                                />
                                <ValueCard
                                    titleKey="aboutUs.value3Title"
                                    descriptionKey="aboutUs.value3Description"
                                    icon={<span className="text-3xl">✅</span>}
                                    isAdminAuthenticated={isAdminAuthenticated}
                                />
                                <ValueCard
                                    titleKey="aboutUs.value4Title"
                                    descriptionKey="aboutUs.value4Description"
                                    icon={<span className="text-3xl">❤️</span>}
                                    isAdminAuthenticated={isAdminAuthenticated}
                                />
                            </div>
                        </section>
                    </div>
                </div>
            );
        };

        // Composant Carte de Valeur
        const ValueCard = ({ icon, titleKey, descriptionKey, isAdminAuthenticated }) => (
          <div className="group bg-gray-700 p-6 rounded-lg shadow-md flex items-start space-x-4 transition duration-300 ease-in-out transform hover:scale-105 border border-gray-600 hover:border-yellow-400">
            <div className="text-yellow-400 mb-4 text-4xl transition-colors duration-300 group-hover:text-yellow-300">{icon}</div>
            <div>
              <EditableText
                tag="h3"
                contentKey={titleKey}
                isAdminAuthenticated={isAdminAuthenticated}
                className="text-2xl font-semibold mb-2 text-white transition-colors duration-300 group-hover:text-yellow-100"
              />
              <EditableText
                tag="p"
                contentKey={descriptionKey}
                isAdminAuthenticated={isAdminAuthenticated}
                className="text-gray-300"
              />
            </div>
          </div>
        );

        // Composant Page Contact
        const ContactPage = ({ isAdminAuthenticated }) => {
            const { content } = useContext(ContentContext);
            return (
                <div className="min-h-screen bg-gradient-to-br from-blue-950 to-emerald-950 text-white pt-40 pb-12 font-inter">
                    <div className="container mx-auto px-6 max-w-2xl">
                        <EditableText
                            tag="h1"
                            contentKey="contact.mainTitle"
                            isAdminAuthenticated={isAdminAuthenticated}
                            className="text-5xl font-extrabold text-center mb-12 text-pink-400 animate-fade-in-down animate-vibrate"
                        />
                        <EditableText
                            tag="p"
                            contentKey="contact.description"
                            isAdminAuthenticated={isAdminAuthenticated}
                            className="text-xl text-center text-gray-300 max-w-xl mx-auto mb-10 animate-fade-in-up"
                        />

                        <div className="bg-gray-800 p-8 rounded-2xl shadow-xl border border-gray-700 animate-fade-in-up space-y-8">
                            <div className="flex flex-col items-center text-center">
                                <MailIcon className="text-pink-500 w-12 h-12 mb-4" />
                                <EditableText
                                    tag="h3"
                                    contentKey="contact.emailTitle"
                                    isAdminAuthenticated={isAdminAuthenticated}
                                    className="text-2xl font-semibold mb-2 text-white"
                                />
                                <a href={`mailto:${content.contact.email}`} className="text-blue-400 hover:underline text-lg transition duration-300">
                                    <EditableText
                                        tag="span"
                                        contentKey="contact.email"
                                        isAdminAuthenticated={isAdminAuthenticated}
                                        className="text-blue-400 hover:underline text-lg"
                                    />
                                </a>
                            </div>

                            <div className="flex flex-col items-center text-center">
                                <PhoneIcon className="text-pink-500 w-12 h-12 mb-4" />
                                <EditableText
                                    tag="h3"
                                    contentKey="contact.phoneTitle"
                                    isAdminAuthenticated={isAdminAuthenticated}
                                    className="text-2xl font-semibold mb-2 text-white"
                                />
                                <a href={`tel:${content.contact.phoneNumber.replace(/\./g, '')}`} className="text-blue-400 hover:underline text-lg transition duration-300">
                                    <EditableText
                                        tag="span"
                                        contentKey="contact.phoneNumber"
                                        isAdminAuthenticated={isAdminAuthenticated}
                                        className="text-blue-400 hover:underline text-lg"
                                    />
                                </a>
                            </div>

                            <div className="flex flex-col items-center text-center">
                                <InstagramIcon className="text-pink-500 w-12 h-12 mb-4" />
                                <EditableText
                                    tag="h3"
                                    contentKey="contact.instagramTitle"
                                    isAdminAuthenticated={isAdminAuthenticated}
                                    className="text-2xl font-semibold mb-2 text-white"
                                />
                                <a href={`https://www.instagram.com/${content.contact.instagramHandle.replace('@', '')}`} target="_blank" rel="noopener noreferrer" className="text-blue-400 hover:underline text-lg transition duration-300">
                                    <EditableText
                                        tag="span"
                                        contentKey="contact.instagramHandle"
                                        isAdminAuthenticated={isAdminAuthenticated}
                                        className="text-blue-400 hover:underline text-lg"
                                    />
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        // Composant pour la page des mentions légales
        const LegalMentionsPage = ({ isAdminAuthenticated }) => {
            return (
                <div className="min-h-screen bg-gradient-to-br from-blue-950 to-emerald-950 text-white pt-40 pb-12 font-inter">
                    <div className="container mx-auto px-6 max-w-4xl">
                        <EditableText
                            tag="h1"
                            contentKey="legalMentions.mainTitle"
                            isAdminAuthenticated={isAdminAuthenticated}
                            className="text-5xl font-extrabold text-center mb-12 text-teal-400 animate-fade-in-down animate-vibrate"
                        />
                        <div className="bg-gray-800 p-8 rounded-2xl shadow-xl border border-gray-700 animate-fade-in-up space-y-6">
                            <EditableText
                                tag="h2"
                                contentKey="legalMentions.sectionTitle"
                                isAdminAuthenticated={isAdminAuthenticated}
                                className="text-3xl font-bold mb-4 text-white"
                            />
                            <EditableText
                                tag="p"
                                contentKey="legalMentions.paragraph1"
                                isAdminAuthenticated={isAdminAuthenticated}
                                className="text-lg text-gray-300 leading-relaxed"
                            />
                            <EditableText
                                tag="p"
                                contentKey="legalMentions.paragraph2"
                                isAdminAuthenticated={isAdminAuthenticated}
                                className="text-lg text-gray-300 leading-relaxed"
                            />
                            <ul className="list-disc list-inside text-lg text-gray-300 pl-4 space-y-2">
                                <li>
                                    <EditableText
                                        tag="span"
                                        contentKey="legalMentions.list1Item1"
                                        isAdminAuthenticated={isAdminAuthenticated}
                                        className="text-lg text-gray-300"
                                    />
                                </li>
                                <li>
                                    <EditableText
                                        tag="span"
                                        contentKey="legalMentions.list1Item2"
                                        isAdminAuthenticated={isAdminAuthenticated}
                                        className="text-lg text-gray-300"
                                    />
                                </li>
                                <li>
                                    <EditableText
                                        tag="span"
                                        contentKey="legalMentions.list1Item3"
                                        isAdminAuthenticated={isAdminAuthenticated}
                                        className="text-lg text-gray-300"
                                    />
                                </li>
                            </ul>
                            <EditableText
                                tag="p"
                                contentKey="legalMentions.paragraph3"
                                isAdminAuthenticated={isAdminAuthenticated}
                                className="text-lg text-gray-300 leading-relaxed"
                            />
                            <ul className="list-disc list-inside text-lg text-gray-300 pl-4 space-y-2">
                                <li>
                                    <EditableText
                                        tag="span"
                                        contentKey="legalMentions.list2Item1"
                                        isAdminAuthenticated={isAdminAuthenticated}
                                        className="text-lg text-gray-300"
                                    />
                                </li>
                                <li>
                                    <EditableText
                                        tag="span"
                                        contentKey="legalMentions.list2Item2"
                                        isAdminAuthenticated={isAdminAuthenticated}
                                        className="text-lg text-gray-300"
                                    />
                                </li>
                                <li>
                                    <EditableText
                                        tag="span"
                                        contentKey="legalMentions.list2Item3"
                                        isAdminAuthenticated={isAdminAuthenticated}
                                        className="text-lg text-gray-300"
                                    />
                                </li>
                            </ul>
                            <EditableText
                                tag="p"
                                contentKey="legalMentions.paragraph4"
                                isAdminAuthenticated={isAdminAuthenticated}
                                className="text-lg text-gray-300 leading-relaxed"
                            />
                        </div>
                    </div>
                </div>
            );
        };

        // Composant pour la page de politique de confidentialité
        const PrivacyPolicyPage = ({ isAdminAuthenticated }) => {
            return (
                <div className="min-h-screen bg-gradient-to-br from-blue-950 to-emerald-950 text-white pt-40 pb-12 font-inter">
                    <div className="container mx-auto px-6 max-w-4xl">
                        <EditableText
                            tag="h1"
                            contentKey="privacyPolicy.mainTitle"
                            isAdminAuthenticated={isAdminAuthenticated}
                            className="text-5xl font-extrabold text-center mb-12 text-purple-400 animate-fade-in-down animate-vibrate"
                        />
                        <div className="bg-gray-800 p-8 rounded-2xl shadow-xl border border-gray-700 animate-fade-in-up space-y-6">
                            <EditableText
                                tag="h2"
                                contentKey="privacyPolicy.introTitle"
                                isAdminAuthenticated={isAdminAuthenticated}
                                className="text-3xl font-bold mb-4 text-white"
                            />
                            <EditableText
                                tag="p"
                                contentKey="privacyPolicy.introText"
                                isAdminAuthenticated={isAdminAuthenticated}
                                className="text-lg text-gray-300 leading-relaxed"
                            />

                            <EditableText
                                tag="h2"
                                contentKey="privacyPolicy.collectionTitle"
                                isAdminAuthenticated={isAdminAuthenticated}
                                className="text-3xl font-bold mb-4 text-white"
                            />
                            <EditableText
                                tag="p"
                                contentKey="privacyPolicy.collectionText"
                                isAdminAuthenticated={isAdminAuthenticated}
                                className="text-lg text-gray-300 leading-relaxed"
                            />

                            <EditableText
                                tag="h2"
                                contentKey="privacyPolicy.usageTitle"
                                isAdminAuthenticated={isAdminAuthenticated}
                                className="text-3xl font-bold mb-4 text-white"
                            />
                            <ul className="list-disc list-inside text-lg text-gray-300 pl-4 space-y-2">
                                <li>
                                    <EditableText
                                        tag="span"
                                        contentKey="privacyPolicy.usageListItem1"
                                        isAdminAuthenticated={isAdminAuthenticated}
                                        className="text-lg text-gray-300"
                                    />
                                </li>
                                <li>
                                    <EditableText
                                        tag="span"
                                        contentKey="privacyPolicy.usageListItem2"
                                        isAdminAuthenticated={isAdminAuthenticated}
                                        className="text-lg text-gray-300"
                                    />
                                </li>
                                <li>
                                    <EditableText
                                        tag="span"
                                        contentKey="privacyPolicy.usageListItem3"
                                        isAdminAuthenticated={isAdminAuthenticated}
                                        className="text-lg text-gray-300"
                                    />
                                </li>
                            </ul>

                            <EditableText
                                tag="h2"
                                contentKey="privacyPolicy.protectionTitle"
                                isAdminAuthenticated={isAdminAuthenticated}
                                className="text-3xl font-bold mb-4 text-white"
                            />
                            <EditableText
                                tag="p"
                                contentKey="privacyPolicy.protectionText"
                                isAdminAuthenticated={isAdminAuthenticated}
                                className="text-lg text-gray-300 leading-relaxed"
                            />

                            <EditableText
                                tag="h2"
                                contentKey="privacyPolicy.rightsTitle"
                                isAdminAuthenticated={isAdminAuthenticated}
                                className="text-3xl font-bold mb-4 text-white"
                            />
                            <EditableText
                                tag="p"
                                contentKey="privacyPolicy.rightsText"
                                isAdminAuthenticated={isAdminAuthenticated}
                                className="text-lg text-gray-300 leading-relaxed"
                            />
                            <EditableText
                                tag="p"
                                contentKey="privacyPolicy.disclaimerText"
                                isAdminAuthenticated={isAdminAuthenticated}
                                className="text-lg text-gray-300 leading-relaxed"
                            />
                        </div>
                    </div>
                </div>
            );
        };

        // Composant pour la page Voiture Vitrine
        const ShowcaseCarPage = ({ isAdminAuthenticated }) => {
            const { content } = useContext(ContentContext);
            // Récupère les images depuis le contenu JSON, si non défini, utilise un tableau vide
            const images = content?.showcaseCar?.images || [];

            const [currentImageIndex, setCurrentImageIndex] = useState(0);
            const [isPlaying, setIsPlaying] = useState(true);

            useEffect(() => {
                let interval;
                if (isPlaying && images.length > 0) { // S'assurer qu'il y a des images avant de lancer le diaporama
                    interval = setInterval(() => {
                        setCurrentImageIndex((prevIndex) =>
                            (prevIndex + 1) % images.length
                        );
                    }, 3000);
                }
                return () => clearInterval(interval);
            }, [isPlaying, images.length]);

            const goToPrevious = () => {
                setCurrentImageIndex((prevIndex) =>
                    prevIndex === 0 ? images.length - 1 : prevIndex - 1
                );
                setIsPlaying(false);
            };

            const goToNext = () => {
                setCurrentImageIndex((prevIndex) =>
                    (prevIndex + 1) % images.length
                );
                setIsPlaying(false);
            };

            const togglePlayPause = () => {
                setIsPlaying(!isPlaying);
            };

            return (
                <div className="min-h-screen bg-gradient-to-br from-blue-950 to-emerald-950 text-white pt-40 pb-12 font-inter">
                    <div className="container mx-auto px-6 max-w-5xl">
                        <EditableText
                            tag="h1"
                            contentKey="showcaseCar.mainTitle"
                            isAdminAuthenticated={isAdminAuthenticated}
                            className="text-5xl font-extrabold text-center mb-12 text-yellow-400 animate-fade-in-down animate-vibrate"
                        />
                        <EditableText
                            tag="p"
                            contentKey="showcaseCar.description"
                            isAdminAuthenticated={isAdminAuthenticated}
                            className="text-xl text-center text-gray-300 max-w-3xl mx-auto mb-10 animate-fade-in-up"
                        />

                        <div className="bg-gray-800 p-8 rounded-2xl shadow-xl border border-gray-700 animate-fade-in-up space-y-8">
                            {/* Conteneur du carrousel avec centrage flexbox */}
                            {images.length > 0 ? (
                                <div className="relative w-full h-96 md:h-[500px] overflow-hidden rounded-lg shadow-2xl border-4 border-red-700 group flex items-center justify-center">
                                    <img
                                        src={images[currentImageIndex]}
                                        alt={`Volkswagen Scirocco R - Image ${currentImageIndex + 1}`}
                                        className="w-full h-full object-contain object-center animate-fade-in transition-opacity duration-700"
                                        onError={(e) => {
                                            console.error(
                                                `ERREUR DE CHARGEMENT D'IMAGE dans le diaporama:
                                                Vérifiez l'URL exacte affichée ci-dessous dans votre navigateur.
                                                URL échouée: ${e.target.src}`,
                                                e
                                            );
                                            e.target.onerror = null;
                                            e.target.src="https://placehold.co/800x500/FF0000/FFFFFF?text=Erreur+chargement+image";
                                        }}
                                    />

                                    <button
                                        onClick={goToPrevious}
                                        className="absolute left-4 top-1/2 -translate-y-1/2 bg-black bg-opacity-50 text-white p-3 rounded-full hover:bg-opacity-80 transition duration-300 opacity-0 group-hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-white"
                                        aria-label="Image précédente"
                                    >
                                        <ArrowLeftIcon />
                                    </button>
                                    <button
                                        onClick={goToNext}
                                        className="absolute right-4 top-1/2 -translate-y-1/2 bg-black bg-opacity-50 text-white p-3 rounded-full hover:bg-opacity-80 transition duration-300 opacity-0 group-hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-white"
                                        aria-label="Image suivante"
                                    >
                                        <ArrowRightIcon />
                                    </button>

                                    <button
                                        onClick={togglePlayPause}
                                        className="absolute bottom-4 left-1/2 -translate-x-1/2 bg-black bg-opacity50 text-white p-3 rounded-full hover:bg-opacity-80 transition duration-300 focus:outline-none focus:ring-2 focus:ring-white"
                                        aria-label={isPlaying ? "Mettre en pause le diaporama" : "Lancer le diaporama"}
                                    >
                                        {isPlaying ? <PauseIcon /> : <PlayIcon />}
                                    </button>

                                    <div className="absolute bottom-4 flex justify-center w-full space-x-2">
                                        {images.map((_, index) => (
                                            <button
                                                key={index}
                                                onClick={() => { setCurrentImageIndex(index); setIsPlaying(false); }}
                                                className={`w-3 h-3 rounded-full transition-colors duration-300 ${
                                                    index === currentImageIndex ? 'bg-red-500' : 'bg-gray-400 hover:bg-gray-300'
                                                }`}
                                                aria-label={`Voir l'image ${index + 1}`}
                                            />
                                        ))}
                                    </div>
                                </div>
                            ) : (
                                <p className="text-center text-gray-400 text-xl">
                                    Aucune image à afficher pour la voiture vitrine.
                                </p>
                            )}

                            <EditableText
                                tag="h2"
                                contentKey="showcaseCar.preparationTitle"
                                isAdminAuthenticated={isAdminAuthenticated}
                                className="text-3xl font-bold mb-4 text-white"
                            />
                            <EditableText
                                tag="p"
                                contentKey="showcaseCar.preparationDescription"
                                isAdminAuthenticated={isAdminAuthenticated}
                                className="text-lg text-gray-300 leading-relaxed"
                            />

                            <ul className="list-disc list-inside text-lg text-gray-300 pl-6 space-y-2">
                                <li>
                                    <EditableText
                                        tag="span"
                                        contentKey="showcaseCar.piston"
                                        isAdminAuthenticated={isAdminAuthenticated}
                                        className="text-lg text-gray-300"
                                    />
                                </li>
                                <li>
                                    <EditableText
                                        tag="span"
                                        contentKey="showcaseCar.bielles"
                                        isAdminAuthenticated={isAdminAuthenticated}
                                        className="text-lg text-gray-300"
                                    />
                                </li>
                                <li>
                                    <EditableText
                                        tag="span"
                                        contentKey="showcaseCar.soupapes"
                                        isAdminAuthenticated={isAdminAuthenticated}
                                        className="text-lg text-gray-300"
                                    />
                                </li>
                                <li>
                                    <EditableText
                                        tag="span"
                                        contentKey="showcaseCar.adm"
                                        isAdminAuthenticated={isAdminAuthenticated}
                                        className="text-lg text-gray-300"
                                    />
                                </li>
                                <li>
                                    <EditableText
                                        tag="span"
                                        contentKey="showcaseCar.ressort"
                                        isAdminAuthenticated={isAdminAuthenticated}
                                        className="text-lg text-gray-300"
                                    />
                                </li>
                                <li>
                                    <EditableText
                                        tag="span"
                                        contentKey="showcaseCar.viserie"
                                        isAdminAuthenticated={isAdminAuthenticated}
                                        className="text-lg text-gray-300"
                                    />
                                </li>
                                <li>
                                    <EditableText
                                        tag="span"
                                        contentKey="showcaseCar.pompeHuile"
                                        isAdminAuthenticated={isAdminAuthenticated}
                                        className="text-lg text-gray-300"
                                    />
                                </li>
                                <li>
                                    <EditableText
                                        tag="span"
                                        contentKey="showcaseCar.turbo"
                                        isAdminAuthenticated={isAdminAuthenticated}
                                        className="text-lg text-gray-300"
                                    />
                                </li>
                                <li>
                                    <EditableText
                                        tag="span"
                                        contentKey="showcaseCar.wastegate"
                                        isAdminAuthenticated={isAdminAuthenticated}
                                        className="text-lg text-gray-300"
                                    />
                                </li>
                                <li>
                                    <EditableText
                                        tag="span"
                                        contentKey="showcaseCar.injecteurs"
                                        isAdminAuthenticated={isAdminAuthenticated}
                                        className="text-lg text-gray-300"
                                    />
                                </li>
                                <li>
                                    <EditableText
                                        tag="span"
                                        contentKey="showcaseCar.pipAdmission"
                                        isAdminAuthenticated={isAdminAuthenticated}
                                        className="text-lg text-gray-300"
                                    />
                                </li>
                                <li>
                                    <EditableText
                                        tag="span"
                                        contentKey="showcaseCar.wmi"
                                        isAdminAuthenticated={isAdminAuthenticated}
                                        className="text-lg text-gray-300"
                                    />
                                </li>
                                <li>
                                    <EditableText
                                        tag="span"
                                        contentKey="showcaseCar.embrayage"
                                        isAdminAuthenticated={isAdminAuthenticated}
                                        className="text-lg text-gray-300"
                                    />
                                </li>
                            </ul>

                            <EditableText
                                tag="p"
                                contentKey="showcaseCar.finalDescription"
                                isAdminAuthenticated={isAdminAuthenticated}
                                className="text-lg text-gray-300 leading-relaxed"
                            />
                        </div>
                    </div>
                </div>
            );
        };

        // Composant de la page de connexion administrateur
        const AdminLoginPage = ({ setIsAdminAuthenticated, setCurrentPage }) => {
            const [password, setPassword] = useState('');
            const [error, setError] = useState('');

            // Mot de passe pour l'administrateur. ATTENTION: Ce n'est PAS sécurisé pour une production !
            // Pour une production, ce mot de passe ne devrait pas être dans le code client.
            // Il serait envoyé à un backend pour vérification.
            const ADMIN_PASSWORD_FRONTEND = 'Remy03200!'; // Gardé pour la démo frontend

            const handleSubmit = (e) => {
                e.preventDefault();
                if (password === ADMIN_PASSWORD_FRONTEND) {
                    setIsAdminAuthenticated(true);
                    localStorage.setItem('isAdminAuthenticated', 'true');
                    setCurrentPage('admin-panel');
                } else {
                    setError('Mot de passe incorrect.');
                }
            };

            return (
                <div className="min-h-screen bg-gradient-to-br from-gray-900 to-black text-white pt-40 pb-12 font-inter flex items-center justify-center">
                    <div className="bg-gray-800 p-8 rounded-2xl shadow-xl border border-gray-700 w-full max-w-md animate-fade-in-up">
                        <h1 className="text-4xl font-extrabold text-center mb-4 text-orange-400">Accès Administrateur</h1>
                        <p className="text-center text-sm text-gray-400 mb-6 italic">Giovanni te souhaite la bienvenue et un bon courage !</p>
                        <form onSubmit={handleSubmit} className="space-y-6">
                            <InputField
                                label="Mot de passe"
                                type="password"
                                placeholder="Entrez votre mot de passe"
                                required={true}
                                value={password}
                                onChange={(e) => { setPassword(e.target.value); setError(''); }}
                                name="adminPassword"
                            />
                            {error && <p className="text-red-500 text-sm text-center">{error}</p>}
                            <button
                                type="submit"
                                className="w-full bg-orange-600 hover:bg-orange-700 text-white font-bold py-3 px-4 rounded-lg shadow-md transition duration-300 ease-in-out transform hover:scale-105 active:scale-95"
                            >
                                Se connecter
                            </button>
                        </form>
                    </div>
                </div>
            );
        };

        // NOUVEAU COMPOSANT : ImageUploader
        // Ce composant gère la sélection de fichier, l'aperçu et simule le téléversement.
        // Dans une vraie application Firebase, la logique de "uploadBytes" et "getDownloadURL" irait ici.
        const ImageUploader = ({ currentImageUrl, onImageUploadSuccess, folderPath, firebaseInitialized, authReady }) => {
            const [file, setFile] = useState(null);
            const [uploading, setUploading] = useState(false);
            const [uploadError, setUploadError] = useState(null);
            const [previewUrl, setPreviewUrl] = useState(currentImageUrl);
            const [userUid, setUserUid] = useState(null); 

            useEffect(() => {
                setPreviewUrl(currentImageUrl);

                const checkAuth = async () => {
                    if (window.firebase && firebaseInitialized) {
                        const currentAuth = window.firebase.getAuth(firebaseApp);
                        const unsubscribe = window.firebase.onAuthStateChanged(currentAuth, (user) => {
                            if (user) {
                                setUserUid(user.uid);
                                console.log("ImageUploader: User authenticated with UID:", user.uid);
                            } else {
                                setUserUid(null);
                                console.log("ImageUploader: No user authenticated.");
                            }
                        });
                        return () => unsubscribe(); 
                    }
                };
                checkAuth();
            }, [currentImageUrl, firebaseInitialized]); 


            const handleFileChange = (e) => {
                if (e.target.files[0]) {
                    setFile(e.target.files[0]);
                    setPreviewUrl(URL.createObjectURL(e.target.files[0]));
                    setUploadError(null);
                }
            };

            const handleUpload = async () => {
                if (!file) {
                    setUploadError("Veuillez sélectionner un fichier.");
                    return;
                }

                if (!authReady || !userUid) { 
                    setUploadError("Erreur : L'authentification n'est pas prête ou l'utilisateur n'est pas authentifié. Veuillez attendre ou recharger la page.");
                    console.error("ImageUploader: Téléversement refusé car l'authentification n'est pas prête ou l'utilisateur n'est pas authentifié.");
                    return;
                }

                setUploading(true);
                setUploadError(null);

                try {
                    console.log("ImageUploader: Tentative de téléversement...");
                    console.log("ImageUploader: userUid:", userUid);
                    console.log("ImageUploader: folderPath:", folderPath);
                    console.log("ImageUploader: fileName:", file.name);

                    const imageRef = firebase.ref(storage, `${folderPath}/${Date.now()}_${file.name}`);
                    await firebase.uploadBytes(imageRef, file);
                    const downloadURL = await firebase.getDownloadURL(imageRef);
                    console.log("Fichier téléchargé sur Firebase Storage, URL:", downloadURL);
                    onImageUploadSuccess(downloadURL); 
                    setFile(null); 
                    setPreviewUrl(downloadURL); 
                } catch (error) {
                    console.error("Erreur détaillée lors du téléversement de l'image:", error);
                    if (error.code === 'storage/unauthorized') {
                        setUploadError(`Échec du téléversement : Permission refusée. Veuillez vérifier les règles de Firebase Storage pour l'écriture. Erreur Firebase : ${error.message}`);
                    } else if (error.code === 'storage/unknown') {
                         setUploadError(`Échec du téléversement : Une erreur inconnue est survenue. Vérifiez votre connexion et les logs de Firebase. Erreur Firebase : ${error.message}`);
                    }
                    else {
                        setUploadError(`Échec du téléversement: ${error.message}. (Si en production, vérifier les règles Firebase Storage et la connexion).`);
                    }
                } finally {
                    setUploading(false);
                }
            };

            return (
                <div className="border border-gray-600 p-4 rounded-lg bg-gray-700 space-y-4">
                    <h4 className="text-xl font-semibold text-white">Gestion de l'image</h4>
                    {!authReady && <p className="text-yellow-400 text-sm">Initialisation de l'authentification Firebase en cours...</p>}
                    {authReady && !userUid && <p className="text-red-400 text-sm">Erreur : Utilisateur non authentifié. Impossible de téléverser. Veuillez recharger la page.</p>}
                    {previewUrl && (
                        <div className="w-full h-48 bg-gray-800 flex items-center justify-center rounded-md overflow-hidden">
                            <img src={previewUrl} alt="Aperçu de l'image" className="max-w-full max-h-full object-contain" />
                        </div>
                    )}
                    <input
                        type="file"
                        accept="image/*"
                        onChange={handleFileChange}
                        className="block w-full text-sm text-gray-300
                                   file:mr-4 file:py-2 file:px-4
                                   file:rounded-full file:border-0
                                   file:text-sm file:font-semibold
                                   file:bg-blue-50 file:text-blue-700
                                   hover:file:bg-blue-100"
                    />
                    <button
                        onClick={handleUpload}
                        disabled={!file || uploading || !userUid || !authReady} 
                        className="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg shadow-md transition duration-300 ease-in-out transform hover:scale-105 active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed"
                    >
                        {uploading ? 'Téléversement...' : 'Téléverser l\'image'}
                    </button>
                    {uploadError && <p className="text-red-400 text-sm">{uploadError}</p>}
                </div>
            );
        };


        // Composant du panneau administrateur (contenu protégé)
        const AdminPanelPage = ({ setIsAdminAuthenticated, setCurrentPage, firebaseInitialized, authReady }) => { 
            const { content, updateContent } = useContext(ContentContext);
            const [localContent, setLocalContent] = useState(() => JSON.parse(JSON.stringify(content || {})));
            const [saveMessage, setSaveMessage] = useState('');
            const [isSaving, setIsSaving] = useState(false);
            const [activeTab, setActiveTab] = useState('home');

            useEffect(() => {
                setLocalContent(JSON.parse(JSON.stringify(content || {})));
                console.log("AdminPanelPage: État du contenu mis à jour. localContent initialisé :", JSON.parse(JSON.stringify(content || {})));
            }, [content]);

            const handleLocalChange = (pageKey, fieldKey, newValue) => {
                setLocalContent(prevContent => {
                    const newContent = JSON.parse(JSON.stringify(prevContent));
                    const targetPage = newContent[pageKey];

                    if (!targetPage) {
                        console.error(`handleLocalChange: Clé de page "${pageKey}" introuvable dans localContent.`);
                        return prevContent;
                    }

                    setNestedProperty(targetPage, fieldKey, newValue);
                    return newContent;
                });
            };

            const handleAddBlogPost = () => {
                setLocalContent(prevContent => {
                    const newContent = JSON.parse(JSON.stringify(prevContent));
                    if (!newContent.blog || !Array.isArray(newContent.blog.posts)) {
                        newContent.blog = { ...newContent.blog, posts: [] };
                    }
                    newContent.blog.posts.push({
                        id: Date.now(),
                        image: "https://placehold.co/600x400/000/FFF?text=Nouvelle+image", // Image placeholder par défaut
                        title: "Nouveau titre d'article",
                        description: "Nouvelle description d'article."
                    });
                    return newContent;
                });
            };

            const handleRemoveBlogPost = (idToRemove) => {
                setLocalContent(prevContent => {
                    const newContent = JSON.parse(JSON.stringify(prevContent));
                    if (newContent.blog && Array.isArray(newContent.blog.posts)) {
                        newContent.blog.posts = newContent.blog.posts.filter(post => post.id !== idToRemove);
                    }
                    return newContent;
                });
            };

            const handleAddShowcaseImage = () => {
                setLocalContent(prevContent => {
                    const newContent = JSON.parse(JSON.stringify(prevContent));
                    if (!newContent.showcaseCar || !Array.isArray(newContent.showcaseCar.images)) {
                        newContent.showcaseCar = { ...newContent.showcaseCar, images: [] };
                    }
                    newContent.showcaseCar.images.push(`https://placehold.co/800x500/000/FFF?text=Nouvelle+image+vitrine`);
                    return newContent;
                });
            };

            const handleRemoveShowcaseImage = (indexToRemove) => {
                setLocalContent(prevContent => {
                    const newContent = JSON.parse(JSON.stringify(prevContent));
                    if (newContent.showcaseCar && Array.isArray(newContent.showcaseCar.images)) {
                        newContent.showcaseCar.images.splice(indexToRemove, 1);
                    }
                    return newContent;
                });
            };

            const handleSaveChanges = async () => {
                setIsSaving(true);
                setSaveMessage('Sauvegarde en cours...');
                console.log("AdminPanelPage: Initialisation de la sauvegarde. Envoi du contenu :", JSON.parse(JSON.stringify(localContent)));

                try {
                    // --- VRAI CODE FIREBASE FIRESTORE ---
                    // Utilisez directement l'instance `db` qui est définie globalement par le hook useEffect de `App`
                    const contentDocRef = firebase.doc(db, 'content', 'appContent');
                    await firebase.setDoc(contentDocRef, localContent); // setDoc écrase ou crée le document
                    console.log("Contenu sauvegardé avec succès sur Firestore !");
                    setSaveMessage("Modifications sauvegardées avec succès sur Firebase Firestore !");
                    // Mettre à jour le contexte global de l'application avec le contenu local
                    updateContent(null, localContent);
                    console.log("AdminPanelPage: Mise à jour du contenu global déclenchée.");
                    // --- FIN DU VRAI CODE ---

                } catch (error) {
                    console.error('AdminPanelPage: Erreur lors de la sauvegarde sur Firestore:', error);
                    setSaveMessage(`Erreur de sauvegarde sur Firestore : ${error.message}`);
                } finally {
                    setIsSaving(false);
                    setTimeout(() => setSaveMessage(''), 10000); // Message disparaît après 10 secondes
                }
            };

            const handleLogout = () => {
                setIsAdminAuthenticated(false);
                localStorage.removeItem('isAdminAuthenticated');
                setCurrentPage('accueil');
            };

            // Fonction utilitaire pour générer les champs éditables
            const renderEditableFields = (pageData, pageKey) => {
                if (!pageData || typeof pageData !== 'object') {
                    console.warn(`renderEditableFields a reçu des données de page invalides pour la clé : ${pageKey}`, pageData);
                    return null;
                }

                return Object.keys(pageData).map(fieldKey => {
                    const fieldValue = pageData[fieldKey];
                    const contentPath = `${pageKey}.${fieldKey}`;

                    // Gérer les cas spécifiques (posts pour le blog, images pour showcaseCar)
                    if (fieldKey === 'posts' && Array.isArray(fieldValue)) {
                        return null; // Géré par une section spécifique du blog
                    }
                    if (fieldKey === 'images' && Array.isArray(fieldValue)) {
                        return null; // Géré par une section spécifique de la voiture vitrine
                    }

                    if (typeof fieldValue === 'object' && fieldValue !== null && !Array.isArray(fieldValue)) {
                        return (
                            <div key={contentPath} className="pb-4 border-b border-gray-600 last:border-b-0">
                                <h4 className="text-xl font-semibold mb-3 text-white capitalize">{fieldKey.replace(/([A-Z])/g, ' $1').trim()}:</h4>
                                {renderEditableFields(fieldValue, contentPath)}
                            </div>
                        );
                    }

                    const valueToDisplay = typeof fieldValue === 'string' ? fieldValue : '';
                    const inputType = (fieldKey.includes('Title') || fieldKey.includes('email') || fieldKey.includes('phone') || fieldKey.includes('instagram') || fieldKey.includes('Handle')) ? 'text' : 'textarea';
                    const rows = (inputType === 'textarea' && typeof valueToDisplay === 'string') ? Math.max(3, valueToDisplay.split('\n').length) : undefined;

                    return (
                        <div key={contentPath} className="pb-4 border-b border-gray-600 last:border-b-0">
                            <label className="block text-gray-300 text-sm font-bold mb-2">
                                {fieldKey.replace(/([A-Z])/g, ' $1').replace(/([0-9])/g, ' $1').trim()}:
                            </label>
                            {inputType === 'text' ? (
                                <input
                                    type="text"
                                    value={valueToDisplay}
                                    onChange={(e) => handleLocalChange(pageKey, fieldKey, e.target.value)}
                                    className="w-full p-2 rounded bg-gray-600 text-white border border-gray-500 focus:ring-blue-500 focus:border-blue-500"
                                />
                            ) : (
                                <textarea
                                    value={valueToDisplay}
                                    onChange={(e) => handleLocalChange(pageKey, fieldKey, e.target.value)}
                                    rows={rows}
                                    className="w-full p-2 rounded bg-gray-600 text-white border border-gray-500 focus:ring-blue-500 focus:border-blue-500 resize-y"
                                />
                            )}
                            {typeof fieldValue !== 'string' && (
                                <p className="text-red-400 text-xs mt-1">
                                    Ce champ ({contentPath}) n'est pas une chaîne de caractères ou est manquant.
                                </p>
                            )}
                        </div>
                    );
                });
            };

            const pageTabs = [
                { key: 'home', label: 'Accueil' },
                { key: 'blog', label: 'Blog' },
                { key: 'aboutUs', label: 'Qui sommes-nous' },
                { key: 'contact', label: 'Contact' },
                { key: 'legalMentions', label: 'Mentions Légales' },
                { key: 'privacyPolicy', label: 'Politique de Confidentialité' },
                { key: 'showcaseCar', label: 'Voiture Vitrine' }
            ];

            return (
                <div className="min-h-screen bg-gradient-to-br from-gray-900 to-black text-white pt-40 pb-12 font-inter">
                    <div className="container mx-auto px-6 max-w-6xl">
                        <h1 className="text-5xl font-extrabold text-center mb-12 text-orange-400 animate-fade-in-down animate-vibrate">
                            Panneau d'Administration
                        </h1>
                        <p className="text-xl text-center text-gray-300 max-w-3xl mx-auto mb-10 animate-fade-in-up">
                            Bienvenue, administrateur. Ici, vous pouvez gérer le contenu du site.
                        </p>

                        <div className="bg-gray-800 p-8 rounded-2xl shadow-xl border border-gray-700 animate-fade-in-up space-y-8">
                            {/* Navigation par onglets */}
                            <div className="flex flex-wrap justify-center gap-4 mb-8 border-b border-gray-700 pb-4">
                                {pageTabs.map(tab => (
                                    <button
                                        key={tab.key}
                                        onClick={() => setActiveTab(tab.key)}
                                        className={`px-6 py-3 rounded-lg font-semibold transition duration-300 ease-in-out
                                                    ${activeTab === tab.key
                                                        ? 'bg-blue-600 text-white shadow-lg transform scale-105'
                                                        : 'bg-gray-700 text-gray-300 hover:bg-gray-600 hover:text-white'
                                                    }`}
                                    >
                                        {tab.label}
                                    </button>
                                ))}
                            </div>

                            {/* Contenu des onglets */}
                            {localContent && (
                                <div className="space-y-8">
                                    {/* Section Accueil */}
                                    {activeTab === 'home' && (
                                        <div className="p-6 bg-gray-700 rounded-xl shadow-inner border border-gray-600">
                                            <h2 className="text-3xl font-bold mb-6 text-blue-400 capitalize border-b-2 border-blue-600 pb-3">
                                                Page Accueil
                                            </h2>
                                            <div className="space-y-6">
                                                {renderEditableFields(localContent.home, 'home')}
                                                {localContent.home.offerTitle && (
                                                    <div className="mt-8 pt-6 border-t-2 border-red-600">
                                                        <h3 className="text-2xl font-bold mb-4 text-red-300">Nos Offres</h3>
                                                        {renderEditableFields({
                                                            offer1Title: localContent.home.offer1Title,
                                                            offer1Description: localContent.home.offer1Description,
                                                            offer2Title: localContent.home.offer2Title,
                                                            offer2Description: localContent.home.offer2Description,
                                                            offer3Title: localContent.home.offer3Title,
                                                            offer3Description: localContent.home.offer3Description,
                                                            offer4Title: localContent.home.offer4Title,
                                                            offer4Description: localContent.home.offer4Description,
                                                        }, 'home')}
                                                    </div>
                                                )}
                                                {localContent.home.trustTitle && (
                                                    <div className="mt-8 pt-6 border-t-2 border-blue-600">
                                                        <h3 className="text-2xl font-bold mb-4 text-blue-300">Pourquoi nous faire confiance</h3>
                                                        {renderEditableFields({
                                                            trust1Title: localContent.home.trust1Title,
                                                            trust1Description: localContent.home.trust1Description,
                                                            trust2Title: localContent.home.trust2Title,
                                                            trust2Description: localContent.home.trust2Description,
                                                            trust3Title: localContent.home.trust3Title,
                                                            trust3Description: localContent.home.trust3Description,
                                                            trust4Title: localContent.home.trust4Title,
                                                            trust4Description: localContent.home.trust4Description,
                                                        }, 'home')}
                                                    </div>
                                                )}
                                                {localContent.home.teamTitle && (
                                                    <div className="mt-8 pt-6 border-t-2 border-orange-600">
                                                        <h3 className="text-2xl font-bold mb-4 text-orange-300">L'équipe</h3>
                                                        {renderEditableFields({
                                                            teamTitle: localContent.home.teamTitle,
                                                            teamDescription: localContent.home.teamDescription,
                                                        }, 'home')}
                                                    </div>
                                                )}
                                            </div>
                                        </div>
                                    )}

                                    {/* Section Blog */}
                                    {activeTab === 'blog' && (
                                        <div className="p-6 bg-gray-700 rounded-xl shadow-inner border border-gray-600">
                                            <h2 className="text-3xl font-bold mb-6 text-green-400 capitalize border-b-2 border-green-600 pb-3">
                                                Page Blog
                                            </h2>
                                            <div className="space-y-6">
                                                {renderEditableFields({
                                                    mainTitle: localContent.blog.mainTitle,
                                                    description: localContent.blog.description,
                                                }, 'blog')}
                                                <div className="mt-8 pt-6 border-t-2 border-green-600">
                                                    <h3 className="text-2xl font-bold mb-4 text-green-300">Articles de Blog</h3>
                                                    <button
                                                        onClick={handleAddBlogPost}
                                                        className="bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded-lg shadow-md transition duration-300 ease-in-out transform hover:scale-105 active:scale-95 mb-6"
                                                    >
                                                        Ajouter un nouvel article
                                                    </button>
                                                    <div className="space-y-8 mt-4">
                                                        {localContent.blog.posts && localContent.blog.posts.map((post, index) => (
                                                            <div key={post.id || `blog-edit-${index}`} className="p-5 bg-gray-600 rounded-lg shadow-md border border-gray-500 relative">
                                                                <h4 className="text-xl font-semibold mb-3 text-white">Article #{index + 1}</h4>
                                                                <button
                                                                    onClick={() => handleRemoveBlogPost(post.id)}
                                                                    className="absolute top-3 right-3 bg-red-500 hover:bg-red-600 text-white p-2 rounded-full text-sm"
                                                                    aria-label="Supprimer l'article"
                                                                >
                                                                    <XIcon className="w-4 h-4"/>
                                                                </button>
                                                                <div className="space-y-4">
                                                                    <div>
                                                                        <label className="block text-gray-300 text-sm font-bold mb-2">Titre de l'article:</label>
                                                                        <input
                                                                            type="text"
                                                                            value={post.title || ''}
                                                                            onChange={(e) => handleLocalChange('blog', `posts.${index}.title`, e.target.value)}
                                                                            className="w-full p-2 rounded bg-gray-500 text-white border border-gray-400 focus:ring-green-500 focus:border-green-500"
                                                                        />
                                                                    </div>
                                                                    <div>
                                                                        <label className="block text-gray-300 text-sm font-bold mb-2">Description de l'article:</label>
                                                                        <textarea
                                                                            value={post.description || ''}
                                                                            onChange={(e) => handleLocalChange('blog', `posts.${index}.description`, e.target.value)}
                                                                            rows={Math.max(3, (post.description || '').split('\n').length)}
                                                                            className="w-full p-2 rounded bg-gray-500 text-white border border-gray-400 focus:ring-green-500 focus:border-green-500 resize-y"
                                                                        />
                                                                    </div>
                                                                    {/* Intégration de l'ImageUploader pour chaque article de blog */}
                                                                    <ImageUploader
                                                                        currentImageUrl={post.image}
                                                                        onImageUploadSuccess={(url) => handleLocalChange('blog', `posts.${index}.image`, url)}
                                                                        folderPath={`images/blog_posts/${post.id}`}
                                                                        firebaseInitialized={firebaseInitialized} 
                                                                        authReady={authReady}
                                                                    />
                                                                </div>
                                                            </div>
                                                        ))}
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    )}

                                    {/* Section Qui sommes-nous */}
                                    {activeTab === 'aboutUs' && (
                                        <div className="p-6 bg-gray-700 rounded-xl shadow-inner border border-gray-600">
                                            <h2 className="text-3xl font-bold mb-6 text-yellow-400 capitalize border-b-2 border-yellow-600 pb-3">
                                                Page Qui sommes-nous
                                            </h2>
                                            <div className="space-y-6">
                                                {renderEditableFields(localContent.aboutUs, 'aboutUs')}
                                                {localContent.aboutUs.historyTitle && (
                                                    <div className="mt-8 pt-6 border-t-2 border-yellow-600">
                                                        <h3 className="text-2xl font-bold mb-4 text-yellow-300">Notre Histoire</h3>
                                                        {renderEditableFields({
                                                            historyTitle: localContent.aboutUs.historyTitle,
                                                            historyParagraph1: localContent.aboutUs.historyParagraph1,
                                                            historyParagraph2: localContent.aboutUs.historyParagraph2,
                                                        }, 'aboutUs')}
                                                    </div>
                                                )}
                                                {localContent.aboutUs.valuesTitle && (
                                                    <div className="mt-8 pt-6 border-t-2 border-yellow-600">
                                                        <h3 className="text-2xl font-bold mb-4 text-yellow-300">Nos Valeurs</h3>
                                                        {renderEditableFields({
                                                            value1Title: localContent.aboutUs.value1Title,
                                                            value1Description: localContent.aboutUs.value1Description,
                                                            value2Title: localContent.aboutUs.value2Title,
                                                            value2Description: localContent.aboutUs.value2Description,
                                                            value3Title: localContent.aboutUs.value3Title,
                                                            value3Description: localContent.aboutUs.value3Description,
                                                            value4Title: localContent.aboutUs.value4Title,
                                                            value4Description: localContent.aboutUs.value4Description,
                                                        }, 'aboutUs')}
                                                    </div>
                                                )}
                                            </div>
                                        </div>
                                    )}

                                    {/* Section Contact */}
                                    {activeTab === 'contact' && (
                                        <div className="p-6 bg-gray-700 rounded-xl shadow-inner border border-gray-600">
                                            <h2 className="text-3xl font-bold mb-6 text-pink-400 capitalize border-b-2 border-pink-600 pb-3">
                                                Page Contact
                                            </h2>
                                            <React.Fragment>
                                                {renderEditableFields(localContent.contact, 'contact')}
                                            </React.Fragment>
                                        </div>
                                    )}

                                    {/* Section Mentions Légales */}
                                    {activeTab === 'legalMentions' && (
                                        <div className="p-6 bg-gray-700 rounded-xl shadow-inner border border-gray-600">
                                            <h2 className="text-3xl font-bold mb-6 text-teal-400 capitalize border-b-2 border-teal-600 pb-3">
                                                Page Mentions Légales
                                            </h2>
                                            <div className="space-y-6">
                                                {renderEditableFields(localContent.legalMentions, 'legalMentions')}
                                                {localContent.legalMentions.list1Item1 && (
                                                    <div className="mt-8 pt-6 border-t-2 border-teal-600">
                                                        <h3 className="text-2xl font-bold mb-4 text-teal-300">Liste 1</h3>
                                                        {renderEditableFields({
                                                            list1Item1: localContent.legalMentions.list1Item1,
                                                            list1Item2: localContent.legalMentions.list1Item2,
                                                            list1Item3: localContent.legalMentions.list1Item3,
                                                        }, 'legalMentions')}
                                                    </div>
                                                )}
                                                {localContent.legalMentions.list2Item1 && (
                                                    <div className="mt-8 pt-6 border-t-2 border-teal-600">
                                                        <h3 className="text-2xl font-bold mb-4 text-teal-300">Liste 2</h3>
                                                        {renderEditableFields({
                                                            list2Item1: localContent.legalMentions.list2Item1,
                                                            list2Item2: localContent.legalMentions.list2Item2,
                                                            list2Item3: localContent.legalMentions.list2Item3,
                                                        }, 'legalMentions')}
                                                    </div>
                                                )}
                                            </div>
                                        </div>
                                    )}

                                    {/* Section Politique de Confidentialité */}
                                    {activeTab === 'privacyPolicy' && (
                                        <div className="p-6 bg-gray-700 rounded-xl shadow-inner border border-gray-600">
                                            <h2 className="text-3xl font-bold mb-6 text-purple-400 capitalize border-b-2 border-purple-600 pb-3">
                                                Page Politique de Confidentialité
                                            </h2>
                                            <div className="space-y-6">
                                                {renderEditableFields(localContent.privacyPolicy, 'privacyPolicy')}
                                                {localContent.privacyPolicy.usageListItem1 && (
                                                    <div className="mt-8 pt-6 border-t-2 border-purple-600">
                                                        <h3 className="text-2xl font-bold mb-4 text-purple-300">Utilisation des informations</h3>
                                                        {renderEditableFields({
                                                            usageListItem1: localContent.privacyPolicy.usageListItem1,
                                                            usageListItem2: localContent.privacyPolicy.usageListItem2,
                                                            usageListItem3: localContent.privacyPolicy.usageListItem3,
                                                        }, 'privacyPolicy')}
                                                    </div>
                                                )}
                                            </div>
                                        </div>
                                    )}

                                    {/* Section Voiture Vitrine */}
                                    {activeTab === 'showcaseCar' && (
                                        <div className="p-6 bg-gray-700 rounded-xl shadow-inner border border-gray-600">
                                            <h2 className="text-3xl font-bold mb-6 text-yellow-400 capitalize border-b-2 border-yellow-600 pb-3">
                                                Page Voiture Vitrine
                                            </h2>
                                            <div className="space-y-6">
                                                {renderEditableFields({
                                                    mainTitle: localContent.showcaseCar.mainTitle,
                                                    description: localContent.showcaseCar.description,
                                                    preparationTitle: localContent.showcaseCar.preparationTitle,
                                                    preparationDescription: localContent.showcaseCar.preparationDescription,
                                                    finalDescription: localContent.showcaseCar.finalDescription,
                                                }, 'showcaseCar')}

                                                {localContent.showcaseCar.piston && (
                                                    <div className="mt-8 pt-6 border-t-2 border-yellow-600">
                                                        <h3 className="text-2xl font-bold mb-4 text-yellow-300">Détails de la Préparation</h3>
                                                        {renderEditableFields({
                                                            piston: localContent.showcaseCar.piston,
                                                            bielles: localContent.showcaseCar.bielles,
                                                            soupapes: localContent.showcaseCar.soupapes,
                                                            adm: localContent.showcaseCar.adm,
                                                            ressort: localContent.showcaseCar.ressort,
                                                            viserie: localContent.showcaseCar.viserie,
                                                            pompeHuile: localContent.showcaseCar.pompeHuile,
                                                            turbo: localContent.showcaseCar.turbo,
                                                            wastegate: localContent.showcaseCar.wastegate,
                                                            injecteurs: localContent.showcaseCar.injecteurs,
                                                            pipAdmission: localContent.showcaseCar.pipAdmission,
                                                            wmi: localContent.showcaseCar.wmi,
                                                            embrayage: localContent.showcaseCar.embrayage,
                                                        }, 'showcaseCar')}
                                                    </div>
                                                )}

                                                <div className="mt-8 pt-6 border-t-2 border-red-600">
                                                    <h3 className="text-2xl font-bold mb-4 text-red-300">Images de la Voiture Vitrine</h3>
                                                    <button
                                                        onClick={handleAddShowcaseImage}
                                                        className="bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded-lg shadow-md transition duration-300 ease-in-out transform hover:scale-105 active:scale-95 mb-6"
                                                    >
                                                        Ajouter une nouvelle image
                                                    </button>
                                                    <div className="space-y-8 mt-4">
                                                        {localContent.showcaseCar.images && localContent.showcaseCar.images.map((imageUrl, index) => (
                                                            <div key={index} className="p-5 bg-gray-600 rounded-lg shadow-md border border-gray-500 relative">
                                                                <h4 className="text-xl font-semibold mb-3 text-white">Image #{index + 1}</h4>
                                                                <button
                                                                    onClick={() => handleRemoveShowcaseImage(index)}
                                                                    className="absolute top-3 right-3 bg-red-500 hover:bg-red-600 text-white p-2 rounded-full text-sm"
                                                                    aria-label="Supprimer l'image"
                                                                >
                                                                    <XIcon className="w-4 h-4"/>
                                                                </button>
                                                                {/* Intégration de l'ImageUploader pour chaque image de voiture vitrine */}
                                                                <ImageUploader
                                                                    currentImageUrl={imageUrl}
                                                                    onImageUploadSuccess={(url) => handleLocalChange('showcaseCar', `images.${index}`, url)}
                                                                    folderPath={`images/showcase_car/${index}`}
                                                                    firebaseInitialized={firebaseInitialized} 
                                                                    authReady={authReady}
                                                                />
                                                            </div>
                                                        ))}
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    )}
                                </div>
                            )}

                            <div className="flex justify-center space-x-4 mt-8">
                                <button
                                    onClick={handleSaveChanges}
                                    className="bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-6 rounded-lg shadow-md transition duration-300 ease-in-out transform hover:scale-105 active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed"
                                    disabled={isSaving}
                                >
                                    {isSaving ? 'Sauvegarde...' : 'Enregistrer les modifications'}
                                </button>
                                <button
                                    onClick={handleLogout}
                                    className="bg-red-600 hover:bg-red-700 text-white font-bold py-3 px-6 rounded-lg shadow-md transition duration-300 ease-in-out transform hover:scale-105 active:scale-95"
                                >
                                    Déconnexion
                                </button>
                            </div>
                            {saveMessage && (
                                <p className="text-center text-yellow-400 mt-4 text-md animate-fade-in">
                                    {saveMessage}
                                </p>
                            )}
                        </div>
                    </div>
                </div>
            );
        };


        // Nouveau composant pour le contrôle de la musique
        const MusicControl = () => {
            const audioRef = useRef(null);
            const [isPlaying, setIsPlaying] = useState(false);
            const [showAutoplayMessage, setShowAutoplayMessage] = useState(false);

            useEffect(() => {
                const audio = document.getElementById('background-music');
                if (audio) {
                    audioRef.current = audio;

                    const playPromise = audio.play();
                    if (playPromise !== undefined) {
                        playPromise.then(() => {
                            setIsPlaying(true);
                        }).catch(error => {
                            console.log("La lecture automatique de la musique a été bloquée. L'utilisateur peut la démarrer manuellement.", error);
                            setIsPlaying(false);
                            setShowAutoplayMessage(true);
                            setTimeout(() => {
                                setShowAutoplayMessage(false);
                            }, 5000);
                        });
                    }

                    const handleAudioPause = () => setIsPlaying(false);
                    const handleAudioPlay = () => setIsPlaying(true);

                    audio.addEventListener('pause', handleAudioPause);
                    audio.addEventListener('play', handleAudioPlay);

                    return () => {
                        audio.removeEventListener('pause', handleAudioPause);
                        audio.removeEventListener('play', handleAudioPlay);
                    };
                }
            }, []);

            const togglePlayPause = () => {
                const audio = audioRef.current;
                if (audio) {
                    if (isPlaying) {
                        audio.pause();
                    } else {
                        audio.play().then(() => {
                            setIsPlaying(true);
                            setShowAutoplayMessage(false);
                        }).catch(error => {
                            console.error("Erreur lors de la tentative de lecture par le bouton:", error);
                        });
                    }
                }
            };

            return (
                <>
                    <button
                        onClick={togglePlayPause}
                        className="fixed bottom-8 right-8 bg-red-600 hover:bg-red-700 text-white p-4 rounded-full shadow-lg transition duration-300 ease-in-out transform hover:scale-110 active:scale-90 z-50 flex items-center justify-center w-14 h-14"
                        aria-label={isPlaying ? "Mettre la musique en pause" : "Jouer la musique"}
                    >
                        {isPlaying ? <PauseIcon /> : <PlayIcon />}
                    </button>
                    {showAutoplayMessage && (
                        <div className="fixed bottom-24 right-8 bg-yellow-500 text-gray-900 px-4 py-2 rounded-lg shadow-lg text-sm animate-fade-in z-50">
                            Cliquez sur le bouton de lecture pour lancer la musique !
                        </div>
                    )}
                </>
            );
        };


        // Composant principal de l'application
        const App = () => {
            // Configuration Firebase (REMPLACEZ CES VALEURS PAR LES VÔTRES)
            // Vous trouverez ces informations dans la console Firebase > Paramètres du projet > Vos applications
            const firebaseConfig = {
                apiKey: "AIzaSyAIveRWw9gBJ_aHWarkg8e8OBlExT79KI8",
                authDomain: "brmotorsport-website-prod.firebaseapp.com",
                projectId: "brmotorsport-website-prod",
                storageBucket: "brmotorsport-website-prod.firebasestorage.app",
                messagingSenderId: "363694610989",
                appId: "1:363694610989:web:3cbbe3423dc2f89c1d36a4",
                // measurementId: "G-7GDLE3WVJ7" // measurementId n'est pas utilisé dans le SDK Firebase JS pour le web initialisation simple
            };

            // Contenu par défaut de l'application
            const defaultContent = {
                home: {
                    mainTitle: "BRMOTORSPORT",
                    description: "Spécialiste de la reprogrammation moteur et de l'optimisation de véhicules. Performance, fiabilité et satisfaction client sont nos maîtres mots.",
                    contactMessage: "Contactez-nous dès aujourd'hui pour transformer votre véhicule !",
                    offerTitle: "Nos Offres",
                    offer1Title: "Reprogrammation Moteur",
                    offer1Description: "Optimisation des performances et de la consommation de votre véhicule.",
                    offer2Title: "Diagnostic Électronique",
                    offer2Description: "Identification précise des problèmes moteur et électroniques.",
                    offer3Title: "Préparation de Véhicule",
                    offer3Description: "Solutions complètes pour piste et route, du châssis au moteur.",
                    offer4Title: "Conseil Personnalisé",
                    offer4Description: "Accompagnement expert pour tous vos projets automobiles.",
                    trustTitle: "Pourquoi nous faire confiance ?",
                    trust1Title: "Rapidité d'Intervention",
                    trust1Description: "Des délais optimisés pour que vous retrouviez votre véhicule au plus vite.",
                    trust2Title: "Transparence et Confiance",
                    trust2Description: "Une communication claire et honnête à chaque étape du processus.",
                    trust3Title: "Qualité Garantie",
                    trust3Description: "Des prestations de haute qualité avec des résultats mesurables.",
                    trust4Title: "Satisfaction Client",
                    trust4Description: "Votre plaisir de conduire est notre plus grande réussite.",
                    teamTitle: "Notre Équipe",
                    teamDescription: "Notre équipe est composée de professionnels passionnés et expérimentés, dévoués à l'excellence automobile."
                },
                blog: {
                    mainTitle: "Notre Blog BRMOTORSPORT",
                    description: "Découvrez nos dernières actualités, projets et optimisations automobiles.",
                    posts: [
                        { id: 1, image: "https://placehold.co/600x400/000/FFF?text=Porsche_Cayenne", title: "Porsche Cayenne V8 Bi-Turbo : Optimisation Moteur", description: "Découvrez notre travail sur cette bête de course, avec des améliorations de performances significatives pour une expérience de conduite ultime." },
                        { id: 2, image: "https://placehold.co/600x400/000/FFF?text=BMW_Serie2", title: "BMW Série 2 : Reprogrammation et FAP OFF", description: "Optimisation de la BMW Série 2 avec suppression du FAP et reprogrammation moteur pour une performance accrue et une meilleure réactivité." },
                        { id: 3, image: "https://placehold.co/600x400/000/FFF?text=VW_Golf_GTI", title: "VW Golf GTI : Boost de Performance Ultime", description: "La Golf GTI a retrouvé sa jeunesse avec une augmentation de puissance notable. Un véritable plaisir de conduite redécouvert !" },
                        { id: 4, image: "https://placehold.co/600x400/000/FFF?text=Seat_Ibiza", title: "Seat Ibiza : Amélioration de la Réactivité Moteur", description: "Transformation de cette Seat Ibiza pour une meilleure réponse à l'accélération et à une conduite plus dynamique. Un plaisir garantini." },
                        { id: 5, image: "https://placehold.co/600x400/000/FFF?text=VW_Golf_5_GTI", title: "VW Golf 5 GTI : Mise à Jour Cartographie", description: "Une mise à Jour complète de la cartographie pour cette Golf 5 GTI, optimisant la puissance et la consommation. Plus performante que jamais !" },
                        { id: 6, image: "https://placehold.co/600x400/000/FFF?text=Peugeot_206_HDi", title: "Peugeot 206 1.4 HDi : Préparation Complète et Optimisation", description: "Rien n'a été laissé au hasard sur cette magnifique 206 1.4 hdi : mécanique (embrayage renforcé, turbo 1.6hdi v2, graissage renforcé, EGR off, filtre à carburant modifié, collecteur d'échappement modifié, reprogrammation sur mesure, admission sur mesure, dégazage haut moteur réaspiré, ligne tube 51mm, boost contrôleur avec réglage optimum), châssis (décrantage train arrière, combinés KW, jantes alu 16, réflexion train roulant à neuf), esthétique (passage de coque en blanc, peinture banquette couleur carrosserie, béquet 206 Rc, peinture blanche jantes, intérieur complet 206 Rc, clignotant latéral led)." },
                        { id: 7, image: "https://placehold.co/600x400/000/FFF?text=Seat_Leon", title: "Seat Leon : Optimisation Moteur Stage 2 (2.0 TDI 170 @230)", description: "Découvrez l'optimisation de cette Seat Leon : FAP off, EGR off, et Reprogrammation Stage 2 pour des performances accrues, passant de 170 à 230 chevaux et un couple de 370 à 450 Nm." },
                        { id: 8, image: "https://placehold.co/600x400/000/FFF?text=Ancienne_Voiture", title: "Ancienne Voiture : Dépannage Express et Remplacement Bobine", description: "Tombée en panne un dimanche, nous avons diagnostiqué et résolu le problème en 1h. Notre client a pu repartir avec sa voiture, grâce à une recherche de panne efficace et le remplacement de la bobine. Votre tranquillité, notre priorité." },
                        { id: 9, image: "https://placehold.co/600x400/000/FFF?text=Audi_TFSI", title: "Audi 1.5 TFSI 150 : Optimisation Stage 1 et TCU", description: "Optimisation de cette Audi 1.5 TFSI, avec un passage de 150 à 180 chevaux (Stage 1) et une modification de l'unité de contrôle de la transmission (TCU mod 1) pour une meilleure réactivité." },
                        { id: 10, image: "https://placehold.co/600x400/000/FFF?text=Triumph_TR3", title: "Triumph TR3 : Check-up Complet et Optimisation", description: "Réalisation d'un check-up complet sur cette Triumph TR3, assurant son bon fonctionnement et sa fiabilité. Votre sécurité et performance sont notre priorité." },
                        { id: 11, image: "https://placehold.co/600x400/000/FFF?text=Mercedes_2021", title: "Mercedes (2021) : Solution ADBLUE", description: "Mise en place d'une solution AdBlue pour ce modèle Mercedes 2021, garantissant la conformité environnementale et le bon fonctionnement du système." }
                    ]
                },
                aboutUs: {
                    mainTitle: "Qui sommes-nous ?",
                    description: "BRMOTORSPORT est votre partenaire de confiance pour l'optimisation automobile. Fondée sur la passion de la performance et de la mécanique, notre entreprise s'engage à offrir des services de reprogrammation moteur, de préparation de véhicules et de diagnostics électroniques de pointe.",
                    historyTitle: "Notre Histoire",
                    historyParagraph1: "Notre aventure a débuté il y a plusieurs années, animée par une vision : celle de repousser les limites de la performance automobile tout en garantissant une fiabilité et une sécurité optimale. Forts d'une expertise technique approfondie et d'une passion inébranlable pour les voitures, nous avons bâti BRMOTORSPORT sur des valeurs de précision, d'innovation et de dévouement. Chaque véhicule qui passe entre nos mains est traité avec le plus grand soin, comme si c'était le nôtre.",
                    historyParagraph2: "Au fil des ans, nous avons développé des compétences uniques en reprogrammation sur mesure, en travaillant avec les technologies les plus avancées pour extraire le potentiel caché de chaque moteur. Notre histoire est marquée par des milliers de clients satisfaits, des voitures transformées et une réputation bâtie sur l'excellence. Nous sommes fiers de notre parcours et de l'impact que nous avons sur la performance et le plaisir de conduite de nos clients.",
                    valuesTitle: "Nos Valeurs",
                    value1Title: "Expertise Technique",
                    value1Description: "Une connaissance approfondie des systèmes moteurs et des technologies d'optimisation.",
                    value2Title: "Innovation Continue",
                    value2Description: "Veille technologique et développement de solutions toujours plus performantes.",
                    value3Title: "Qualité et Fiabilité",
                    value3Description: "Des interventions rigoureuses pour une durabilité et une sécurité maximales.",
                    value4Title: "Service Client Exceptionnel",
                    value4Description: "Écoute, conseil personnalisé et accompagnement pour une satisfaction totale."
                },
                contact: {
                    mainTitle: "Contactez-nous",
                    description: "Nous sommes là pour répondre à toutes vos questions et vous accompagner dans vos projets d'optimisation automobile.",
                    emailTitle: "Email",
                    email: "contact@brmotorsport.com",
                    phoneTitle: "Téléphone",
                    phoneNumber: "06.12.34.56.78",
                    instagramTitle: "Instagram",
                    instagramHandle: "@brmotorsport_official"
                },
                legalMentions: {
                    mainTitle: "Mentions Légales",
                    sectionTitle: "Informations Générales",
                    paragraph1: "Ce site web est édité par BRMOTORSPORT.",
                    paragraph2: "Adresse : [Votre Adresse Complète]",
                    list1Item1: "Numéro de téléphone : [Votre Numéro de Téléphone]",
                    list1Item2: "Adresse e-mail : [Votre E-mail]",
                    list1Item3: "Numéro d'immatriculation : [Votre Numéro SIRET/RCS]",
                    paragraph3: "Directeur de la publication : Monsieur [Votre Nom]",
                    list2Item1: "Hébergeur : GitHub Pages",
                    list2Item2: "Adresse : [Adresse de GitHub]",
                    list2Item3: "Site web : https://github.com",
                    paragraph4: "Propriété intellectuelle : L'ensemble des éléments de ce site (textes, images, graphismes, logos, icônes, etc.) est la propriété exclusive de BRMOTORSPORT, sauf mention contraire. Toute reproduction, représentation, modification, publication, adaptation de tout ou partie des éléments du site, quel que soit le moyen ou le procédé utilisé, est interdite, sauf autorisation écrite préalable de BRMOTORSPORT."
                },
                privacyPolicy: {
                    mainTitle: "Politique de Confidentialité",
                    introTitle: "Introduction",
                    introText: "La présente politique de confidentialité décrit comment BRMOTORSPORT collecte, utilise et protège vos informations personnelles lorsque vous utilisez notre site web.",
                    collectionTitle: "Collecte des Informations Personnelles",
                    collectionText: "Nous collectons des informations lorsque vous nous contactez via le formulaire de contact, lorsque vous naviguez sur notre site, ou lorsque vous interagissez avec nos services. Les informations collectées peuvent inclure votre nom, adresse e-mail, numéro de téléphone, et toute autre information que vous choisissez de nous fournir.",
                    usageTitle: "Utilisation des Informations",
                    usageListItem1: "Pour répondre à vos demandes et vous fournir les services que vous avez sollicités.",
                    usageListItem2: "Pour améliorer notre site web et nos offres de services.",
                    usageListItem3: "Pour vous envoyer des communications marketing (avec votre consentement).",
                    protectionTitle: "Protection des Informations",
                    protectionText: "Nous mettons en œuvre diverses mesures de sécurité pour maintenir la sûreté de vos informations personnelles. Seuls les employés qui ont besoin d'effectuer un travail spécifique (par exemple, la facturation ou le service client) ont accès aux informations personnelles identifiables.",
                    rightsTitle: "Vos Droits",
                    rightsText: "Conformément au Règlement Général sur la Protection des Données (RGPD), vous disposez d'un droit d'accès, de rectification, de suppression et d'opposition au traitement de vos données personnelles. Pour exercer ces droits, veuillez nous contacter à [Votre Adresse E-mail].",
                    disclaimerText: "Cette politique de confidentialité peut être mise à jour occasionnellement. Nous vous invitons à la consulter régulièrement."
                },
                showcaseCar: {
                    mainTitle: "Notre Voiture Vitrine",
                    description: "Découvrez notre dernière préparation exceptionnelle : une Volkswagen Scirocco R avec une optimisation Stage 3 poussée, développant plus de 500 chevaux.",
                    preparationTitle: "Détails de la Préparation Stage 3",
                    preparationDescription: "Ce véhicule a subi une transformation complète pour atteindre des niveaux de performance extrêmes, tout en conservant une fiabilité optimale.",
                    piston: "Pistons forgés",
                    bielles: "Bielles forgées",
                    soupapes: "Soupapes renforcées",
                    adm: "Admission gros volume",
                    ressort: "Ressorts de soupapes renforcés",
                    viserie: "Vis de bielles, vilebrequin et culasse renforcées",
                    pompeHuile: "Pompe à huile gros débit",
                    turbo: "Turbo hybride sur mesure",
                    wastegate: "Wastegate externe",
                    injecteurs: "Injecteurs gros débit",
                    pipAdmission: "Pipe d'admission gros volume",
                    wmi: "Système WMI (Water-Methanol Injection)",
                    embrayage: "Embrayage renforcé",
                    finalDescription: "Chaque composant a été soigneusement sélectionné et installé pour garantir une synergie parfaite et une expérience de conduite inégalée sur route comme sur circuit.",
                    images: [ // AJOUT DE CE TABLEAU D'IMAGES
                        "https://placehold.co/800x500/FF0000/FFFFFF?text=Scirocco+R+1",
                        "https://placehold.co/800x500/00FF00/FFFFFF?text=Scirocco+R+2",
                        "https://placehold.co/800x500/0000FF/FFFFFF?text=Scirocco+R+3"
                    ]
                }
            };

            // Initialise isAdminAuthenticated en lisant depuis localStorage
            const [isAdminAuthenticated, setIsAdminAuthenticated] = useState(
                localStorage.getItem('isAdminAuthenticated') === 'true'
            );
            const [currentPage, setCurrentPage] = useState('accueil');
            // Initialiser le contenu avec les données par défaut avant le chargement de Firebase
            const [content, setContent] = useState(defaultContent); 
            const [loadingContent, setLoadingContent] = useState(true);
            const [errorContent, setErrorContent] = useState(null);
            const [firebaseInitialized, setFirebaseInitialized] = useState(false);
            const [authReady, setAuthReady] = useState(false); // New state to track auth readiness

            // Initialisation de Firebase et écoute des changements de contenu Firestore
            useEffect(() => {
                const initFirebaseAndFetchContent = async () => {
                    // Assurez-vous que window.firebase est disponible (chargé par le script module)
                    if (window.firebase && !firebaseInitialized) {
                        try {
                            firebaseApp = window.firebase.initializeApp(firebaseConfig);
                            db = window.firebase.getFirestore(firebaseApp);
                            storage = window.firebase.getStorage(firebaseApp);
                            
                            const auth = window.firebase.getAuth(firebaseApp);
                            try {
                                if (typeof __initial_auth_token !== 'undefined' && __initial_auth_token) {
                                    await window.firebase.signInWithCustomToken(auth, __initial_auth_token);
                                    console.log("Firebase Auth: Signed in with custom token.");
                                } else {
                                    await window.firebase.signInAnonymously(auth);
                                    console.log("Firebase Auth: Signed in anonymously.");
                                }
                                setAuthReady(true); // Set auth ready after successful sign-in
                            } catch (authError) {
                                console.error("Firebase Auth Error during sign-in:", authError);
                                setAuthReady(false); // Auth failed
                                setErrorContent(`Erreur d'authentification Firebase : ${authError.message}`);
                            }
                            
                            setFirebaseInitialized(true); // Mark Firebase as initialized after auth attempt
                            console.log("Firebase initialisé !");

                            // Écoute en temps réel des changements du document 'appContent' dans la collection 'content'
                            const contentDocRef = window.firebase.doc(db, 'content', 'appContent');
                            window.firebase.onSnapshot(contentDocRef, (docSnap) => {
                                if (docSnap.exists()) {
                                    const fetchedContent = docSnap.data();
                                    const hasContentKeys = Object.keys(fetchedContent).some(key => key !== 'version');
                                    if (!hasContentKeys) { 
                                        console.log("Document 'appContent' trouvé mais vide/incomplet. Remplissage avec le contenu par défaut.");
                                        setContent(defaultContent); 
                                        window.firebase.setDoc(contentDocRef, defaultContent)
                                            .then(() => console.log("Document de contenu par défaut créé/mis à jour dans Firestore."))
                                            .catch(err => console.error("Erreur lors de la création/mise à jour du document par défaut dans Firestore:", err));
                                    } else {
                                        setContent(fetchedContent);
                                        console.log("Contenu de Firestore mis à jour :", fetchedContent);
                                    }
                                    setLoadingContent(false);
                                } else {
                                    console.log("Document 'appContent' introuvable dans Firestore. Utilisation et création du contenu par défaut.");
                                    setContent(defaultContent); 
                                    window.firebase.setDoc(contentDocRef, defaultContent)
                                        .then(() => console.log("Document de contenu par défaut créé dans Firestore."))
                                        .catch(err => console.error("Erreur lors de la création du document par défaut dans Firestore:", err));
                                    setLoadingContent(false);
                                }
                            }, (error) => {
                                console.error("Erreur lors de l'écoute des changements Firestore :", error);
                                setErrorContent("Impossible de charger le contenu du site. Veuillez réessayer plus tard.");
                                setLoadingContent(false);
                            });
                        } catch (error) {
                            console.error("Erreur lors de l'initialisation de Firebase (général):", error);
                            setErrorContent("Impossible d'initialiser Firebase. Vérifiez votre configuration et votre connexion.");
                            setLoadingContent(false);
                        }
                    }
                };

                initFirebaseAndFetchContent();
            }, [firebaseInitialized]); 


            // Fonction pour mettre à jour une partie spécifique du contenu dans Firestore
            // Cette fonction est utilisée par les composants enfants (ex: AdminPanelPage, EditableText)
            const updateContentInFirestore = async (keyPath, newValue) => {
                if (!db) {
                    console.error("Firestore n'est pas initialisé.");
                    return;
                }
                setLoadingContent(true); // Afficher un état de chargement global pour les mises à jour

                const contentDocRef = window.firebase.doc(db, 'content', 'appContent');
                try {
                    // Nous allons toujours obtenir le document actuel avant de le modifier pour éviter d'écraser des données
                    const docSnap = await window.firebase.getDoc(contentDocRef);
                    let currentContent = docSnap.exists() ? docSnap.data() : {};

                    // Si keyPath est null, cela signifie que nous passons un objet de contenu complet
                    if (keyPath === null && typeof newValue === 'object') {
                        currentContent = newValue;
                    } else {
                        // Utiliser setNestedProperty pour mettre à jour localement l'objet avant l'envoi
                        setNestedProperty(currentContent, keyPath, newValue);
                    }

                    await window.firebase.setDoc(contentDocRef, currentContent); // setDoc écrase ou crée le document
                    console.log(`Contenu de "${keyPath || 'l\'ensemble du document'}" mis à jour dans Firestore.`);
                    setLoadingContent(false);
                } catch (error) {
                    console.error(`Erreur lors de la mise à jour de "${keyPath || 'l\'ensemble du document'}" dans Firestore :`, error);
                    setErrorContent(`Échec de la mise à jour du contenu: ${error.message}`);
                    setLoadingContent(false);
                }
            };


            // Fonction de déconnexion de l'administrateur
            const handleLogout = () => {
                setIsAdminAuthenticated(false);
                localStorage.removeItem('isAdminAuthenticated');
                setCurrentPage('accueil');
            };

            // Ajout d'un effet pour faire défiler la page vers le haut à chaque changement de page
            useEffect(() => {
                window.scrollTo(0, 0);
            }, [currentPage]);

            if (loadingContent) {
                return (
                    <div className="min-h-screen flex items-center justify-center bg-black text-white text-3xl">
                        Chargement du contenu...
                    </div>
                );
            }

            if (errorContent) {
                return (
                    <div className="min-h-screen flex items-center justify-center bg-red-900 text-white text-xl p-4 text-center">
                        Erreur: {errorContent}
                    </div>
                );
            }

            // Fonction de rendu du contenu de la page en fonction de l'état
            const renderPage = () => {
              switch (currentPage) {
                case 'accueil':
                  return <HomePage setCurrentPage={setCurrentPage} isAdminAuthenticated={isAdminAuthenticated} />;
                case 'blog':
                  return <BlogPage isAdminAuthenticated={isAdminAuthenticated} />;
                case 'qui-sommes-nous':
                  return <AboutUsPage isAdminAuthenticated={isAdminAuthenticated} />;
                case 'contact':
                  return <ContactPage isAdminAuthenticated={isAdminAuthenticated} />;
                case 'mentions-legales':
                  return <LegalMentionsPage isAdminAuthenticated={isAdminAuthenticated} />;
                case 'confidentialite':
                  return <PrivacyPolicyPage isAdminAuthenticated={isAdminAuthenticated} />;
                case 'voiture-vitrine':
                  return <ShowcaseCarPage isAdminAuthenticated={isAdminAuthenticated} />;
                case 'admin-login':
                  return <AdminLoginPage setIsAdminAuthenticated={setIsAdminAuthenticated} setCurrentPage={setCurrentPage} />;
                case 'admin-panel':
                  if (!isAdminAuthenticated) {
                    setCurrentPage('admin-login');
                    return null;
                  }
                  // Passe la fonction de mise à jour Firestore au panneau admin
                  return <AdminPanelPage setIsAdminAuthenticated={setIsAdminAuthenticated} setCurrentPage={setCurrentPage} updateContent={updateContentInFirestore} firebaseInitialized={firebaseInitialized} authReady={authReady} />; // Pass new props
                default:
                  return <HomePage setCurrentPage={setCurrentPage} isAdminAuthenticated={isAdminAuthenticated} />;
              }
            };

            return (
                <ContentContext.Provider value={{ content, updateContent: updateContentInFirestore }}>
                    <div className="min-h-screen bg-black font-inter">
                        <ScrollingBanner />
                        <Navbar setCurrentPage={setCurrentPage} isAdminAuthenticated={isAdminAuthenticated} handleLogout={handleLogout} />
                        <main className="flex-grow">
                            {renderPage()}
                        </main>
                        <MusicControl />
                        <footer className="bg-gray-900 bg-opacity-90 backdrop-blur-sm text-gray-400 py-6 text-center shadow-inner rounded-t-lg">
                            <div className="container mx-auto px-4">
                                <p>&copy; {new Date().getFullYear()} BRMOTORSPORT. Tous droits réservés.</p>
                                <div className="flex justify-center space-x-4 mt-3">
                                    <a href="#" onClick={(e) => { e.preventDefault(); setCurrentPage('confidentialite'); }} className="hover:text-red-500 transition duration-300">Confidentialité</a>
                                    <span className="text-gray-600">|</span>
                                    <a href="#" onClick={(e) => { e.preventDefault(); setCurrentPage('mentions-legales'); }} className="hover:text-red-500 transition duration-300">Mentions Légales</a>
                                    <span className="text-gray-600">|</span>
                                    {isAdminAuthenticated ? (
                                        <a href="#" onClick={(e) => { e.preventDefault(); handleLogout(); }} className="hover:text-red-500 transition duration-300">Déconnexion</a>
                                    ) : (
                                        <a href="#" onClick={(e) => { e.preventDefault(); setCurrentPage('admin-login'); }} className="hover:text-red-500 transition duration-300">Admin</a>
                                    )}
                                </div>
                                <p className="text-sm mt-2">Réalisé avec passion par Viremot Giovanni</p>
                            </div>
                        </footer>
                    </div>
                </ContentContext.Provider>
            );
        };

        const container = document.getElementById('root');
        const root = ReactDOM.createRoot(container);
        root.render(<App />);
    </script>
</body>
</html>
