<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <title>Reprogrammation Moteur Vichy (03) - BRMOTORSPORT | Stage 1 & E85</title>
    <meta name="description" content="Atelier sp√©cialiste de la reprogrammation moteur √† Vichy et Saint-Germain-des-Foss√©s (03). Gain de puissance, Stage 1, Conversion √âthanol E85, Diagnostic. Giovanni √† votre service.">
    <meta name="keywords" content="reprog vichy, reprogrammation moteur 03, stage 1 allier, e85 vichy, br motorsport, pr√©paration auto saint-germain-des-foss√©s">
    <meta name="author" content="BRMOTORSPORT">
    
    <meta property="og:title" content="BRMOTORSPORT - Reprogrammation Moteur √† Vichy (03)">
    <meta property="og:description" content="Boostez votre v√©hicule avec BRMOTORSPORT. Expert en reprogrammation et √©thanol dans l'Allier.">
    <meta property="og:image" content="logo.png">
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <style>
        html {
            overflow-y: scroll;
            overflow-x: hidden;
        }
        /* Importation des polices Inter et Montserrat */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&family=Montserrat:wght@700;800;900&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            margin: 0;
            padding: 0;
            overflow-y: scroll;
        }
        h1, h2, h3 {
            font-family: 'Montserrat', sans-serif;
        }
        /* Keyframes pour les animations */
        @keyframes fadeInDown {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        @keyframes bounceIn {
            0%, 20%, 40%, 60%, 80%, 100% {
                transition-timing-function: cubic-bezier(0.215, 0.610, 0.355, 1.000);
            }
            0% { opacity: 0; transform: scale3d(.3, .3, .3); }
            20% { transform: scale3d(1.1, 1.1, 1.1); }
            40% { transform: scale3d(.9, .9, .9); }
            60% { opacity: 1; transform: scale3d(1.03, 1.03, 1.03); }
            80% { transform: scale3d(.97, .97, .97); }
            100% { opacity: 1; transform: scale3d(1, 1, 1); }
        }
        @keyframes blob {
            0% { transform: translate(0px, 0px) scale(1); }
            33% { transform: translate(30px, -50px) scale(1.1); }
            66% { transform: translate(-20px, 20px) scale(0.9); }
            100% { transform: translate(0px, 0px) scale(1); }
        }
        @keyframes scrollText {
            0% { transform: translateX(0%); }
            100% { transform: translateX(-100%); }
        }
        @keyframes slideInFromLeft {
            from { transform: translateX(-100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        @keyframes vibrate {
            0% { transform: translate(0px, 0px); }
            25% { transform: translate(-0.5px, 0.5px); }
            50% { transform: translate(0.5px, -0.5px); }
            75% { transform: translate(-0.5px, -0.5px); }
            100% { transform: translate(0px, 0px); }
        }

        .animate-fade-in-down { animation: fadeInDown 0.8s ease-out forwards; }
        .animate-fade-in-up { animation: fadeInUp 0.8s ease-out forwards; }
        .animate-fade-in { animation: fadeIn 0.8s ease-out forwards; }
        .animate-bounce-in { animation: bounceIn 1s; }
        .animate-blob { animation: blob 7s infinite; }
        .animate-vibrate { animation: vibrate 0.15s ease-in-out infinite; }
        .animation-delay-2000 { animation-delay: 2s; }
        .animation-delay-4000 { animation-delay: 4s; }
        
        .scrolling-banner-text {
            display: inline-block;
            white-space: nowrap;
            animation: scrollText 30s linear infinite;
        }
        .scrolling-banner-container {
            overflow: hidden;
        }
        .animate-slide-in-left {
            animation: slideInFromLeft 1s ease-out forwards;
        }

        h1, h2 {
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
        }
        .delay-animation {
            animation-delay: var(--delay-factor);
        }

        /* Styles Lightbox */
        .lightbox-overlay {
            position: fixed; top: 0; left: 0; right: 0; bottom: 0;
            background-color: rgba(0, 0, 0, 0.8);
            display: flex; justify-content: center; align-items: center;
            z-index: 100; animation: fadeIn 0.3s ease-out forwards;
        }
        .lightbox-content {
            position: relative; max-width: 90%; max-height: 90%;
            display: flex; justify-content: center; align-items: center;
        }
        .lightbox-image {
            max-width: 100%; max-height: 100%; object-fit: contain; border-radius: 0.75rem;
        }
        .lightbox-button {
            background-color: rgba(0, 0, 0, 0.5); color: white; padding: 0.75rem;
            border-radius: 9999px; display: flex; align-items: center; justify-content: center;
            transition: background-color 0.2s ease-in-out; cursor: pointer; position: absolute; z-index: 101;
        }
        .lightbox-button:hover { background-color: rgba(0, 0, 0, 0.8); }
        .lightbox-close-button { top: 1rem; right: 1rem; }
        .lightbox-prev-button { left: 1rem; top: 50%; transform: translateY(-50%); }
        .lightbox-next-button { right: 1rem; top: 50%; transform: translateY(-50%); }

        /* Bouton retour haut */
        .scroll-to-top { animation: fadeIn 0.5s ease-out forwards; }
        .scroll-to-top.hidden { animation: fadeOut 0.5s ease-out forwards; opacity: 0; pointer-events: none; }
        @keyframes fadeOut { from { opacity: 1; } to { opacity: 0; } }

        /* Navbar dynamique */
        .navbar-hidden { transform: translateY(-100%); }
        .navbar-visible { transform: translateY(0); }
        .navbar-transition { transition: transform 0.3s ease-in-out; }
    </style>
</head>
<body class="min-h-screen bg-black font-inter">
    <audio id="background-music" autoplay loop volume="0.01" style="display:none;">
        <source src="musique.mp3" type="audio/mpeg"> Votre navigateur ne supporte pas l'√©l√©ment audio.
    </audio>

    <div id="root" class="overflow-x-hidden"></div>

    <script type="text/babel">
        const { useState, useEffect, useContext, createContext, useRef } = React;

        const carData = {
            "Peugeot / Citro√´n / DS": {
                "1.2 PureTech 110/130": { orig: "130 ch / 230 Nm", s1: "155 ch", s2: "170 ch", gain: "+ 65 Nm" },
                "1.5 BlueHDi 130": { orig: "130 ch / 300 Nm", s1: "165 ch", s2: "180 ch", gain: "+ 70 Nm" },
                "1.6 THP 200/208 (GTI/DS3)": { orig: "208 ch / 300 Nm", s1: "235 ch", s2: "255 ch", gain: "+ 85 Nm" },
                "2.0 HDi 136/140/150": { orig: "150 ch / 340 Nm", s1: "190 ch", s2: "210 ch", gain: "+ 95 Nm" },
                "2.0 BlueHDi 180 (508/3008)": { orig: "180 ch / 400 Nm", s1: "215 ch", s2: "235 ch", gain: "+ 85 Nm" },
                "V6 3.0 HDi 240 (C6/407)": { orig: "240 ch / 450 Nm", s1: "290 ch", s2: "310 ch", gain: "+ 110 Nm" }
            },
            "Renault / Alpine / Dacia": {
                "1.0 TCe 90/100": { orig: "100 ch / 160 Nm", s1: "125 ch", s2: "135 ch", gain: "+ 55 Nm" },
                "1.3 TCe 130/140/160": { orig: "140 ch / 240 Nm", s1: "175 ch", s2: "190 ch", gain: "+ 80 Nm" },
                "1.5 dCi 90/110": { orig: "110 ch / 260 Nm", s1: "140 ch", s2: "155 ch", gain: "+ 70 Nm" },
                "1.6 dCi 130/160": { orig: "160 ch / 380 Nm", s1: "195 ch", s2: "215 ch", gain: "+ 85 Nm" },
                "2.0 dCi 150/175/180": { orig: "175 ch / 360 Nm", s1: "210 ch", s2: "230 ch", gain: "+ 90 Nm" },
                "1.8 Turbo 252/300 (Alpine/RS)": { orig: "300 ch / 400 Nm", s1: "340 ch", s2: "370 ch", gain: "+ 110 Nm" },
                "2.0 Turbo 275 (M3RS)": { orig: "275 ch / 360 Nm", s1: "315 ch", s2: "345 ch", gain: "+ 125 Nm" }
            },
            "Groupe VAG (1.9 TDI & Sport)": {
                "1.9 TDI 90/105/110": { orig: "105 ch / 250 Nm", s1: "145 ch", s2: "160 ch", gain: "+ 90 Nm" },
                "1.9 TDI 130/150/160": { orig: "150 ch / 320 Nm", s1: "195 ch", s2: "220 ch", gain: "+ 120 Nm" },
                "2.0 TDI 140/150/184": { orig: "150 ch / 340 Nm", s1: "195 ch", s2: "215 ch", gain: "+ 110 Nm" },
                "3.0 TDI V6 245/272": { orig: "272 ch / 600 Nm", s1: "320 ch", s2: "350 ch", gain: "+ 130 Nm" },
                "2.0 TSI 230/300/310": { orig: "310 ch / 400 Nm", s1: "375 ch", s2: "410 ch", gain: "+ 135 Nm" },
                "RS3/RS6/RSQ8": { orig: "600 ch / 800 Nm", s1: "700 ch", s2: "780 ch", gain: "+ 240 Nm" }
            },
            "BMW / Mercedes / Sport": {
                "118d/120d/320d (2.0 D)": { orig: "190 ch / 400 Nm", s1: "230 ch", s2: "250 ch", gain: "+ 100 Nm" },
                "330d/335d/435d (3.0 D)": { orig: "313 ch / 630 Nm", s1: "375 ch", s2: "410 ch", gain: "+ 145 Nm" },
                "M140i/M240i/340i (B58)": { orig: "340 ch / 500 Nm", s1: "420 ch", s2: "470 ch", gain: "+ 160 Nm" },
                "A45/CLA45 AMG": { orig: "381 ch / 475 Nm", s1: "425 ch", s2: "450 ch", gain: "+ 120 Nm" },
                "C63/E63/G63 AMG": { orig: "510 ch / 700 Nm", s1: "610 ch", s2: "680 ch", gain: "+ 190 Nm" }
            },
            "Utilitaires (Experts & Pros)": {
                "Expert/Jumpy (2.0 HDi 120/150)": { orig: "150 ch / 370 Nm", s1: "195 ch", s2: "215 ch", gain: "+ 105 Nm" },
                "Master/Traffic (2.3 dCi 130)": { orig: "130 ch / 330 Nm", s1: "170 ch", s2: "195 ch", gain: "+ 120 Nm" },
                "Boxer/Jumper (2.2 BlueHDi 140)": { orig: "140 ch / 340 Nm", s1: "180 ch", s2: "200 ch", gain: "+ 90 Nm" },
                "Transit Custom (2.0 TDCI)": { orig: "130 ch / 385 Nm", s1: "185 ch", s2: "210 ch", gain: "+ 125 Nm" },
                "Daily (3.0 HPI 150/180)": { orig: "180 ch / 430 Nm", s1: "230 ch", s2: "260 ch", gain: "+ 160 Nm" },
                "Sprinter (2.2/3.0 CDI)": { orig: "163 ch / 360 Nm", s1: "200 ch", s2: "225 ch", gain: "+ 100 Nm" }
            }
        };

        const PerformanceSelector = () => {
            const [brand, setBrand] = useState("Peugeot / Citro√´n / DS");
            const [model, setModel] = useState("2.0 HDi 136/140/150");
            const stats = carData[brand][model];

            return (
                <div className="max-w-4xl mx-auto bg-gray-900/80 border border-gray-800 p-8 rounded-3xl shadow-2xl backdrop-blur-md">
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-6 mb-10 text-left">
                        <div className="space-y-2">
                            <label className="text-xs uppercase font-bold text-gray-500 tracking-widest">1. Choisir le Groupe</label>
                            <select 
                                value={brand} 
                                onChange={(e) => { setBrand(e.target.value); setModel(Object.keys(carData[e.target.value])[0]); }} 
                                className="w-full bg-gray-800 text-white p-4 rounded-xl border border-gray-700 outline-none focus:border-blue-500 transition cursor-pointer font-bold"
                            >
                                {Object.keys(carData).map(b => <option key={b} value={b}>{b}</option>)}
                            </select>
                        </div>
                        <div className="space-y-2">
                            <label className="text-xs uppercase font-bold text-gray-500 tracking-widest">2. Motorisation</label>
                            <select 
                                value={model} 
                                onChange={(e) => setModel(e.target.value)} 
                                className="w-full bg-gray-800 text-white p-4 rounded-xl border border-gray-700 outline-none focus:border-blue-500 transition cursor-pointer font-bold"
                            >
                                {Object.keys(carData[brand]).map(m => <option key={m} value={m}>{m}</option>)}
                            </select>
                        </div>
                    </div>

                    <div className="grid grid-cols-1 md:grid-cols-3 gap-4 border-t border-gray-800 pt-8">
                        <div className="bg-gray-800/50 p-6 rounded-2xl text-center border border-gray-700 hover:bg-gray-800/80 transition">
                            <span className="block text-gray-400 text-xs font-bold mb-2 uppercase italic tracking-widest">Origine</span>
                            <span className="text-xl font-black text-white">{stats.orig}</span>
                        </div>
                        <div className="bg-blue-900/20 p-6 rounded-2xl text-center border border-blue-500/50 transform scale-105 shadow-xl hover:bg-blue-900/30 transition">
                            <span className="block text-blue-400 text-xs font-bold mb-2 uppercase italic tracking-widest">Stage 1</span>
                            <span className="text-3xl font-black text-white">{stats.s1}</span>
                            <span className="block text-blue-400 text-sm font-bold mt-1">{stats.gain}</span>
                        </div>
                        <div className="bg-orange-900/20 p-6 rounded-2xl text-center border border-orange-500/50 hover:bg-orange-900/30 transition">
                            <span className="block text-orange-400 text-xs font-bold mb-2 uppercase italic tracking-widest">Stage 2</span>
                            <span className="text-2xl font-black text-white">{stats.s2}</span>
                            <span className="block text-orange-400 text-xs mt-1 italic">Setup sur mesure</span>
                        </div>
                    </div>
                </div>
            );
        };

        /* --- Ic√¥nes --- */
        const CarIcon = () => (<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="lucide lucide-car"><path d="M19 17H5c-1.1 0-2 .9-2 2v2h18v-2c0-1.1-.9-2-2-2Z"/><path d="M7 17V5h12v12"/><path d="M18 10h-8"/><path d="M10 10v7"/></svg>);
        const HandshakeIcon = () => (<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="lucide lucude-handshake"><path d="M12.23 20.73a4.7 4.7 0 0 0 6.64-6.64L12.23 7.07l-2.06 2.06"/><path d="M16 16l-3.23 3.23a4.7 4.7 0 0 1-6.64-6.64L9.07 7.07l2.06 2.06"/><path d="M14 10l-2.06 2.06"/><path d="m10 14 2.06-2.06"/></svg>);
        const WrenchIcon = () => (<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="lucide lucide-wrench"><path d="M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-3.77 3.77a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94-7.94l-3.77-3.77z"/><path d="M5.5 12.5l-3-3L12.5 2.5l3 3z"/></svg>);
        const CalendarIcon = () => (<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="lucide lucide-calendar-days"><path d="M8 2v4"/><path d="M16 2v4"/><rect width="18" height="18" x="3" y="4" rx="2"/><path d="M3 10h18"/><path d="M8 14h.01"/><path d="M12 14h.01"/><path d="M16 14h.01"/><path d="M8 18h.01"/><path d="M12 18h.01"/><path d="M16 18h.01"/></svg>);
        const UsersIcon = () => (<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="lucide lucide-users"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M22 21v-2a4 4 0 0 0-3-3.87L16 16"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>);
        const RssIcon = () => (<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="lucide lucide-rss"><path d="M4 11a9 9 0 0 1 9 9"/><path d="M4 4a16 16 0 0 1 16 16"/><circle cx="5" cy="19" r="1"/></svg>);
        const PhoneIcon = () => (<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="lucide lucide-phone"><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-3.07-8.63A2 2 0 0 1 4.11 2H7c.43 0 .79.27.94.66.14.39.07.82-.2 1.1L5.05 6.05c-.35.35-.5.85-.34 1.34A19.79 19.79 0 0 0 16.92 19c.49.16.99.01 1.34-.34l2.29-2.29c.28-.27.71-.34 1.1-.2.39.14.66.5.66.94Z"/></svg>);
        const MailIcon = () => (<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="lucide lucide-mail"><rect width="20" height="16" x="2" y="4" rx="2"/><path d="m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7"/></svg>);
        const MapPinIcon = () => (<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="lucide lucide-map-pin"><path d="M12 18s-4.5-8-4.5-11.5A4.5 4.5 0 0 1 12 2a4.5 4.5 0 0 1 4.5 4.5c0 3.5-4.5 11.5-4.5 11.5z"/><circle cx="12" cy="6.5" r="2.5"/></svg>);
        const InstagramIcon = () => (<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="lucide lucide-instagram"><rect width="20" height="20" x="2" y="2" rx="5" ry="5"/><path d="M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z"/><line x1="17.5" x2="17.5" y1="6.5" y2="6.5"/></svg>);
        const PlayIcon = () => (<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="lucide lucide-play"><polygon points="5 3 19 12 5 21 5 3"/></svg>);
        const PauseIcon = () => (<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="lucide lucide-pause"><rect x="6" y="4" width="4" height="16" rx="1"/><rect x="14" y="4" width="4" height="16" rx="1"/></svg>);
        const StarIcon = () => (<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="lucide lucide-star"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg>);
        const ArrowLeftIcon = () => (<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="lucide lucide-arrow-left"><path d="m12 19-7-7 7-7"/><path d="M19 12H5"/></svg>);
        const ArrowRightIcon = () => (<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="lucide lucide-arrow-right"><path d="M5 12h14"/><path d="m12 5 7 7-7 7"/></svg>);
        const XIcon = () => (<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="lucide lucide-x"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg>);
        const PlusIcon = () => (<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="lucide lucide-plus"><path d="M12 5v14"/><path d="M5 12h14"/></svg>);
        const MinusIcon = () => (<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="lucide lucide-minus"><path d="M5 12h14"/></svg>);
        const TargetIcon = () => (<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="lucide lucide-target"><circle cx="12" cy="12" r="10"/><circle cx="12" cy="12" r="6"/><circle cx="12" cy="12" r="2"/></svg>);
        const RotateCcwIcon = () => (<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="lucide lucide-rotate-ccw"><path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.79 2.91L3 12H3z"/><path d="M3 3v.01"/></svg>);
        const ArrowUpIcon = () => (<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M12 19V5"/><path d="m5 12 7-7 7 7"/></svg>);

        const FloatingPhoneButton = () => {
            return (
                <a href="tel:+33668278801" className="fixed bottom-6 left-6 z-50 p-4 bg-green-600 text-white rounded-full shadow-lg hover:bg-green-500 transition-all hover:scale-110 flex items-center justify-center border-2 border-white" title="Nous appeler maintenant" style={{ boxShadow: "0 0 15px rgba(22, 163, 74, 0.7)" }}>
                    <PhoneIcon />
                </a>
            );
        };

        const ContentContext = createContext();

        const setNestedProperty = (obj, path, value) => {
            const pathParts = path.split('.');
            let current = obj;
            for (let i = 0; i < pathParts.length; i++) {
                const part = pathParts[i];
                const isLastPart = (i === pathParts.length - 1);
                const isArrayIndex = !isNaN(parseInt(part)) && String(parseInt(part)) === part;
                if (isLastPart) {
                    current[isArrayIndex ? parseInt(part) : part] = value;
                } else {
                    if (isArrayIndex) {
                        if (!Array.isArray(current)) return obj;
                        if (current[parseInt(part)] === undefined || current[parseInt(part)] === null) current[parseInt(part)] = {};
                        current = current[parseInt(part)];
                    } else {
                        if (typeof current[part] !== 'object' || current[part] === null) current[part] = {};
                        current = current[part];
                    }
                }
            }
            return obj;
        };

        const EditableText = ({ tag: Tag, contentKey, isAdminAuthenticated, className }) => {
            const { content, updateContent } = useContext(ContentContext);
            const getValue = (obj, p) => {
                let current = obj;
                for (let i = 0; i < p.length; i++) {
                    const part = p[i];
                    const isArrayIndex = !isNaN(parseInt(part)) && String(parseInt(part)) === part;
                    if (isArrayIndex) {
                        if (Array.isArray(current) && current[parseInt(part)] !== undefined) current = current[parseInt(part)];
                        else return `[Contenu manquant]`;
                    } else {
                        if (current && typeof current === 'object' && current.hasOwnProperty(part)) current = current[part];
                        else return `[Contenu manquant]`;
                    }
                }
                return current;
            };
            const textValue = content ? getValue(content, contentKey.split('.')) : `Chargement...`;
            const handleChange = (e) => updateContent(contentKey, e.target.value);

            if (isAdminAuthenticated) {
                if (Tag === 'h1' || Tag === 'h2') {
                    return <input type="text" value={typeof textValue === 'string' ? textValue : ''} onChange={handleChange} className={`${className} bg-gray-700 text-white rounded p-2 focus:ring-2 focus:ring-blue-500 w-full`} />;
                }
                return <textarea value={typeof textValue === 'string' ? textValue : ''} onChange={handleChange} className={`${className} bg-gray-700 text-white rounded p-2 focus:ring-2 focus:ring-blue-500 w-full min-h-[50px]`} rows={typeof textValue === 'string' ? Math.max(3, textValue.split('\n').length) : 3} />;
            }
            return <Tag className={className} dangerouslySetInnerHTML={{ __html: typeof textValue === 'string' ? textValue : '' }} />;
        };

        const ScrollingBanner = () => {
            const bannerText = "BRMOTORSPORT ‚Ä¢ REPROGRAMMATION VICHY ‚Ä¢ SAINT-GERMAIN-DES-FOSS√âS (03) ‚Ä¢ ";
            const repeatedText = Array(10).fill(bannerText).join('');
            return (
                <div className="w-full bg-red-700 text-white text-lg font-bold py-2 overflow-hidden whitespace-nowrap fixed top-0 left-0 z-50 shadow-md">
                    <div className="scrolling-banner-container">
                        <span className="scrolling-banner-text">{repeatedText}</span>
                        <span className="scrolling-banner-text" aria-hidden="true">{repeatedText}</span>
                    </div>
                </div>
            );
        };

        const Navbar = ({ setCurrentPage, isAdminAuthenticated, handleLogout, isVisible }) => {
            const [isOpen, setIsOpen] = useState(false);
            const toggleMenu = () => setIsOpen(!isOpen);
            return (
                <nav className={`bg-gray-900 bg-opacity-90 backdrop-blur-sm p-4 fixed w-full z-50 shadow-lg rounded-b-lg top-[40px] navbar-transition ${isVisible ? 'navbar-visible' : 'navbar-hidden'}`}>
                    <div className="container mx-auto flex justify-between items-center px-4">
                        <img src="logo.png" alt="Logo" className="w-16 h-16 lg:w-32 lg:h-32 object-contain mr-4 lg:mr-8 shrink-0 transition-all duration-300" />
                        <div className="text-2xl sm:text-3xl md:text-4xl font-extrabold tracking-widest drop-shadow-lg opacity-0 animate-slide-in-left">
                            <span className="text-blue-500">BR</span><span className="text-white">MOTOR</span><span className="text-blue-500">SPORT</span>
                        </div>
                        <div className="md:hidden">
                            <button onClick={toggleMenu} className="text-gray-300 hover:text-red-500 focus:outline-none focus:ring-2 focus:ring-red-500 rounded-lg p-2">
                                <svg className="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d={isOpen ? "M6 18L18 6M6 6l12 12" : "M4 6h16M4 12h16M4 18h16"}></path>
                                </svg>
                            </button>
                        </div>
                        <div className="hidden md:flex space-x-8">
                            <NavItem icon={<CarIcon />} text="Accueil" page="accueil" setCurrentPage={setCurrentPage} />
                            <NavItem icon={<StarIcon />} text="Voiture Vitrine" page="voiture-vitrine" setCurrentPage={setCurrentPage} />
                            <NavItem icon={<RssIcon />} text="Blog" page="blog" setCurrentPage={setCurrentPage} />
                            <NavItem icon={<UsersIcon />} text="Qui Sommes-nous" page="qui-sommes-nous" setCurrentPage={setCurrentPage} />
                            <NavItem icon={<PhoneIcon />} text="Contact" page="contact" setCurrentPage={setCurrentPage} />
                            {isAdminAuthenticated ? (<NavItem text="D√©connexion" page="accueil" setCurrentPage={setCurrentPage} onClick={handleLogout} />) : (<NavItem text="Admin" page="admin-login" setCurrentPage={setCurrentPage} />)}
                        </div>
                    </div>
                    <div className={`md:hidden absolute top-full left-0 w-full bg-gray-900 bg-opacity-95 backdrop-blur-sm shadow-lg transform transition-transform duration-300 ease-in-out ${isOpen ? 'translate-x-0' : '-translate-x-full'} z-40`}>
                        <div className="flex flex-col items-center py-4 space-y-4">
                            <NavItem icon={<CarIcon />} text="Accueil" page="accueil" setCurrentPage={setCurrentPage} onClick={() => setIsOpen(false)} />
                            <NavItem icon={<StarIcon />} text="Voiture Vitrine" page="voiture-vitrine" setCurrentPage={setCurrentPage} onClick={() => setIsOpen(false)} />
                            <NavItem icon={<RssIcon />} text="Blog" page="blog" setCurrentPage={setCurrentPage} onClick={() => setIsOpen(false)} />
                            <NavItem icon={<UsersIcon />} text="Qui Sommes-nous" page="qui-sommes-nous" setCurrentPage={setCurrentPage} onClick={() => setIsOpen(false)} />
                            <NavItem icon={<PhoneIcon />} text="Contact" page="contact" setCurrentPage={setCurrentPage} onClick={() => setIsOpen(false)} />
                            {isAdminAuthenticated ? (<NavItem text="D√©connexion" page="accueil" setCurrentPage={setCurrentPage} onClick={() => { handleLogout(); setIsOpen(false); }} />) : (<NavItem text="Admin" page="admin-login" setCurrentPage={setCurrentPage} onClick={() => setIsOpen(false)} />)}
                        </div>
                    </div>
                </nav>
            );
        };

        const NavItem = ({ icon, text, page, setCurrentPage, onClick }) => (
            <button onClick={() => { setCurrentPage(page); if (onClick) onClick(); }} className="flex items-center text-gray-300 hover:text-red-500 transition duration-300 ease-in-out transform hover:scale-105 px-3 py-2 rounded-lg text-sm font-medium focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-opacity-50">
                {icon && <span className="mr-2 text-xl">{icon}</span>} {text}
            </button>
        );

        const ImageOfRemyBruyant = ({ className }) => {
            const imageUrl = "https://placehold.co/150x150/000/FFF?text=Remy";
            return <img src={imageUrl} alt="Portrait de R√©my Bruyant" className={className} onError={(e) => { e.target.onerror = null; e.target.src="https://placehold.co/150x150/000/FFF?text=R√©my+Bruyant"; }} />;
        };

        const ServiceCard = ({ icon, titleKey, descriptionKey, style, isAdminAuthenticated }) => (
            <div className="group bg-gray-800 p-8 rounded-xl shadow-lg flex flex-col items-center text-center transition duration-300 ease-in-out transform hover:scale-105 hover:bg-gray-700 border border-gray-700 hover:border-red-500 animate-fade-in-up delay-animation" style={style}>
                <div className="text-red-500 mb-4 text-5xl transition-colors duration-300 group-hover:text-red-400">{icon}</div>
                <EditableText tag="h3" contentKey={titleKey} isAdminAuthenticated={isAdminAuthenticated} className="text-xl sm:text-2xl font-semibold mb-3 text-white transition-colors duration-300 group-hover:text-red-200" />
                <EditableText tag="p" contentKey={descriptionKey} isAdminAuthenticated={isAdminAuthenticated} className="text-gray-300" />
            </div>
        );

        const TrustCard = ({ icon, titleKey, descriptionKey, style, isAdminAuthenticated }) => (
            <div className="group bg-gray-800 p-8 rounded-xl shadow-lg flex flex-col items-center text-center transition duration-300 ease-in-out transform hover:scale-105 hover:bg-gray-700 border border-gray-700 hover:border-blue-500 animate-fade-in-up delay-animation" style={style}>
                <div className="text-blue-500 mb-4 text-5xl transition-colors duration-300 group-hover:text-blue-400">{icon}</div>
                <EditableText tag="h3" contentKey={titleKey} isAdminAuthenticated={isAdminAuthenticated} className="text-xl sm:text-2xl font-semibold mb-3 text-white transition-colors duration-300 group-hover:text-blue-200" />
                <EditableText tag="p" contentKey={descriptionKey} isAdminAuthenticated={isAdminAuthenticated} className="text-gray-300" />
            </div>
        );

        const Lightbox = ({ images, currentIndex, onClose, onNavigate }) => {
            if (!images || images.length === 0) return null;
            useEffect(() => {
                const handleKeyDown = (e) => {
                    if (e.key === 'Escape') onClose();
                    else if (e.key === 'ArrowLeft') onNavigate(currentIndex === 0 ? images.length - 1 : currentIndex - 1);
                    else if (e.key === 'ArrowRight') onNavigate((currentIndex + 1) % images.length);
                };
                window.addEventListener('keydown', handleKeyDown);
                return () => window.removeEventListener('keydown', handleKeyDown);
            }, [currentIndex, images.length, onClose]);
            return (
                <div className="lightbox-overlay" onClick={onClose}>
                    <div className="lightbox-content" onClick={(e) => e.stopPropagation()}>
                        <button className="lightbox-button lightbox-close-button" onClick={onClose}><XIcon /></button>
                        {images.length > 1 && <button className="lightbox-button lightbox-prev-button" onClick={() => onNavigate(currentIndex === 0 ? images.length - 1 : currentIndex - 1)}><ArrowLeftIcon /></button>}
                        <img src={images[currentIndex]} alt={`Image ${currentIndex + 1}`} className="lightbox-image" onError={(e) => { e.target.onerror = null; e.target.src="https://placehold.co/800x600/000/FFF?text=Image+non+trouv√©e"; }} />
                        {images.length > 1 && <button className="lightbox-button lightbox-next-button" onClick={() => onNavigate((currentIndex + 1) % images.length)}><ArrowRightIcon /></button>}
                    </div>
                </div>
            );
        };

        const BlogPostCard = ({ post, style, openLightbox }) => {
            const [currentImageIndex, setCurrentImageIndex] = useState(0);
            const [isPlaying, setIsPlaying] = useState(true);
            useEffect(() => {
                let interval;
                if (isPlaying && post.images && post.images.length > 1) {
                    interval = setInterval(() => setCurrentImageIndex((prev) => (prev + 1) % post.images.length), 3000);
                }
                return () => clearInterval(interval);
            }, [isPlaying, post.images]);
            const displayImage = post.images && post.images.length > 0 ? post.images[currentImageIndex] : "https://placehold.co/600x400/000/FFF?text=Image+non+trouv√©e";
            return (
                <div className="bg-gray-800 rounded-xl shadow-lg overflow-hidden transform transition duration-300 ease-in-out hover:scale-105 hover:shadow-2xl hover:shadow-green-500/50 border border-gray-700 hover:border-green-400 animate-fade-in-up delay-animation" style={style}>
                    <div className="relative w-full h-64 overflow-hidden cursor-pointer" onClick={() => post.images && post.images.length > 0 && openLightbox(post.images, currentImageIndex)}>
                        <img src={displayImage} alt={post.title} className="w-full h-full object-cover object-center transition-opacity duration-700" onError={(e) => { e.target.onerror = null; e.target.src=`https://placehold.co/600x400/000/FFF?text=Image+non+trouv√©e`; }} />
                        {post.images && post.images.length > 1 && (
                            <>
                                <div className="absolute bottom-2 right-2 bg-black bg-opacity-70 text-white text-xs px-2 py-1 rounded">{currentImageIndex + 1} / {post.images.length}</div>
                            </>
                        )}
                    </div>
                    <div className="p-6">
                        <h3 className="text-xl sm:text-2xl font-bold mb-3 text-white leading-tight">{post.title}</h3>
                        <p className="text-gray-300 mb-4">{post.description}</p>
                        <button className="bg-gradient-to-r from-green-500 to-teal-500 text-white font-semibold py-2 px-6 rounded-full hover:from-green-600 hover:to-teal-600 transition duration-300 ease-in-out shadow-md">Lire la suite</button>
                    </div>
                </div>
            );
        };

        const HomePage = ({ setCurrentPage, isAdminAuthenticated }) => {
            return (
                <div className="min-h-screen bg-gradient-to-br from-black-950 to-emerald-950 text-white pt-40 pb-12 font-inter relative">
                    <div className="absolute inset-0 opacity-10 pointer-events-none overflow-hidden">
                        <div className="absolute w-64 h-64 bg-red-600 rounded-full mix-blend-multiply filter blur-xl opacity-70 animate-blob top-10 left-1/4"></div>
                        <div className="absolute w-72 h-72 bg-blue-600 rounded-full mix-blend-multiply filter blur-xl opacity-70 animate-blob animation-delay-2000 top-1/2 right-1/4"></div>
                        <div className="absolute w-80 h-80 bg-green-600 rounded-full mix-blend-multiply filter blur-xl opacity-70 animate-blob animation-delay-4000 bottom-10 left-1/2"></div>
                    </div>
                    <div className="container mx-auto px-6 relative z-10">
                        <section className="text-center mb-20">
                            <EditableText tag="h1" contentKey="home.mainTitle" isAdminAuthenticated={isAdminAuthenticated} className="text-4xl sm:text-5xl md:text-6xl lg:text-7xl font-extrabold mb-6 leading-tight drop-shadow-lg animate-fade-in-down animate-vibrate" />
                            <EditableText tag="p" contentKey="home.description" isAdminAuthenticated={isAdminAuthenticated} className="text-xl md:text-2xl text-gray-300 max-w-3xl mx-auto mt-10 animate-fade-in-up" />
                            <div className="flex flex-col sm:flex-row justify-center space-y-4 sm:space-y-0 sm:space-x-6 mt-8">
                                <button onClick={() => setCurrentPage('blog')} className="bg-red-600 hover:bg-red-700 text-white font-bold py-3 px-8 rounded-full shadow-lg transition duration-300 ease-in-out transform hover:scale-105 active:scale-95 animate-bounce-in">D√©couvrez notre blog</button>
                                <button onClick={() => setCurrentPage('voiture-vitrine')} className="bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-8 rounded-full shadow-lg transition duration-300 ease-in-out transform hover:scale-105 active:scale-95 animate-bounce-in">D√©couvrez √©galement notre voiture vitrine</button>
                            </div>
                        </section>
                        <section className="text-center bg-gray-800 p-8 rounded-2xl shadow-xl border border-gray-700 mb-20 animate-fade-in-up">
                            <a href="#" onClick={(e) => { e.preventDefault(); setCurrentPage('contact'); }} className="block text-xl text-gray-200 leading-relaxed max-w-3xl mx-auto font-semibold text-red-400 hover:underline cursor-pointer">
                                <EditableText tag="span" contentKey="home.contactMessage" isAdminAuthenticated={isAdminAuthenticated} className="font-semibold text-red-400" />
                            </a>
                        </section>
                        <section className="mb-20 container mx-auto px-4 text-center">
                            <h2 className="text-3xl md:text-5xl font-black uppercase italic mb-10 tracking-tighter">Catalogue <span className="text-blue-500">Performances</span> <span className="text-red-600">Interactif</span></h2>
                            <PerformanceSelector />
                            <div className="mt-10 grid grid-cols-2 md:grid-cols-4 gap-4 max-w-4xl mx-auto">
                                <div className="p-4 bg-gray-900/50 rounded-xl border border-gray-800 text-xs text-gray-400 uppercase font-bold tracking-widest">‚úÖ Banc de puissance</div>
                                <div className="p-4 bg-gray-900/50 rounded-xl border border-gray-800 text-xs text-gray-400 uppercase font-bold tracking-widest">üõ°Ô∏è Garantie 5 ans</div>
                                <div className="p-4 bg-gray-900/50 rounded-xl border border-gray-800 text-xs text-gray-400 uppercase font-bold tracking-widest">‚õΩ -1L/100km (Diesel)</div>
                                <div className="p-4 bg-gray-900/50 rounded-xl border border-gray-800 text-xs text-gray-400 uppercase font-bold tracking-widest">üèéÔ∏è Sur-mesure</div>
                            </div>
                        </section>
                        <section className="mb-20">
                            <EditableText tag="h2" contentKey="home.offerTitle" isAdminAuthenticated={isAdminAuthenticated} className="text-3xl sm:text-4xl md:text-5xl font-bold text-center mb-12 text-red-400 animate-fade-in" />
                            <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8">
                                {[
                                    { icon: <CarIcon />, titleKey: "home.offer1Title", descriptionKey: "home.offer1Description" },
                                    { icon: <span className="text-3xl">üöÄ</span>, titleKey: "home.offer2Title", descriptionKey: "home.offer2Description" },
                                    { icon: <span className="text-3xl">üìà</span>, titleKey: "home.offer3Title", descriptionKey: "home.offer3Description" },
                                    { icon: <span className="text-3xl">üí°</span>, titleKey: "home.offer4Title", descriptionKey: "home.offer4Description" }
                                ].map((service, index) => <ServiceCard key={index} icon={service.icon} titleKey={service.titleKey} descriptionKey={service.descriptionKey} isAdminAuthenticated={isAdminAuthenticated} style={{ '--delay-factor': `${index * 200}ms` }} />)}
                            </div>
                        </section>
                        <section className="mb-20">
                            <EditableText tag="h2" contentKey="home.trustTitle" isAdminAuthenticated={isAdminAuthenticated} className="text-3xl sm:text-4xl md:text-5xl font-bold text-center mb-12 text-blue-400 animate-fade-in" />
                            <div className="grid grid-cols-1 md:grid-cols-2 gap-8">
                                {[
                                    { icon: <span className="text-3xl">‚è±Ô∏è</span>, titleKey: "home.trust1Title", descriptionKey: "home.trust1Description" },
                                    { icon: <HandshakeIcon />, titleKey: "home.trust2Title", descriptionKey: "home.trust2Description" },
                                    { icon: <span className="text-3xl">üèÜ</span>, titleKey: "home.trust3Title", descriptionKey: "home.trust3Description" },
                                    { icon: <span className="text-3xl">‚≠ê</span>, titleKey: "home.trust4Title", descriptionKey: "home.trust4Description" }
                                ].map((trust, index) => <TrustCard key={index} icon={trust.icon} titleKey={trust.titleKey} descriptionKey={trust.descriptionKey} isAdminAuthenticated={isAdminAuthenticated} style={{ '--delay-factor': `${index * 200}ms` }} />)}
                            </div>
                        </section>
                        <section className="text-center mb-20 bg-gray-800 p-12 rounded-2xl shadow-xl transform transition duration-500 hover:scale-[1.02] hover:shadow-2xl hover:shadow-orange-500/50">
                            <EditableText tag="h2" contentKey="home.teamTitle" isAdminAuthenticated={isAdminAuthenticated} className="text-3xl sm:text-4xl font-bold mb-6 text-orange-400 animate-fade-in" />
                            <EditableText tag="p" contentKey="home.teamDescription" isAdminAuthenticated={isAdminAuthenticated} className="text-xl text-gray-200 leading-relaxed max-w-4xl mx-auto" />
                            <div className="mt-8"><ImageOfRemyBruyant className="mx-auto rounded-full border-4 border-red-500 shadow-lg w-32 h-32 object-cover" /></div>
                        </section>
                    </div>
                </div>
            );
        };

        const BlogPage = ({ isAdminAuthenticated }) => {
            const { content } = useContext(ContentContext);
            const blogPosts = content?.blog?.posts || [];
            const [isLightboxOpen, setIsLightboxOpen] = useState(false);
            const [lightboxImages, setLightboxImages] = useState([]);
            const [currentLightboxImageIndex, setCurrentLightboxImageIndex] = useState(0);
            const openLightbox = (images, initialIndex) => { setLightboxImages(images); setCurrentLightboxImageIndex(initialIndex); setIsLightboxOpen(true); };
            const closeLightbox = () => { setIsLightboxOpen(false); setLightboxImages([]); setCurrentLightboxImageIndex(0); };
            return (
                <div className="min-h-screen bg-gradient-to-br from-blue-950 to-emerald-950 text-white pt-40 pb-12 font-inter">
                    <div className="container mx-auto px-6">
                        <EditableText tag="h1" contentKey="blog.mainTitle" isAdminAuthenticated={isAdminAuthenticated} className="text-4xl sm:text-5xl font-extrabold text-center mb-12 text-green-400 animate-fade-in-down animate-vibrate" />
                        <EditableText tag="p" contentKey="blog.description" isAdminAuthenticated={isAdminAuthenticated} className="text-xl text-center text-gray-300 max-w-3xl mx-auto mb-10 animate-fade-in-up" />
                        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-10">
                            {blogPosts.length > 0 ? (blogPosts.map((post, index) => <BlogPostCard key={post.id || `blog-post-${index}`} post={post} style={{ '--delay-factor': `${index * 150}ms` }} openLightbox={openLightbox} />)) : (<p className="col-span-full text-center text-gray-400 text-2xl mt-10">Aucun article de blog √† afficher pour le moment.</p>)}
                        </div>
                    </div>
                    {isLightboxOpen && <Lightbox images={lightboxImages} currentIndex={currentLightboxImageIndex} onClose={closeLightbox} onNavigate={setCurrentLightboxImageIndex} />}
                </div>
            );
        };

        const InputField = ({ label, type, placeholder, required = false, value, onChange, name }) => (
            <div>
                <label htmlFor={name || label} className="block text-gray-300 text-sm font-bold mb-2">{label} {required && <span className="text-red-500">*</span>}</label>
                <input id={name || label} type={type} name={name} placeholder={placeholder} required={required} value={value} onChange={onChange} className="shadow appearance-none border border-gray-700 rounded-lg w-full py-3 px-4 bg-gray-700 text-white leading-tight focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent transition duration-200" />
            </div>
        );

        const AboutUsPage = ({ isAdminAuthenticated }) => {
            return (
                <div className="min-h-screen bg-gradient-to-br from-blue-950 to-emerald-950 text-white pt-40 pb-12 font-inter">
                    <div className="container mx-auto px-6 max-w-4xl">
                        <EditableText tag="h1" contentKey="aboutUs.mainTitle" isAdminAuthenticated={isAdminAuthenticated} className="text-4xl sm:text-5xl font-extrabold text-center mb-12 text-yellow-400 animate-fade-in-down animate-vibrate" />
                        <EditableText tag="p" contentKey="aboutUs.description" isAdminAuthenticated={isAdminAuthenticated} className="text-xl text-center text-gray-300 max-w-3xl mx-auto mb-10 animate-fade-in-up" />
                        <section className="bg-gray-800 p-8 rounded-2xl shadow-xl border border-gray-700 mb-12 animate-fade-in-up">
                            <EditableText tag="h2" contentKey="aboutUs.historyTitle" isAdminAuthenticated={isAdminAuthenticated} className="text-3xl sm:text-4xl font-bold mb-6 text-yellow-300 text-center" />
                            <EditableText tag="p" contentKey="aboutUs.historyParagraph1" isAdminAuthenticated={isAdminAuthenticated} className="text-lg text-gray-300 leading-relaxed mb-6" />
                            <EditableText tag="p" contentKey="aboutUs.historyParagraph2" isAdminAuthenticated={isAdminAuthenticated} className="text-lg text-gray-300 leading-relaxed" />
                        </section>
                        <section className="bg-gray-800 p-8 rounded-2xl shadow-xl border border-gray-700 animate-fade-in-up">
                            <EditableText tag="h2" contentKey="aboutUs.valuesTitle" isAdminAuthenticated={isAdminAuthenticated} className="text-3xl sm:text-4xl font-bold mb-6 text-yellow-300 text-center" />
                            <div className="grid grid-cols-1 md:grid-cols-2 gap-8">
                                <ValueCard titleKey="aboutUs.value1Title" descriptionKey="aboutUs.value1Description" icon={<WrenchIcon />} isAdminAuthenticated={isAdminAuthenticated} />
                                <ValueCard titleKey="aboutUs.value2Title" descriptionKey="aboutUs.value2Description" icon={<span className="text-3xl">‚ú®</span>} isAdminAuthenticated={isAdminAuthenticated} />
                                <ValueCard titleKey="aboutUs.value3Title" descriptionKey="aboutUs.value3Description" icon={<span className="text-3xl">‚úÖ</span>} isAdminAuthenticated={isAdminAuthenticated} />
                                <ValueCard titleKey="aboutUs.value4Title" descriptionKey="aboutUs.value4Description" icon={<span className="text-3xl">‚ù§Ô∏è</span>} isAdminAuthenticated={isAdminAuthenticated} />
                            </div>
                        </section>
                    </div>
                </div>
            );
        };

        const ValueCard = ({ icon, titleKey, descriptionKey, isAdminAuthenticated }) => (
            <div className="group bg-gray-700 p-6 rounded-lg shadow-md flex items-start space-x-4 transition duration-300 ease-in-out transform hover:scale-105 border border-gray-600 hover:border-yellow-400">
                <div className="text-yellow-400 mb-4 text-4xl transition-colors duration-300 group-hover:text-yellow-300">{icon}</div>
                <div><EditableText tag="h3" contentKey={titleKey} isAdminAuthenticated={isAdminAuthenticated} className="text-xl sm:text-2xl font-semibold mb-2 text-white transition-colors duration-300 group-hover:text-yellow-100" /><EditableText tag="p" contentKey={descriptionKey} isAdminAuthenticated={isAdminAuthenticated} className="text-gray-300" /></div>
            </div>
        );

        const ContactPage = ({ isAdminAuthenticated }) => {
            const { content } = useContext(ContentContext);
            const rawAddress = content?.contact?.address || "Zone industriel le coquet\n03260 Saint-Germain-des-Foss√©s";
            const mapQuery = encodeURIComponent(rawAddress.replace(/\n/g, ', '));
            const googleMapsLink = `http://maps.google.com/?q=${mapQuery}`;
            return (
                <div className="min-h-screen bg-gradient-to-br from-blue-950 to-emerald-950 text-white pt-40 pb-12 font-inter">
                    <div className="container mx-auto px-6 max-w-2xl">
                        <EditableText tag="h1" contentKey="contact.mainTitle" isAdminAuthenticated={isAdminAuthenticated} className="text-4xl sm:text-5xl font-extrabold text-center mb-12 text-pink-400 animate-fade-in-down animate-vibrate" />
                        <EditableText tag="p" contentKey="contact.description" isAdminAuthenticated={isAdminAuthenticated} className="text-xl text-center text-gray-300 max-w-xl mx-auto mb-10 animate-fade-in-up" />
                        <div className="bg-gray-800 p-8 rounded-2xl shadow-xl border border-gray-700 animate-fade-in-up space-y-8">
                            <div className="flex flex-col items-center text-center">
                                <MapPinIcon className="text-pink-500 w-12 h-12 mb-4" />
                                <EditableText tag="h3" contentKey="contact.addressTitle" isAdminAuthenticated={isAdminAuthenticated} className="text-xl sm:text-2xl font-semibold mb-2 text-white" />
                                <a href={googleMapsLink} target="_blank" rel="noopener noreferrer" className="text-blue-400 hover:underline text-lg transition duration-300">
                                    <EditableText tag="span" contentKey="contact.address" isAdminAuthenticated={isAdminAuthenticated} className="text-blue-400 hover:underline text-lg leading-relaxed whitespace-pre-line" />
                                </a>
                            </div>
                            <div className="flex flex-col items-center text-center">
                                <MailIcon className="text-pink-500 w-12 h-12 mb-4" />
                                <EditableText tag="h3" contentKey="contact.emailTitle" isAdminAuthenticated={isAdminAuthenticated} className="text-xl sm:text-2xl font-semibold mb-2 text-white" />
                                <a href={`mailto:${content.contact.email}`} className="text-blue-400 hover:underline text-lg transition duration-300"><EditableText tag="span" contentKey="contact.email" isAdminAuthenticated={isAdminAuthenticated} className="text-blue-400 hover:underline text-lg" /></a>
                            </div>
                            <div className="flex flex-col items-center text-center">
                                <PhoneIcon className="text-pink-500 w-12 h-12 mb-4" />
                                <EditableText tag="h3" contentKey="contact.phoneTitle" isAdminAuthenticated={isAdminAuthenticated} className="text-xl sm:text-2xl font-semibold mb-2 text-white" />
                                <a href={`tel:${content.contact.phoneNumber.replace(/\./g, '')}`} className="text-blue-400 hover:underline text-lg transition duration-300"><EditableText tag="span" contentKey="contact.phoneNumber" isAdminAuthenticated={isAdminAuthenticated} className="text-blue-400 hover:underline text-lg" /></a>
                            </div>
                            <div className="flex flex-col items-center text-center">
                                <InstagramIcon className="text-pink-500 w-12 h-12 mb-4" />
                                <EditableText tag="h3" contentKey="contact.instagramTitle" isAdminAuthenticated={isAdminAuthenticated} className="text-xl sm:text-2xl font-semibold mb-2 text-white" />
                                <a href={`https://www.instagram.com/${content.contact.instagramHandle.replace('@', '')}`} target="_blank" rel="noopener noreferrer" className="text-blue-400 hover:underline text-lg transition duration-300"><EditableText tag="span" contentKey="contact.instagramHandle" isAdminAuthenticated={isAdminAuthenticated} className="text-blue-400 hover:underline text-lg" /></a>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        const LegalMentionsPage = ({ isAdminAuthenticated }) => {
            return (
                <div className="min-h-screen bg-gradient-to-br from-blue-950 to-emerald-950 text-white pt-40 pb-12 font-inter">
                    <div className="container mx-auto px-6 max-w-4xl">
                        <EditableText tag="h1" contentKey="legalMentions.mainTitle" isAdminAuthenticated={isAdminAuthenticated} className="text-4xl sm:text-5xl font-extrabold text-center mb-12 text-teal-400 animate-fade-in-down animate-vibrate" />
                        <div className="bg-gray-800 p-8 rounded-2xl shadow-xl border border-gray-700 animate-fade-in-up space-y-6">
                            <EditableText tag="h2" contentKey="legalMentions.sectionTitle" isAdminAuthenticated={isAdminAuthenticated} className="text-2xl sm:text-3xl font-bold mb-4 text-white" />
                            <EditableText tag="p" contentKey="legalMentions.paragraph1" isAdminAuthenticated={isAdminAuthenticated} className="text-lg text-gray-300 leading-relaxed" />
                            <EditableText tag="p" contentKey="legalMentions.paragraph2" isAdminAuthenticated={isAdminAuthenticated} className="text-lg text-gray-300 leading-relaxed" />
                            <ul className="list-disc list-inside text-lg text-gray-300 pl-4 space-y-2">
                                <li><EditableText tag="span" contentKey="legalMentions.list1Item1" isAdminAuthenticated={isAdminAuthenticated} className="text-lg text-gray-300" /></li>
                                <li><EditableText tag="span" contentKey="legalMentions.list1Item2" isAdminAuthenticated={isAdminAuthenticated} className="text-lg text-gray-300" /></li>
                                <li><EditableText tag="span" contentKey="legalMentions.list1Item3" isAdminAuthenticated={isAdminAuthenticated} className="text-lg text-gray-300" /></li>
                            </ul>
                            <EditableText tag="p" contentKey="legalMentions.paragraph3" isAdminAuthenticated={isAdminAuthenticated} className="text-lg text-gray-300 leading-relaxed" />
                            <ul className="list-disc list-inside text-lg text-gray-300 pl-4 space-y-2">
                                <li><EditableText tag="span" contentKey="legalMentions.list2Item1" isAdminAuthenticated={isAdminAuthenticated} className="text-lg text-gray-300" /></li>
                                <li><EditableText tag="span" contentKey="legalMentions.list2Item2" isAdminAuthenticated={isAdminAuthenticated} className="text-lg text-gray-300" /></li>
                                <li><EditableText tag="span" contentKey="legalMentions.list2Item3" isAdminAuthenticated={isAdminAuthenticated} className="text-lg text-gray-300" /></li>
                            </ul>
                            <EditableText tag="p" contentKey="legalMentions.paragraph4" isAdminAuthenticated={isAdminAuthenticated} className="text-lg text-gray-300 leading-relaxed" />
                        </div>
                    </div>
                </div>
            );
        };

        const PrivacyPolicyPage = ({ isAdminAuthenticated }) => {
            return (
                <div className="min-h-screen bg-gradient-to-br from-blue-950 to-emerald-950 text-white pt-40 pb-12 font-inter">
                    <div className="container mx-auto px-6 max-w-4xl">
                        <EditableText tag="h1" contentKey="privacyPolicy.mainTitle" isAdminAuthenticated={isAdminAuthenticated} className="text-4xl sm:text-5xl font-extrabold text-center mb-12 text-purple-400 animate-fade-in-down animate-vibrate" />
                        <div className="bg-gray-800 p-8 rounded-2xl shadow-xl border border-gray-700 animate-fade-in-up space-y-6">
                            <EditableText tag="h2" contentKey="privacyPolicy.introTitle" isAdminAuthenticated={isAdminAuthenticated} className="text-2xl sm:text-3xl font-bold mb-4 text-white" />
                            <EditableText tag="p" contentKey="privacyPolicy.introText" isAdminAuthenticated={isAdminAuthenticated} className="text-lg text-gray-300 leading-relaxed" />
                            <EditableText tag="h2" contentKey="privacyPolicy.collectionTitle" isAdminAuthenticated={isAdminAuthenticated} className="text-2xl sm:text-3xl font-bold mb-4 text-white" />
                            <EditableText tag="p" contentKey="privacyPolicy.collectionText" isAdminAuthenticated={isAdminAuthenticated} className="text-lg text-gray-300 leading-relaxed" />
                            <EditableText tag="h2" contentKey="privacyPolicy.usageTitle" isAdminAuthenticated={isAdminAuthenticated} className="text-2xl sm:text-3xl font-bold mb-4 text-white" />
                            <ul className="list-disc list-inside text-lg text-gray-300 pl-4 space-y-2">
                                <li><EditableText tag="span" contentKey="privacyPolicy.usageListItem1" isAdminAuthenticated={isAdminAuthenticated} className="text-lg text-gray-300" /></li>
                                <li><EditableText tag="span" contentKey="privacyPolicy.usageListItem2" isAdminAuthenticated={isAdminAuthenticated} className="text-lg text-gray-300" /></li>
                                <li><EditableText tag="span" contentKey="privacyPolicy.usageListItem3" isAdminAuthenticated={isAdminAuthenticated} className="text-lg text-gray-300" /></li>
                            </ul>
                            <EditableText tag="h2" contentKey="privacyPolicy.protectionTitle" isAdminAuthenticated={isAdminAuthenticated} className="text-2xl sm:text-3xl font-bold mb-4 text-white" />
                            <EditableText tag="p" contentKey="privacyPolicy.protectionText" isAdminAuthenticated={isAdminAuthenticated} className="text-lg text-gray-300 leading-relaxed" />
                            <EditableText tag="h2" contentKey="privacyPolicy.rightsTitle" isAdminAuthenticated={isAdminAuthenticated} className="text-2xl sm:text-3xl font-bold mb-4 text-white" />
                            <EditableText tag="p" contentKey="privacyPolicy.rightsText" isAdminAuthenticated={isAdminAuthenticated} className="text-lg text-gray-300 leading-relaxed" />
                            <EditableText tag="p" contentKey="privacyPolicy.disclaimerText" isAdminAuthenticated={isAdminAuthenticated} className="text-lg text-gray-300 leading-relaxed" />
                        </div>
                    </div>
                </div>
            );
        };

        const ShowcaseCarPage = ({ isAdminAuthenticated }) => {
            const { content } = useContext(ContentContext);
            const images = [`Photo1.png`,`photo2.png`,`photo3.png`,`photo4.png`,`photo5.png`,`photo6.png`,`photo7.png`,`photo8.png`,`photo9.png`,`photo10.png`];
            const [currentImageIndex, setCurrentImageIndex] = useState(0);
            const [isPlaying, setIsPlaying] = useState(true);
            const [isLightboxOpen, setIsLightboxOpen] = useState(false);
            const [lightboxImages, setLightboxImages] = useState([]);
            const [currentLightboxImageIndex, setCurrentLightboxImageIndex] = useState(0);
            const openLightbox = (imagesToDisplay, initialIndex) => { setLightboxImages(imagesToDisplay); setCurrentLightboxImageIndex(initialIndex); setIsLightboxOpen(true); };
            const closeLightbox = () => { setIsLightboxOpen(false); setLightboxImages([]); setCurrentLightboxImageIndex(0); };
            useEffect(() => {
                let interval;
                if (isPlaying) { interval = setInterval(() => setCurrentImageIndex((prev) => (prev + 1) % images.length), 3000); }
                return () => clearInterval(interval);
            }, [isPlaying, images.length]);
            return (
                <div className="min-h-screen bg-gradient-to-br from-blue-950 to-emerald-950 text-white pt-40 pb-12 font-inter">
                    <div className="container mx-auto px-6 max-w-5xl">
                        <EditableText tag="h1" contentKey="showcaseCar.mainTitle" isAdminAuthenticated={isAdminAuthenticated} className="text-4xl sm:text-5xl font-extrabold text-center mb-12 text-yellow-400 animate-fade-in-down animate-vibrate" />
                        <EditableText tag="p" contentKey="showcaseCar.description" isAdminAuthenticated={isAdminAuthenticated} className="text-xl text-center text-gray-300 max-w-3xl mx-auto mb-10 animate-fade-in-up" />
                        <div className="bg-gray-800 p-8 rounded-2xl shadow-xl border border-gray-700 animate-fade-in-up space-y-8">
                            <div className="relative w-full h-96 md:h-[500px] overflow-hidden rounded-lg shadow-2xl border-4 border-red-700 group flex items-center justify-center cursor-pointer" onClick={() => openLightbox(images, currentImageIndex)}>
                                <img src={images[currentImageIndex]} alt={`Showcase Car ${currentImageIndex}`} className="w-full h-full object-contain object-center animate-fade-in transition-opacity duration-700" onError={(e) => { e.target.onerror = null; e.target.src="https://placehold.co/800x500/FF0000/FFFFFF?text=Erreur+chargement"; }} />
                                <div className="absolute bottom-4 flex justify-center w-full space-x-2">
                                    {images.map((_, index) => (<button key={index} onClick={(e) => { e.stopPropagation(); setCurrentImageIndex(index); setIsPlaying(false); }} className={`w-3 h-3 rounded-full transition-colors duration-300 ${index === currentImageIndex ? 'bg-red-500' : 'bg-gray-400 hover:bg-gray-300'}`} />))}
                                </div>
                            </div>
                            <EditableText tag="h2" contentKey="showcaseCar.preparationTitle" isAdminAuthenticated={isAdminAuthenticated} className="text-2xl sm:text-3xl font-bold mb-4 text-white" />
                            <EditableText tag="p" contentKey="showcaseCar.preparationDescription" isAdminAuthenticated={isAdminAuthenticated} className="text-lg text-gray-300 leading-relaxed" />
                            <ul className="list-disc list-inside text-lg text-gray-300 pl-6 space-y-2">
                                <li><EditableText tag="span" contentKey="showcaseCar.piston" isAdminAuthenticated={isAdminAuthenticated} className="text-lg text-gray-300" /></li>
                                <li><EditableText tag="span" contentKey="showcaseCar.bielles" isAdminAuthenticated={isAdminAuthenticated} className="text-lg text-gray-300" /></li>
                                <li><EditableText tag="span" contentKey="showcaseCar.soupapes" isAdminAuthenticated={isAdminAuthenticated} className="text-lg text-gray-300" /></li>
                                <li><EditableText tag="span" contentKey="showcaseCar.adm" isAdminAuthenticated={isAdminAuthenticated} className="text-lg text-gray-300" /></li>
                                <li><EditableText tag="span" contentKey="showcaseCar.ressort" isAdminAuthenticated={isAdminAuthenticated} className="text-lg text-gray-300" /></li>
                                <li><EditableText tag="span" contentKey="showcaseCar.viserie" isAdminAuthenticated={isAdminAuthenticated} className="text-lg text-gray-300" /></li>
                                <li><EditableText tag="span" contentKey="showcaseCar.pompeHuile" isAdminAuthenticated={isAdminAuthenticated} className="text-lg text-gray-300" /></li>
                                <li><EditableText tag="span" contentKey="showcaseCar.turbo" isAdminAuthenticated={isAdminAuthenticated} className="text-lg text-gray-300" /></li>
                                <li><EditableText tag="span" contentKey="showcaseCar.wastegate" isAdminAuthenticated={isAdminAuthenticated} className="text-lg text-gray-300" /></li>
                                <li><EditableText tag="span" contentKey="showcaseCar.injecteurs" isAdminAuthenticated={isAdminAuthenticated} className="text-lg text-gray-300" /></li>
                                <li><EditableText tag="span" contentKey="showcaseCar.pipAdmission" isAdminAuthenticated={isAdminAuthenticated} className="text-lg text-gray-300" /></li>
                                <li><EditableText tag="span" contentKey="showcaseCar.wmi" isAdminAuthenticated={isAdminAuthenticated} className="text-lg text-gray-300" /></li>
                                <li><EditableText tag="span" contentKey="showcaseCar.embrayage" isAdminAuthenticated={isAdminAuthenticated} className="text-lg text-gray-300" /></li>
                            </ul>
                            <EditableText tag="p" contentKey="showcaseCar.finalDescription" isAdminAuthenticated={isAdminAuthenticated} className="text-lg text-gray-300 leading-relaxed" />
                        </div>
                    </div>
                    {isLightboxOpen && <Lightbox images={lightboxImages} currentIndex={currentLightboxImageIndex} onClose={closeLightbox} onNavigate={setCurrentLightboxImageIndex} />}
                </div>
            );
        };

        const AdminLoginPage = ({ setIsAdminAuthenticated, setCurrentPage }) => {
            const [password, setPassword] = useState('');
            const [error, setError] = useState('');
            const ADMIN_PASSWORD_FRONTEND = 'Remy03200!';
            const handleSubmit = (e) => { e.preventDefault(); if (password === ADMIN_PASSWORD_FRONTEND) { setIsAdminAuthenticated(true); localStorage.setItem('isAdminAuthenticated', 'true'); setCurrentPage('admin-panel'); } else { setError('Mot de passe incorrect.'); } };
            return (
                <div className="min-h-screen bg-gradient-to-br from-gray-900 to-black text-white pt-40 pb-12 font-inter flex items-center justify-center">
                    <div className="bg-gray-800 p-8 rounded-2xl shadow-xl border border-gray-700 w-full max-w-md animate-fade-in-up">
                        <h1 className="text-3xl sm:text-4xl font-extrabold text-center mb-4 text-orange-400">Acc√®s Administrateur</h1>
                        <p className="text-center text-sm text-gray-400 mb-6 italic">Giovanni te souhaite la bienvenue et un bon courage !</p>
                        <form onSubmit={handleSubmit} className="space-y-6">
                            <InputField label="Mot de passe" type="password" placeholder="Entrez votre mot de passe" required={true} value={password} onChange={(e) => { setPassword(e.target.value); setError(''); }} name="adminPassword" />
                            {error && <p className="text-red-500 text-sm text-center">{error}</p>}
                            <button type="submit" className="w-full bg-orange-600 hover:bg-orange-700 text-white font-bold py-3 px-4 rounded-lg shadow-md transition duration-300 ease-in-out transform hover:scale-105 active:scale-95">Se connecter</button>
                        </form>
                    </div>
                </div>
            );
        };

        const AdminBlogPostCard = ({ post, index, handleLocalChange, handleRemoveBlogPost, handleAddImageToPost, handleRemoveImageFromPost }) => {
            const [newImageUrl, setNewImageUrl] = useState('');
            return (
                <div className="p-5 bg-gray-600 rounded-lg shadow-md border border-gray-500 relative">
                    <h4 className="text-xl font-semibold mb-3 text-white">Article #{index + 1}</h4>
                    <button onClick={() => handleRemoveBlogPost(post.id)} className="absolute top-3 right-3 bg-red-500 hover:bg-red-600 text-white p-2 rounded-full text-sm"><XIcon className="w-4 h-4"/></button>
                    <div className="space-y-4">
                        <div><label className="block text-gray-300 text-sm font-bold mb-2">Titre:</label><input type="text" value={post.title || ''} onChange={(e) => handleLocalChange('blog', `posts.${index}.title`, e.target.value)} className="w-full p-2 rounded bg-gray-500 text-white border border-gray-400 focus:ring-green-500" /></div>
                        <div><label className="block text-gray-300 text-sm font-bold mb-2">Description:</label><textarea value={post.description || ''} onChange={(e) => handleLocalChange('blog', `posts.${index}.description`, e.target.value)} rows="3" className="w-full p-2 rounded bg-gray-500 text-white border border-gray-400 focus:ring-green-500" /></div>
                        <div className="mt-4 border-t border-gray-500 pt-4"><label className="block text-gray-300 text-sm font-bold mb-2">Images:</label><div className="flex space-x-2 mb-2"><input type="text" placeholder="Nom image" value={newImageUrl} onChange={(e) => setNewImageUrl(e.target.value)} className="flex-grow p-2 rounded bg-gray-500 text-white" /><button onClick={() => { if(newImageUrl.trim()){ handleAddImageToPost(index, newImageUrl.trim()); setNewImageUrl(''); }}} className="bg-blue-500 hover:bg-blue-600 text-white p-2 rounded-lg">Ajouter</button></div><ul className="space-y-2">{post.images && post.images.map((imgUrl, imgIdx) => (<li key={imgIdx} className="flex items-center justify-between bg-gray-700 p-2 rounded"><span className="text-gray-300 text-sm truncate mr-2">{imgUrl}</span><button onClick={() => handleRemoveImageFromPost(index, imgIdx)} className="bg-red-500 text-white p-1 rounded-full text-xs"><XIcon className="w-3 h-3"/></button></li>))}</ul></div>
                    </div>
                </div>
            );
        };

        const AdminPanelPage = ({ setIsAdminAuthenticated, setCurrentPage }) => {
            const { content, updateContent } = useContext(ContentContext);
            const [localContent, setLocalContent] = useState(() => JSON.parse(JSON.stringify(content || {})));
            const [saveMessage, setSaveMessage] = useState('');
            const [isSaving, setIsSaving] = useState(false);
            const [activeTab, setActiveTab] = useState('home');
            
            useEffect(() => { setLocalContent(JSON.parse(JSON.stringify(content || {}))); }, [content]);
            const handleLocalChange = (pageKey, fieldKey, newValue) => { setLocalContent(prev => { const n = JSON.parse(JSON.stringify(prev)); setNestedProperty(n[pageKey], fieldKey, newValue); return n; }); };
            const handleAddBlogPost = () => { setLocalContent(prev => { const n = JSON.parse(JSON.stringify(prev)); if(!n.blog.posts) n.blog.posts = []; n.blog.posts.push({ id: Date.now(), images: [], title: "Nouveau", description: "Desc" }); return n; }); };
            const handleRemoveBlogPost = (id) => { setLocalContent(prev => { const n = JSON.parse(JSON.stringify(prev)); n.blog.posts = n.blog.posts.filter(p => p.id !== id); return n; }); };
            const handleAddImageToPost = (idx, url) => { setLocalContent(prev => { const n = JSON.parse(JSON.stringify(prev)); if(!n.blog.posts[idx].images) n.blog.posts[idx].images = []; n.blog.posts[idx].images.push(url); return n; }); };
            const handleRemoveImageFromPost = (postIdx, imgIdx) => { setLocalContent(prev => { const n = JSON.parse(JSON.stringify(prev)); n.blog.posts[postIdx].images.splice(imgIdx, 1); return n; }); };
            const handleSaveChanges = async () => { setIsSaving(true); setSaveMessage('Sauvegarde...'); try { const res = await fetch('http://localhost:3001/api/save-content', { method: 'POST', headers: { 'Content-Type': 'application/json', 'Authorization': `Bearer Remy03200!` }, body: JSON.stringify(localContent) }); const d = await res.json(); if(res.ok) { setSaveMessage('Sauvegard√© !'); updateContent('home', localContent.home); updateContent('blog', localContent.blog); updateContent('aboutUs', localContent.aboutUs); updateContent('contact', localContent.contact); updateContent('legalMentions', localContent.legalMentions); updateContent('privacyPolicy', localContent.privacyPolicy); updateContent('showcaseCar', localContent.showcaseCar); updateContent('siteSettings', localContent.siteSettings); } else { setSaveMessage('Erreur'); } } catch(e) { setSaveMessage('Erreur r√©seau'); } finally { setIsSaving(false); setTimeout(() => setSaveMessage(''), 5000); } };
            const handleLogout = () => { setIsAdminAuthenticated(false); localStorage.removeItem('isAdminAuthenticated'); setCurrentPage('accueil'); };
            const renderFields = (data, pageKey) => { if(!data || typeof data !== 'object') return null; return Object.keys(data).map(k => { if(k==='posts'||k==='images') return null; if(typeof data[k]==='object') return <div key={k} className="pb-4"><h4 className="text-xl font-bold capitalize">{k}</h4>{renderFields(data[k], `${pageKey}.${k}`)}</div>; return (<div key={k} className="pb-4 border-b border-gray-600"><label className="block text-gray-300 font-bold mb-2">{k}:</label><textarea value={data[k]} onChange={(e)=>handleLocalChange(pageKey, k, e.target.value)} className="w-full bg-gray-600 text-white rounded p-2" /></div>); }); };
            const pageTabs = [{key:'home',label:'Accueil'},{key:'blog',label:'Blog'},{key:'aboutUs',label:'Qui sommes-nous'},{key:'contact',label:'Contact'},{key:'legalMentions',label:'Mentions'},{key:'privacyPolicy',label:'Confidentialit√©'},{key:'showcaseCar',label:'Vitrine'},{key:'siteSettings',label:'Param√®tres'}];

            return (
                <div className="min-h-screen bg-gradient-to-br from-gray-900 to-black text-white pt-40 pb-12 font-inter">
                    <div className="container mx-auto px-6 max-w-6xl">
                        <h1 className="text-4xl font-extrabold text-center mb-8 text-orange-400">Administration</h1>
                        <div className="bg-gray-800 p-8 rounded-2xl shadow-xl border border-gray-700">
                            <div className="flex flex-wrap gap-4 mb-8 border-b border-gray-700 pb-4 justify-center">{pageTabs.map(t => <button key={t.key} onClick={() => setActiveTab(t.key)} className={`px-4 py-2 rounded ${activeTab === t.key ? 'bg-blue-600' : 'bg-gray-700'}`}>{t.label}</button>)}</div>
                            {localContent && (
                                <div>
                                    {activeTab === 'blog' ? (
                                        <div>
                                            {renderFields(localContent.blog, 'blog')}
                                            <button onClick={handleAddBlogPost} className="bg-green-500 text-white px-4 py-2 rounded mt-4">Ajouter Article</button>
                                            <div className="space-y-4 mt-4">{localContent.blog.posts.map((p, i) => <AdminBlogPostCard key={p.id} post={p} index={i} handleLocalChange={handleLocalChange} handleRemoveBlogPost={handleRemoveBlogPost} handleAddImageToPost={handleAddImageToPost} handleRemoveImageFromPost={handleRemoveImageFromPost} />)}</div>
                                        </div>
                                    ) : (
                                        renderFields(localContent[activeTab], activeTab)
                                    )}
                                </div>
                            )}
                            <div className="flex justify-center space-x-4 mt-8"><button onClick={handleSaveChanges} disabled={isSaving} className="bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-6 rounded-lg">{isSaving ? '...' : 'Sauvegarder'}</button><button onClick={handleLogout} className="bg-red-600 hover:bg-red-700 text-white font-bold py-3 px-6 rounded-lg">D√©connexion</button></div>
                            {saveMessage && <p className="text-center text-yellow-400 mt-4">{saveMessage}</p>}
                        </div>
                    </div>
                </div>
            );
        };

        const MusicControl = ({ volume }) => {
            const audioRef = useRef(null);
            const [isPlaying, setIsPlaying] = useState(false);
            const [showMsg, setShowMsg] = useState(false);
            useEffect(() => { const a = document.getElementById('background-music'); if(a){ audioRef.current=a; a.volume=volume; a.play().then(()=>setIsPlaying(true)).catch(()=>{setIsPlaying(false); setShowMsg(true); setTimeout(()=>setShowMsg(false),5000);}); a.addEventListener('pause',()=>setIsPlaying(false)); a.addEventListener('play',()=>setIsPlaying(true)); } }, []);
            useEffect(() => { if(audioRef.current) audioRef.current.volume=volume; }, [volume]);
            const toggle = () => { if(audioRef.current){ if(isPlaying) audioRef.current.pause(); else audioRef.current.play().then(()=>setShowMsg(false)).catch(console.error); } };
            return ( <> <button onClick={toggle} className="fixed bottom-8 right-8 bg-red-600 text-white p-4 rounded-full shadow-lg z-50 flex items-center justify-center w-14 h-14">{isPlaying ? <PauseIcon /> : <PlayIcon />}</button> {showMsg && <div className="fixed bottom-24 right-8 bg-yellow-500 text-gray-900 px-4 py-2 rounded-lg z-50">Cliquez pour la musique !</div>} </> );
        };

        const ScrollToTopButton = () => {
            const [v, setV] = useState(false);
            useEffect(() => { const h = () => setV(window.pageYOffset > 300); window.addEventListener('scroll', h); return () => window.removeEventListener('scroll', h); }, []);
            return <button onClick={() => window.scrollTo({top:0,behavior:'smooth'})} className={`fixed bottom-24 right-8 bg-blue-600 text-white p-4 rounded-full shadow-lg z-50 flex items-center justify-center w-14 h-14 ${v?'':'hidden'}`}><ArrowUpIcon /></button>;
        };

        const App = () => {
            const [isAdminAuthenticated, setIsAdminAuthenticated] = useState(localStorage.getItem('isAdminAuthenticated') === 'true');
            const [currentPage, setCurrentPage] = useState('accueil');
            const [content, setContent] = useState(null);
            const [loading, setLoading] = useState(true);
            const [isNavbarVisible, setIsNavbarVisible] = useState(true);
            const lastScrollY = useRef(0);

            useEffect(() => {
                const fetchContent = async () => {
                    try {
                        const res = await fetch('content.json');
                        if (!res.ok) throw new Error();
                        setContent(await res.json());
                    } catch (e) {
                        /* --- CONTENU PAR D√âFAUT AVEC OPTIMISATION SEO VICHY --- */
                        setContent({
                            home: {
                                mainTitle: "Lib√©rez la <span class=\"text-red-500\">Puissance</span>. Red√©finissez la <span class=\"text-blue-500\">Performance</span> √† Vichy !",
                                description: "Sp√©cialiste de la reprogrammation moteur √† Vichy (03) et Saint-Germain-des-Foss√©s. Stage 1, E85 et optimisation sur mesure.",
                                contactMessage: "Contactez votre expert √† Vichy d√®s aujourd'hui !",
                                offerTitle: "Nos Offres",
                                offer1Title: "Reprogrammation Moteur", offer1Description: "Optimisation performances (Stage 1) et consommation.",
                                offer2Title: "Diagnostic √âlectronique", offer2Description: "Identification pr√©cise des pannes moteur.",
                                offer3Title: "Pr√©paration V√©hicule", offer3Description: "Solutions compl√®tes route et piste.",
                                offer4Title: "Conseil Personnalis√©", offer4Description: "Accompagnement expert dans l'Allier.",
                                trustTitle: "Pourquoi nous faire confiance ?",
                                trust1Title: "Rapidit√© d'Intervention", trust1Description: "D√©lais optimis√©s.",
                                trust2Title: "Transparence", trust2Description: "Communication claire.",
                                trust3Title: "Qualit√© Garantie", trust3Description: "R√©sultats mesurables.",
                                trust4Title: "Satisfaction Client", trust4Description: "Votre plaisir est notre priorit√©.",
                                teamTitle: "Notre √âquipe", teamDescription: "Passionn√©s de m√©canique bas√©s pr√®s de Vichy."
                            },
                            blog: { mainTitle: "Blog BRMOTORSPORT Vichy", description: "Nos derni√®res r√©alisations dans l'Allier.", posts: [] },
                            aboutUs: { 
                                mainTitle: "Qui sommes-nous ?", 
                                description: "BRMOTORSPORT, votre expert en optimisation moteur situ√© √† Saint-Germain-des-Foss√©s, √† 10 min de Vichy.", 
                                historyTitle: "Notre Histoire", 
                                historyParagraph1: "Passionn√©s d'automobile dans l'Allier.", 
                                historyParagraph2: "Expertise locale reconnue.", 
                                valuesTitle: "Nos Valeurs", 
                                value1Title: "Expertise", value1Description: "Savoir-faire technique.", 
                                value2Title: "Innovation", value2Description: "Derni√®res technologies.", 
                                value3Title: "Qualit√©", value3Description: "Fiabilit√© maximale.", 
                                value4Title: "Service", value4Description: "Proximit√© client." 
                            },
                            contact: { 
                                mainTitle: "Contactez-nous", 
                                description: "RDV √† l'atelier pr√®s de Vichy.", 
                                addressTitle: "Adresse", 
                                address: "Zone industrielle le coquet\n03260 Saint-Germain-des-Foss√©s\n(10 min de Vichy)", 
                                emailTitle: "Email", email: "contact@brmotorsport.com", 
                                phoneTitle: "T√©l√©phone", phoneNumber: "06.68.27.88.01", 
                                instagramTitle: "Instagram", instagramHandle: "@brmotorsport_official" 
                            },
                            legalMentions: { mainTitle: "Mentions L√©gales", sectionTitle: "Infos", paragraph1: "√âdit√© par BRMOTORSPORT." },
                            privacyPolicy: { mainTitle: "Confidentialit√©", introTitle: "Intro", introText: "Protection de vos donn√©es." },
                            showcaseCar: { mainTitle: "Voiture Vitrine", description: "Notre Scirocco R de d√©monstration.", preparationTitle: "Stage 3", preparationDescription: "500+ ch." },
                            siteSettings: { musicVolume: 0.05 }
                        });
                    } finally { setLoading(false); }
                };
                fetchContent();
                const handleScroll = () => {
                    const currentScrollY = window.scrollY;
                    if (currentScrollY === 0) setIsNavbarVisible(true);
                    else if (currentScrollY < lastScrollY.current) setIsNavbarVisible(true);
                    else if (currentScrollY > lastScrollY.current && currentScrollY > 200) setIsNavbarVisible(false);
                    lastScrollY.current = currentScrollY;
                };
                window.addEventListener('scroll', handleScroll);
                return () => window.removeEventListener('scroll', handleScroll);
            }, []);

            useEffect(() => window.scrollTo(0, 0), [currentPage]);

            if (loading) return <div className="min-h-screen flex items-center justify-center bg-gray-900 text-white">Chargement...</div>;

            return (
                <ContentContext.Provider value={{ content, updateContent }}>
                    <div className="min-h-screen bg-black font-inter overflow-x-hidden">
                        <ScrollingBanner />
                        <Navbar setCurrentPage={setCurrentPage} isAdminAuthenticated={isAdminAuthenticated} handleLogout={handleLogout} isVisible={isNavbarVisible} />
                        <main className={`flex-grow ${isNavbarVisible ? 'pt-[96px]' : 'pt-[40px]'}`}>
                            {currentPage === 'accueil' && <HomePage setCurrentPage={setCurrentPage} isAdminAuthenticated={isAdminAuthenticated} />}
                            {currentPage === 'blog' && <BlogPage isAdminAuthenticated={isAdminAuthenticated} />}
                            {currentPage === 'qui-sommes-nous' && <AboutUsPage isAdminAuthenticated={isAdminAuthenticated} />}
                            {currentPage === 'contact' && <ContactPage isAdminAuthenticated={isAdminAuthenticated} />}
                            {currentPage === 'mentions-legales' && <LegalMentionsPage isAdminAuthenticated={isAdminAuthenticated} />}
                            {currentPage === 'confidentialite' && <PrivacyPolicyPage isAdminAuthenticated={isAdminAuthenticated} />}
                            {currentPage === 'voiture-vitrine' && <ShowcaseCarPage isAdminAuthenticated={isAdminAuthenticated} />}
                            {currentPage === 'admin-login' && <AdminLoginPage setIsAdminAuthenticated={setIsAdminAuthenticated} setCurrentPage={setCurrentPage} />}
                            {currentPage === 'admin-panel' && (isAdminAuthenticated ? <AdminPanelPage setIsAdminAuthenticated={setIsAdminAuthenticated} setCurrentPage={setCurrentPage} /> : null)}
                        </main>
                        <MusicControl volume={content?.siteSettings?.musicVolume || 0.05} />
                        <ScrollToTopButton />
                        <FloatingPhoneButton />
                        <footer className="bg-gray-900 bg-opacity-90 backdrop-blur-sm text-gray-400 py-6 text-center shadow-inner rounded-t-lg">
                            <div className="container mx-auto px-4">
                                <p>¬© {new Date().getFullYear()} BRMOTORSPORT (Vichy - 03). Tous droits r√©serv√©s.</p>
                                <div className="flex justify-center space-x-4 mt-3">
                                    <a href="#" onClick={(e) => { e.preventDefault(); setCurrentPage('confidentialite'); }} className="hover:text-red-500">Confidentialit√©</a>
                                    <span>|</span>
                                    <a href="#" onClick={(e) => { e.preventDefault(); setCurrentPage('mentions-legales'); }} className="hover:text-red-500">Mentions L√©gales</a>
                                    <span>|</span>
                                    {isAdminAuthenticated ? <a href="#" onClick={(e) => { e.preventDefault(); handleLogout(); }} className="hover:text-red-500">D√©connexion</a> : <a href="#" onClick={(e) => { e.preventDefault(); setCurrentPage('admin-login'); }} className="hover:text-red-500">Admin</a>}
                                </div>
                                <p className="text-sm mt-2">R√©alis√© par Viremot Giovanni</p>
                            </div>
                        </footer>
                    </div>
                </ContentContext.Provider>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
