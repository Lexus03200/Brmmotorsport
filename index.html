<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BRMOTORSPORT - Performance Automobile</title>
    <!-- Intégration de Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Intégration de React et ReactDOM CDN -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <!-- Intégration de Babel pour transpiler le JSX directement dans le navigateur -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <style>
        /* Importation des polices Inter et Montserrat */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&family=Montserrat:wght@700;800;900&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            margin: 0;
            padding: 0;
            /* overflow-x: hidden; /* Déplacé vers #root pour une meilleure portée avec React */
        }
        h1, h2, h3 {
            font-family: 'Montserrat', sans-serif; /* Nouvelle police pour les titres */
        }
        /* Keyframes pour les animations */
        @keyframes fadeInDown {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        @keyframes bounceIn {
            0%, 20%, 40%, 60%, 80%, 100% {
                transition-timing-function: cubic-bezier(0.215, 0.610, 0.355, 1.000);
            }
            0% { opacity: 0; transform: scale3d(.3, .3, .3); }
            20% { transform: scale3d(1.1, 1.1, 1.1); }
            40% { transform: scale3d(.9, .9, .9); }
            60% { opacity: 1; transform: scale3d(1.03, 1.03, 1.03); }
            80% { transform: scale3d(.97, .97, .97); }
            100% { opacity: 1; transform: scale3d(1, 1, 1); }
        }
        @keyframes blob {
            0% { transform: translate(0px, 0px) scale(1); }
            33% { transform: translate(30px, -50px) scale(1.1); }
            66% { transform: translate(-20px, 20px) scale(0.9); }
            100% { transform: translate(0px, 0px) scale(1); }
        }
        /* Nouvelle animation pour le défilement de la bannière */
        @keyframes scrollText {
            0% { transform: translateX(0%); }
            100% { transform: translateX(-100%); }
        }
        /* Nouvelle animation pour le titre - Coulissement depuis la gauche */
        @keyframes slideInFromLeft {
            from {
                transform: translateX(-100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
        /* Nouvelle animation pour l'effet de vibration (plus douce) */
        @keyframes vibrate {
            0% { transform: translate(0px, 0px); }
            25% { transform: translate(-0.5px, 0.5px); } /* Mouvement réduit */
            50% { transform: translate(0.5px, -0.5px); }
            75% { transform: translate(-0.5px, -0.5px); }
            100% { transform: translate(0px, 0px); }
        }

        .animate-fade-in-down { animation: fadeInDown 0.8s ease-out forwards; }
        .animate-fade-in-up { animation: fadeInUp 0.8s ease-out forwards; }
        .animate-fade-in { animation: fadeIn 0.8s ease-out forwards; }
        .animate-bounce-in { animation: bounceIn 1s; }
        .animate-blob { animation: blob 7s infinite; }
        .animate-vibrate { animation: vibrate 0.15s ease-in-out infinite; } /* Vitesse ajustée à 0.15s */
        .animation-delay-2000 { animation-delay: 2s; }
        .animation-delay-4000 { animation-delay: 4s; }
        /* Style pour l'animation de défilement */
        .scrolling-banner-text {
            display: inline-block;
            white-space: nowrap;
            animation: scrollText 30s linear infinite; /* 30s pour la durée, linear pour un mouvement fluide, infinite pour la répétition */
        }
        /* Pour assurer que le texte déborde et puisse défiler */
        .scrolling-banner-container {
            overflow: hidden;
        }
        /* Application de l'animation de coulissement pour le titre */
        .animate-slide-in-left {
            animation: slideInFromLeft 1s ease-out forwards; /* Durée et type d'animation */
        }

        /* Styles supplémentaires pour des effets visuels */
        h1, h2 {
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5); /* Ombre subtile pour la profondeur */
        }
        /* Utilitaire pour décalage d'animation */
        .delay-animation {
            animation-delay: var(--delay-factor);
        }

        /* Styles spécifiques pour la Lightbox (modale) */
        .lightbox-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 100;
            animation: fadeIn 0.3s ease-out forwards;
        }

        .lightbox-content {
            position: relative;
            max-width: 90%;
            max-height: 90%;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .lightbox-image {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
            border-radius: 0.75rem;
        }

        .lightbox-button {
            background-color: rgba(0, 0, 0, 0.5);
            color: white;
            padding: 0.75rem;
            border-radius: 9999px; /* fully rounded */
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background-color 0.2s ease-in-out;
            cursor: pointer;
            position: absolute;
            z-index: 101;
        }

        .lightbox-button:hover {
            background-color: rgba(0, 0, 0, 0.8);
        }

        .lightbox-close-button {
            top: 1rem;
            right: 1rem;
        }

        .lightbox-prev-button {
            left: 1rem;
            top: 50%;
            transform: translateY(-50%);
        }

        .lightbox-next-button {
            right: 1rem;
            top: 50%;
            transform: translateY(-50%);
        }

        /* Styles pour le bouton de retour en haut */
        .scroll-to-top {
            animation: fadeIn 0.5s ease-out forwards;
        }
        .scroll-to-top.hidden {
            animation: fadeOut 0.5s ease-out forwards;
            opacity: 0;
            pointer-events: none;
        }
        @keyframes fadeOut {
            from { opacity: 1; }
            to { opacity: 0; }
        }

        /* Styles pour la navbar dynamique */
        .navbar-hidden {
            transform: translateY(-100%);
        }
        .navbar-visible {
            transform: translateY(0);
        }
        .navbar-transition {
            transition: transform 0.3s ease-in-out;
        }
    </style>
</head>
<body class="min-h-screen bg-black font-inter">
    <!-- Section Audio de fond -->
    <!-- 'autoplay' tente de lancer la lecture automatique, mais peut être bloqué par les navigateurs mobiles. -->
    <!-- 'loop' assure que la musique se répète. -->
    <!-- 'style="display:none;"' masque les contrôles de lecture par défaut. -->
    <!-- Ajout de l'attribut volume pour réduire le son (valeur de 0.0 à 1.0) -->
    <audio id="background-music" autoplay loop volume="0.01" style="display:none;">
        <!-- L'URL est construite en utilisant votre domaine GitHub Pages et le nom de votre fichier MP3. -->
        <source src="musique.mp3" type="audio/mpeg"> <!-- Chemin mis à jour pour être relatif au dossier racine -->
        Votre navigateur ne supporte pas l'élément audio.
    </audio>

    <div id="root" class="overflow-x-hidden"></div>

    <!-- Le type du script a été changé en "text/babel" pour le transpiler -->
    <script type="text/babel">
        // Récupère les hooks React depuis l'objet global React
        const { useState, useEffect, useRef, createContext, useContext } = React;

        // --- Icônes Lucide React ---
        // Composant d'icône de voiture
        const CarIcon = () => (
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="lucide lucide-car">
            <path d="M19 17H5c-1.1 0-2 .9-2 2v2h18v-2c0-1.1-.9-2-2-2Z"/><path d="M7 17V5h12v12"/><path d="M18 10h-8"/><path d="M10 10v7"/>
          </svg>
        );

        // Composant d'icône de poignée de main
        const HandshakeIcon = () => (
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="lucide lucude-handshake">
            <path d="M12.23 20.73a4.7 4.7 0 0 0 6.64-6.64L12.23 7.07l-2.06 2.06"/><path d="M16 16l-3.23 3.23a4.7 4.7 0 0 1-6.64-6.64L9.07 7.07l2.06 2.06"/><path d="M14 10l-2.06 2.06"/><path d="m10 14 2.06-2.06"/>
          </svg>
        );

        // Composant d'icône de clé à molette
        const WrenchIcon = () => (
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="lucide lucide-wrench">
            <path d="M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-3.77 3.77a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-3.77 3.77a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 [Circular Object]"/>
            <path d="M5.5 12.5l-3-3L12.5 2.5l3 3z"/>
          </svg>
        );

        // Composant d'icône de calendrier
        const CalendarIcon = () => (
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="lucide lucide-calendar-days">
            <path d="M8 2v4"/><path d="M16 2v4"/><rect width="18" height="18" x="3" y="4" rx="2"/><path d="M3 10h18"/><path d="M8 14h.01"/><path d="M12 14h.01"/><path d="M16 14h.01"/><path d="M8 18h.01"/><path d="M12 18h.01"/><path d="M16 18h.01"/>
          </svg>
        );

        // Composant d'icône d'utilisateurs
        const UsersIcon = () => (
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="lucide lucide-users">
            <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M22 21v-2a4 4 0 0 0-3-3.87L16 16"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/>
          </svg>
        );

        // Composant d'icône RSS
        const RssIcon = () => (
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="lucide lucide-rss">
            <path d="M4 11a9 9 0 0 1 9 9"/><path d="M4 4a16 16 0 0 1 16 16"/><circle cx="5" cy="19" r="1"/>
          </svg>
        );

        // Composant d'icône de téléphone
        const PhoneIcon = () => (
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="lucide lucide-phone">
            <path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-3.07-8.63A2 2 0 0 1 4.11 2H7c.43 0 .79.27.94.66.14.39.07.82-.2 1.1L5.05 6.05c-.35.35-.5.85-.34 1.34A19.79 19.79 0 0 0 16.92 19c.49.16.99.01 1.34-.34l2.29-2.29c.28-.27.71-.34 1.1-.2.39.14.66.5.66.94Z"/>
          </svg>
        );

        // Composant d'icône de mail
        const MailIcon = () => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="lucide lucide-mail">
              <rect width="20" height="16" x="2" y="4" rx="2"/><path d="m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7"/>
            </svg>
        );

        // Composant d'icône Instagram
        const InstagramIcon = () => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="lucide lucide-instagram">
              <rect width="20" height="20" x="2" y="2" rx="5" ry="5"/><path d="M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z"/><line x1="17.5" x2="17.5" y1="6.5" y2="6.5"/>
            </svg>
        );

        // Composant d'icône Play
        const PlayIcon = () => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="lucide lucide-play">
                <polygon points="5 3 19 12 5 21 5 3"/>
            </svg>
        );

        // Composant d'icône Pause
        const PauseIcon = () => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="lucide lucide-pause">
                <rect x="6" y="4" width="4" height="16" rx="1"/><rect x="14" y="4" width="4" height="16" rx="1"/>
            </svg>
        );

        // Composant d'icône Étoile
        const StarIcon = () => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="lucide lucide-star">
                <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/>
            </svg>
        );

        // Composant d'icône Flèche Gauche
        const ArrowLeftIcon = () => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="lucide lucide-arrow-left">
                <path d="m12 19-7-7 7-7"/><path d="M19 12H5"/>
            </svg>
        );

        // Composant d'icône Flèche Droite
        const ArrowRightIcon = () => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="lucide lucide-arrow-right">
                <path d="M5 12h14"/><path d="m12 5 7 7-7 7"/>
            </svg>
        );

        // Composant d'icône X (fermer)
        const XIcon = () => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="lucide lucide-x">
                <path d="M18 6 6 18"/><path d="m6 6 12 12"/>
            </svg>
        );

        // Composant d'icône Plus (Zoom In)
        const PlusIcon = () => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="lucide lucide-plus">
                <path d="M12 5v14"/><path d="M5 12h14"/>
            </svg>
        );

        // Composant d'icône Moins (Zoom Out)
        const MinusIcon = () => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="lucide lucide-minus">
                <path d="M5 12h14"/>
            </svg>
        );

        // Composant d'icône de cible (Centrer)
        const TargetIcon = () => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="lucide lucide-target">
                <circle cx="12" cy="12" r="10"/><circle cx="12" cy="12" r="6"/><circle cx="12" cy="12" r="2"/>
            </svg>
        );

        // Composant d'icône de rotation (Réinitialiser)
        const RotateCcwIcon = () => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="lucide lucide-rotate-ccw">
                <path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.79 2.91L3 12H3z"/><path d="M3 3v.01"/>
            </svg>
        );

        // Composant d'icône Flèche vers le haut
        const ArrowUpIcon = () => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="lucide lucide-arrow-up">
                <path d="M12 19V5"/><path d="m5 12 7-7 7 7"/>
            </svg>
        );


        // --- Contexte pour la gestion du contenu éditable ---
        const ContentContext = createContext();

        // Fonction utilitaire pour définir une propriété imbriquée par un chemin (similaire à lodash.set)
        const setNestedProperty = (obj, path, value) => {
            const pathParts = path.split('.');
            let current = obj;
            for (let i = 0; i < pathParts.length; i++) {
                const part = pathParts[i];
                const isLastPart = (i === pathParts.length - 1);
                // Vérifie si la partie est un index numérique (pour les tableaux)
                const isArrayIndex = !isNaN(parseInt(part)) && String(parseInt(part)) === part;

                if (isLastPart) {
                    // C'est la dernière partie du chemin, définissez la valeur
                    current[isArrayIndex ? parseInt(part) : part] = value;
                    // console.log(`setNestedProperty: SETTING final value for path part "${part}" to:`, value);
                } else {
                    // Si ce n'est pas la dernière partie, naviguez plus profondément
                    if (isArrayIndex) {
                        if (!Array.isArray(current)) {
                            console.warn(`setNestedProperty: Attempted to navigate array index ${part} on non-array:`, current);
                            return obj; // Retourne l'objet original pour éviter de le corrompre
                        }
                        if (current[parseInt(part)] === undefined || current[parseInt(part)] === null) {
                            current[parseInt(part)] = {}; // Assurez-vous que l'objet à cet index existe
                            // console.log(`setNestedProperty: Created new object at array index ${part}.`);
                        }
                        current = current[parseInt(part)];
                    } else {
                        if (typeof current[part] !== 'object' || current[part] === null) {
                            current[part] = {}; // Initialise comme objet si ce n'est pas déjà le cas
                            // console.log(`setNestedProperty: Created new object for path part "${part}".`);
                        }
                        current = current[part];
                    }
                    // console.log(`setNestedProperty: Navigated to "${part}". Current nested object:`, current);
                }
            }
            return obj; // Retourne l'objet modifié
        };

        // Composant pour l'édition de texte in-situ (utilisé hors du panneau admin pour l'affichage direct)
        const EditableText = ({ tag: Tag, contentKey, isAdminAuthenticated, className }) => {
            const { content, updateContent } = useContext(ContentContext);
            const path = contentKey.split('.'); // Ex: "home.mainTitle" -> ["home", "mainTitle"]

            // Fonction récursive pour accéder à la valeur imbriquée
            const getValue = (obj, p) => {
                let current = obj;
                for (let i = 0; i < p.length; i++) {
                    const part = p[i];
                    const isArrayIndex = !isNaN(parseInt(part)) && String(parseInt(part)) === part;

                    if (isArrayIndex) {
                        if (Array.isArray(current) && current[parseInt(part)] !== undefined) {
                            current = current[parseInt(part)];
                        } else {
                            return `[Contenu manquant ou invalide: ${contentKey}]`;
                        }
                    } else {
                        if (current && typeof current === 'object' && current.hasOwnProperty(part)) {
                            current = current[part];
                        } else {
                            return `[Contenu manquant: ${contentKey}]`;
                        }
                    }
                }
                return current;
            };

            const textValue = content ? getValue(content, contentKey.split('.')) : `Chargement...`;


            // Gérer le changement du texte (seulement si isAdminAuthenticated)
            const handleChange = (e) => {
                const newValue = e.target.value;
                updateContent(contentKey, newValue); // Appelle la fonction de mise à jour du contexte
            };

            if (isAdminAuthenticated) {
                // Si c'est un h1 ou h2, utiliser un input, sinon un textarea
                if (Tag === 'h1' || Tag === 'h2') {
                    return (
                        <input
                            type="text"
                            value={typeof textValue === 'string' ? textValue : ''} // Assurer que la valeur est une string
                            onChange={handleChange}
                            className={`${className} bg-gray-700 text-white rounded p-2 focus:ring-2 focus:ring-blue-500 w-full`}
                        />
                    );
                }
                return (
                    <textarea
                        value={typeof textValue === 'string' ? textValue : ''} // Assurer que la valeur est une string
                        onChange={handleChange}
                        className={`${className} bg-gray-700 text-white rounded p-2 focus:ring-2 focus:ring-blue-500 w-full min-h-[50px]`}
                        rows={typeof textValue === 'string' ? Math.max(3, textValue.split('\n').length) : 3} // Ajuste le nombre de lignes
                    />
                );
            }

            // Rendu normal pour les clients
            // Vérifie si textValue est une chaîne avant de le rendre
            // Utilisation de dangerouslySetInnerHTML pour le rendu HTML
            return <Tag className={className} dangerouslySetInnerHTML={{ __html: typeof textValue === 'string' ? textValue : '' }} />;
        };

        // Composant de la bannière défilante
        const ScrollingBanner = () => {
            const bannerText = "BRMOTORSPORT • VOTRE SATISFACTION EST NOTRE PRIORITÉ • "; // Texte à répéter
            const repeatedText = Array(10).fill(bannerText).join(''); // Répéter le texte plusieurs fois pour l'effet de défilement continu

            return (
                <div className="w-full bg-red-700 text-white text-lg font-bold py-2 overflow-hidden whitespace-nowrap fixed top-0 left-0 z-50 shadow-md">
                    <div className="scrolling-banner-container">
                        <span className="scrolling-banner-text">
                            {repeatedText}
                        </span>
                        <span className="scrolling-banner-text" aria-hidden="true">
                            {repeatedText} {/* Une copie pour assurer la continuité du défilement */}
                        </span>
                    </div>
                </div>
            );
        };

        // Composant de la barre de navigation
        const Navbar = ({ setCurrentPage, isAdminAuthenticated, handleLogout, isVisible }) => {
          const [isOpen, setIsOpen] = useState(false); // État pour la visibilité du menu mobile

          const toggleMenu = () => {
            setIsOpen(!isOpen);
          };

          return (
            <nav className={`bg-gray-900 bg-opacity-90 backdrop-blur-sm p-4 fixed w-full z-50 shadow-lg rounded-b-lg top-[40px] navbar-transition ${isVisible ? 'navbar-visible' : 'navbar-hidden'}`}>
              <div className="container mx-auto flex justify-between items-center px-4">
                {/* Titre BRMOTORSPORT avec un style amélioré et des couleurs et l'animation de coulissement */}
                <div className="text-2xl sm:text-3xl md:text-4xl font-extrabold tracking-widest drop-shadow-lg opacity-0 animate-slide-in-left"> {/* Ajusté pour mobile */}
                  <span className="text-red-500">BR</span>
                  <span className="text-white">MOTOR</span>
                  {/* Titre classique sans icône pour SPORT */}
                  <span className="text-blue-500">SPORT</span>
                </div>

                {/* Icône du menu hamburger pour mobile */}
                <div className="md:hidden">
                  <button onClick={toggleMenu} className="text-gray-300 hover:text-red-500 focus:outline-none focus:ring-2 focus:ring-red-500 rounded-lg p-2">
                    <svg className="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                      <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d={isOpen ? "M6 18L18 6M6 6l12 12" : "M4 6h16M4 12h16M4 18h16"}></path>
                    </svg>
                  </button>
                </div>

                {/* Menu de bureau */}
                <div className="hidden md:flex space-x-8">
                  <NavItem icon={<CarIcon />} text="Accueil" page="accueil" setCurrentPage={setCurrentPage} />
                  <NavItem icon={<StarIcon />} text="Voiture Vitrine" page="voiture-vitrine" setCurrentPage={setCurrentPage} /> {/* Ajout du lien "Voiture Vitrine" */}
                  <NavItem icon={<RssIcon />} text="Blog" page="blog" setCurrentPage={setCurrentPage} />
                  <NavItem icon={<UsersIcon />} text="Qui Sommes-nous" page="qui-sommes-nous" setCurrentPage={setCurrentPage} />
                  <NavItem icon={<PhoneIcon />} text="Contact" page="contact" setCurrentPage={setCurrentPage} />
                  {/* Lien Admin/Déconnexion conditionnel */}
                  {isAdminAuthenticated ? (
                      <NavItem text="Déconnexion" page="accueil" setCurrentPage={setCurrentPage} onClick={handleLogout} />
                  ) : (
                      <NavItem text="Admin" page="admin-login" setCurrentPage={setCurrentPage} />
                  )}
                </div>
              </div>

              {/* Menu coulissant mobile */}
              <div className={`md:hidden absolute top-full left-0 w-full bg-gray-900 bg-opacity-95 backdrop-blur-sm shadow-lg
                             transform transition-transform duration-300 ease-in-out ${isOpen ? 'translate-x-0' : '-translate-x-full'} z-40`}>
                <div className="flex flex-col items-center py-4 space-y-4">
                  <NavItem icon={<CarIcon />} text="Accueil" page="accueil" setCurrentPage={setCurrentPage} onClick={() => setIsOpen(false)} />
                  <NavItem icon={<StarIcon />} text="Voiture Vitrine" page="voiture-vitrine" setCurrentPage={setCurrentPage} onClick={() => setIsOpen(false)} /> {/* Ajout du lien "Voiture Vitrine" pour mobile */}
                  <NavItem icon={<RssIcon />} text="Blog" page="blog" setCurrentPage={setCurrentPage} onClick={() => setIsOpen(false)} />
                  <NavItem icon={<UsersIcon />} text="Qui Sommes-nous" page="qui-sommes-nous" setCurrentPage={setCurrentPage} onClick={() => setIsOpen(false)} />
                  <NavItem icon={<PhoneIcon />} text="Contact" page="contact" setCurrentPage={setCurrentPage} onClick={() => setIsOpen(false)} />
                  {/* Lien Admin/Déconnexion conditionnel pour mobile */}
                  {isAdminAuthenticated ? (
                      <NavItem text="Déconnexion" page="accueil" setCurrentPage={setCurrentPage} onClick={() => { handleLogout(); setIsOpen(false); }} />
                  ) : (
                      <NavItem text="Admin" page="admin-login" setCurrentPage={setCurrentPage} onClick={() => setIsOpen(false)} />
                  )}
                </div>
              </div>
            </nav>
          );
        };

        // Composant d'élément de navigation
        const NavItem = ({ icon, text, page, setCurrentPage, onClick }) => (
          <button
            onClick={() => {
              setCurrentPage(page);
              if (onClick) onClick(); // Appelle onClick pour fermer le menu si fourni
            }}
            className="flex items-center text-gray-300 hover:text-red-500 transition duration-300 ease-in-out transform hover:scale-105
                       px-3 py-2 rounded-lg text-sm font-medium focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-opacity50"
          >
            {icon && <span className="mr-2 text-xl">{icon}</span>}
            {text}
          </button>
        );

        // Composant Page d'Accueil
        const HomePage = ({ setCurrentPage, isAdminAuthenticated }) => {
            return (
                <div className="min-h-screen bg-gradient-to-br from-blue-950 to-emerald-950 text-white pt-40 pb-12 font-inter relative"> {/* Ajout de 'relative' ici */}
                    {/* Effets visuels de fond (blobs animés) */}
                    <div className="absolute inset-0 opacity-10 pointer-events-none overflow-hidden"> {/* Utilise inset-0 et overflow-hidden */}
                        <div className="absolute w-64 h-64 bg-red-600 rounded-full mix-blend-multiply filter blur-xl opacity-70 animate-blob top-10 left-1/4"></div>
                        <div className="absolute w-72 h-72 bg-blue-600 rounded-full mix-blend-multiply filter blur-xl opacity-70 animate-blob animation-delay-2000 top-1/2 right-1/4"></div>
                        <div className="absolute w-80 h-80 bg-green-600 rounded-full mix-blend-multiply filter blur-xl opacity-70 animate-blob animation-delay-4000 bottom-10 left-1/2"></div>
                    </div>

                    <div className="container mx-auto px-6 relative z-10">
                        {/* Section Titre principal et description */}
                        <section className="text-center mb-20">
                            <EditableText
                                tag="h1"
                                contentKey="home.mainTitle"
                                isAdminAuthenticated={isAdminAuthenticated}
                                className="text-4xl sm:text-5xl md:text-6xl lg:text-7xl font-extrabold mb-6 leading-tight drop-shadow-lg animate-fade-in-down animate-vibrate" /* Ajusté pour mobile */
                            />
                            <EditableText
                                tag="p"
                                contentKey="home.description"
                                isAdminAuthenticated={isAdminAuthenticated}
                                className="text-xl md:text-2xl text-gray-300 max-w-3xl mx-auto mt-10 animate-fade-in-up"
                            />
                            {/* Boutons d'appel à l'action */}
                            <div className="flex flex-col sm:flex-row justify-center space-y-4 sm:space-y-0 sm:space-x-6 mt-8">
                                <button
                                    onClick={() => setCurrentPage('blog')}
                                    className="bg-red-600 hover:bg-red-700 text-white font-bold py-3 px-8 rounded-full shadow-lg transition duration-300 ease-in-out transform hover:scale-105 active:scale-95 animate-bounce-in"
                                >
                                    Découvrez notre blog
                                </button>
                                <button
                                    onClick={() => setCurrentPage('voiture-vitrine')}
                                    className="bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-8 rounded-full shadow-lg transition duration-300 ease-in-out transform hover:scale-105 active:scale-95 animate-bounce-in"
                                >
                                    Découvrez également notre voiture vitrine
                                </button>
                            </div>
                        </section>

                        {/* Section Message de contact cliquable */}
                        <section className="text-center bg-gray-800 p-8 rounded-2xl shadow-xl border border-gray-700 mb-20 animate-fade-in-up">
                            <a
                                href="#"
                                onClick={(e) => { e.preventDefault(); setCurrentPage('contact'); }}
                                className="block text-xl text-gray-200 leading-relaxed max-w-3xl mx-auto font-semibold text-red-400 hover:underline cursor-pointer"
                            >
                                <EditableText
                                    tag="span"
                                    contentKey="home.contactMessage"
                                    isAdminAuthenticated={isAdminAuthenticated}
                                    className="font-semibold text-red-400"
                                />
                            </a>
                        </section>

                        {/* Section Nos Offres */}
                        <section className="mb-20">
                            <EditableText
                                tag="h2"
                                contentKey="home.offerTitle"
                                isAdminAuthenticated={isAdminAuthenticated}
                                className="text-3xl sm:text-4xl md:text-5xl font-bold text-center mb-12 text-red-400 animate-fade-in" /* Ajusté pour mobile */
                            />
                            <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8">
                                {[
                                    { icon: <CarIcon />, titleKey: "home.offer1Title", descriptionKey: "home.offer1Description" },
                                    { icon: <span className="text-3xl">🚀</span>, titleKey: "home.offer2Title", descriptionKey: "home.offer2Description" },
                                    { icon: <span className="text-3xl">📈</span>, titleKey: "home.offer3Title", descriptionKey: "home.offer3Description" },
                                    { icon: <span className="text-3xl">💡</span>, titleKey: "home.offer4Title", descriptionKey: "home.offer4Description" }
                                ].map((service, index) => (
                                    <ServiceCard
                                        key={index}
                                        icon={service.icon}
                                        titleKey={service.titleKey}
                                        descriptionKey={service.descriptionKey}
                                        isAdminAuthenticated={isAdminAuthenticated}
                                        style={{ '--delay-factor': `${index * 200}ms` }}
                                    />
                                ))}
                            </div>
                        </section>

                        {/* Section Pourquoi nous faire confiance */}
                        <section className="mb-20">
                            <EditableText
                                tag="h2"
                                contentKey="home.trustTitle"
                                isAdminAuthenticated={isAdminAuthenticated}
                                className="text-3xl sm:text-4xl md:text-5xl font-bold text-center mb-12 text-blue-400 animate-fade-in" /* Ajusté pour mobile */
                            />
                            <div className="grid grid-cols-1 md:grid-cols-2 gap-8">
                                {[
                                    { icon: <span className="text-3xl">⏱️</span>, titleKey: "home.trust1Title", descriptionKey: "home.trust1Description" },
                                    { icon: <HandshakeIcon />, titleKey: "home.trust2Title", descriptionKey: "home.trust2Description" },
                                    { icon: <span className="text-3xl">🏆</span>, titleKey: "home.trust3Title", descriptionKey: "home.trust3Description" },
                                    { icon: <span className="text-3xl">⭐</span>, titleKey: "home.trust4Title", descriptionKey: "home.trust4Description" }
                                ].map((trust, index) => (
                                    <TrustCard
                                        key={index}
                                        icon={trust.icon}
                                        titleKey={trust.titleKey}
                                        descriptionKey={trust.descriptionKey}
                                        isAdminAuthenticated={isAdminAuthenticated}
                                        style={{ '--delay-factor': `${index * 200}ms` }}
                                    />
                                ))}
                            </div>
                        </section>

                        {/* Section L'équipe (avec image de Rémy Bruyant) */}
                        <section className="text-center mb-20 bg-gray-800 p-12 rounded-2xl shadow-xl transform transition duration-500 hover:scale-[1.02] hover:shadow-2xl hover:shadow-orange-500/50">
                            <EditableText
                                tag="h2"
                                contentKey="home.teamTitle"
                                isAdminAuthenticated={isAdminAuthenticated}
                                className="text-3xl sm:text-4xl font-bold mb-6 text-orange-400 animate-fade-in" /* Ajusté pour mobile */
                            />
                            <EditableText
                                tag="p"
                                contentKey="home.teamDescription"
                                isAdminAuthenticated={isAdminAuthenticated}
                                className="text-xl text-gray-200 leading-relaxed max-w-4xl mx-auto"
                            />
                            <div className="mt-8">
                                <ImageOfRemyBruyant // Remplacement de l'image par le composant ImageOfRemyBruyant
                                    className="mx-auto rounded-full border-4 border-red-500 shadow-lg w-32 h-32 object-cover"
                                />
                            </div>
                        </section>
                    </div>
                </div>
            );
        };

        // Nouveau composant pour l'image de Rémy Bruyant
        const ImageOfRemyBruyant = ({ className }) => {
            const imageUrl = "https://placehold.co/150x150/000/FFF?text=Remy"; // Ou votre URL d'image réelle
            return (
                <img
                    src={imageUrl}
                    alt="Portrait de Rémy Bruyant"
                    className={className}
                    onError={(e) => { e.target.onerror = null; e.target.src="https://placehold.co/150x150/000/FFF?text=Rémy+Bruyant"; }}
                />
            );
        };

        // Composant Carte de Service
        const ServiceCard = ({ icon, titleKey, descriptionKey, style, isAdminAuthenticated }) => (
          <div className="group bg-gray-800 p-8 rounded-xl shadow-lg flex flex-col items-center text-center transition duration-300 ease-in-out transform hover:scale-105 hover:bg-gray-700 border border-gray-700 hover:border-red-500 animate-fade-in-up delay-animation" style={style}>
            <div className="text-red-500 mb-4 text-5xl transition-colors duration-300 group-hover:text-red-400">{icon}</div>
            <EditableText
                tag="h3"
                contentKey={titleKey}
                isAdminAuthenticated={isAdminAuthenticated}
                className="text-xl sm:text-2xl font-semibold mb-3 text-white transition-colors duration-300 group-hover:text-red-200" /* Ajusté pour mobile */
            />
            <EditableText
                tag="p"
                contentKey={descriptionKey}
                isAdminAuthenticated={isAdminAuthenticated}
                className="text-gray-300"
            />
          </div>
        );

        // Composant Carte de Confiance
        const TrustCard = ({ icon, titleKey, descriptionKey, style, isAdminAuthenticated }) => (
          <div className="group bg-gray-800 p-8 rounded-xl shadow-lg flex flex-col items-center text-center transition duration-300 ease-in-out transform hover:scale-105 hover:bg-gray-700 border border-gray-700 hover:border-blue-500 animate-fade-in-up delay-animation" style={style}>
            <div className="text-blue-500 mb-4 text-5xl transition-colors duration-300 group-hover:text-blue-400">{icon}</div>
            <EditableText
                tag="h3"
                contentKey={titleKey}
                isAdminAuthenticated={isAdminAuthenticated}
                className="text-xl sm:text-2xl font-semibold mb-3 text-white transition-colors duration-300 group-hover:text-blue-200" /* Ajusté pour mobile */
            />
            <EditableText
                tag="p"
                contentKey={descriptionKey}
                isAdminAuthenticated={isAdminAuthenticated}
                className="text-gray-300"
            />
          </div>
        );

        // Composant Lightbox (visionneuse d'images)
        const Lightbox = ({ images, currentIndex, onClose, onNavigate }) => {
            if (!images || images.length === 0) return null;

            const handlePrev = () => {
                onNavigate(currentIndex === 0 ? images.length - 1 : currentIndex - 1);
            };

            const handleNext = () => {
                onNavigate((currentIndex + 1) % images.length);
            };

            // Fermer avec la touche Échap
            useEffect(() => {
                const handleKeyDown = (e) => {
                    if (e.key === 'Escape') {
                        onClose();
                    } else if (e.key === 'ArrowLeft') {
                        handlePrev();
                    } else if (e.key === 'ArrowRight') {
                        handleNext();
                    }
                };
                window.addEventListener('keydown', handleKeyDown);
                return () => window.removeEventListener('keydown', handleKeyDown);
            }, [currentIndex, images.length, onClose]);

            return (
                <div className="lightbox-overlay" onClick={onClose}>
                    <div className="lightbox-content" onClick={(e) => e.stopPropagation()}> {/* Empêche la fermeture au clic sur l'image */}
                        <button className="lightbox-close-button" onClick={onClose} aria-label="Fermer la visionneuse">
                            <XIcon />
                        </button>
                        {images.length > 1 && (
                            <button className="lightbox-button lightbox-prev-button" onClick={handlePrev} aria-label="Image précédente">
                                <ArrowLeftIcon />
                            </button>
                        )}
                        <img
                            src={images[currentIndex]}
                            alt={`Image ${currentIndex + 1}`}
                            className="lightbox-image"
                            onError={(e) => { e.target.onerror = null; e.target.src="https://placehold.co/800x600/000/FFF?text=Image+non+trouvée"; }}
                        />
                        {images.length > 1 && (
                            <button className="lightbox-button lightbox-next-button" onClick={handleNext} aria-label="Image suivante">
                                <ArrowRightIcon />
                            </button>
                        )}
                    </div>
                </div>
            );
        };


        // Composant Carte de Blog pour l'affichage public
        const BlogPostCard = ({ post, style, openLightbox }) => {
            const [currentImageIndex, setCurrentImageIndex] = useState(0);
            const [isPlaying, setIsPlaying] = useState(true); // Auto-play by default

            // Gère la lecture automatique du diaporama
            useEffect(() => {
                let interval;
                if (isPlaying && post.images && post.images.length > 1) {
                    interval = setInterval(() => {
                        setCurrentImageIndex((prevIndex) =>
                            (prevIndex + 1) % post.images.length
                        );
                    }, 3000); // Change l'image toutes les 3 secondes
                }
                return () => clearInterval(interval); // Nettoyage de l'intervalle
            }, [isPlaying, post.images]); // Dépendances: isPlaying et le tableau d'images

            const goToPrevious = (e) => {
                e.stopPropagation(); // Prevent opening lightbox
                if (!post.images || post.images.length === 0) return;
                setCurrentImageIndex((prevIndex) =>
                    prevIndex === 0 ? post.images.length - 1 : prevIndex - 1
                );
                setIsPlaying(false);
            };

            const goToNext = (e) => {
                e.stopPropagation(); // Prevent opening lightbox
                if (!post.images || post.images.length === 0) return;
                setCurrentImageIndex((prevIndex) =>
                    (prevIndex + 1) % post.images.length
                );
                setIsPlaying(false);
            };

            const togglePlayPause = (e) => {
                e.stopPropagation(); // Prevent opening lightbox
                setIsPlaying(!isPlaying);
            };

            const displayImage = post.images && post.images.length > 0 ? post.images[currentImageIndex] : "https://placehold.co/600x400/000/FFF?text=Image+non+trouvée";

            return (
              <div className="bg-gray-800 rounded-xl shadow-lg overflow-hidden transform transition duration-300 ease-in-out hover:scale-105 hover:shadow-2xl hover:shadow-green-500/50 border border-gray-700 hover:border-green-400 animate-fade-in-up delay-animation" style={style}>
                <div
                    className="relative w-full h-64 overflow-hidden cursor-pointer"
                    onClick={() => post.images && post.images.length > 0 && openLightbox(post.images, currentImageIndex)}
                >
                    <img
                      src={displayImage}
                      alt={post.title}
                      className="w-full h-full object-cover object-center transition-opacity duration-700"
                      onError={(e) => { e.target.onerror = null; console.error(`ERREUR DE CHARGEMENT D'IMAGE pour l'article "${post.title}": Vérifiez le nom du fichier (${displayImage}) et son emplacement.`); e.target.src=`https://placehold.co/600x400/000/FFF?text=Image+non+trouvée`; }}
                    />
                    {post.images && post.images.length > 1 && (
                        <>
                            <button
                                onClick={goToPrevious}
                                className="absolute left-2 top-1/2 -translate-y-1/2 bg-black bg-opacity-50 text-white p-2 rounded-full hover:bg-opacity-80 transition duration-300 focus:outline-none"
                                aria-label="Image précédente"
                            ><ArrowLeftIcon className="w-5 h-5"/></button>
                            <button
                                onClick={goToNext}
                                className="absolute right-2 top-1/2 -translate-y-1/2 bg-black bg-opacity-50 text-white p-2 rounded-full hover:bg-opacity-80 transition duration-300 focus:outline-none"
                                aria-label="Image suivante"
                            ><ArrowRightIcon className="w-5 h-5"/></button>
                            <button
                                onClick={togglePlayPause}
                                className="absolute bottom-2 left-1/2 -translate-x-1/2 bg-black bg-opacity-50 text-white p-2 rounded-full hover:bg-opacity-80 transition duration-300 focus:outline-none"
                                aria-label={isPlaying ? "Mettre en pause le diaporama" : "Lancer le diaporama"}
                            >
                                {isPlaying ? <PauseIcon className="w-5 h-5"/> : <PlayIcon className="w-5 h-5"/>}
                            </button>
                            <div className="absolute bottom-2 right-2 bg-black bg-opacity-70 text-white text-xs px-2 py-1 rounded">
                                {currentImageIndex + 1} / {post.images.length}
                            </div>
                        </>
                    )}
                </div>
                <div className="p-6">
                  <h3 className="text-xl sm:text-2xl font-bold mb-3 text-white leading-tight">{post.title}</h3> {/* Ajusté pour mobile */}
                  <p className="text-gray-300 mb-4">{post.description}</p>
                  <button className="bg-gradient-to-r from-green-500 to-teal-500 text-white font-semibold py-2 px-6 rounded-full hover:from-green-600 hover:to-teal-600 transition duration-300 ease-in-out shadow-md">
                    Lire la suite
                  </button>
                </div>
              </div>
            );
        };


        // Composant Page Blog
        const BlogPage = ({ isAdminAuthenticated }) => {
          const { content } = useContext(ContentContext);
          const blogPosts = content?.blog?.posts || [];

          // Lightbox state
          const [isLightboxOpen, setIsLightboxOpen] = useState(false);
          const [lightboxImages, setLightboxImages] = useState([]);
          const [currentLightboxImageIndex, setCurrentLightboxImageIndex] = useState(0);

          const openLightbox = (images, initialIndex) => {
              setLightboxImages(images);
              setCurrentLightboxImageIndex(initialIndex);
              setIsLightboxOpen(true);
          };

          const closeLightbox = () => {
              setIsLightboxOpen(false);
              setLightboxImages([]);
              setCurrentLightboxImageIndex(0);
          };

          const navigateLightbox = (newIndex) => {
              setCurrentLightboxImageIndex(newIndex);
          };

          return (
            <div className="min-h-screen bg-gradient-to-br from-blue-950 to-emerald-950 text-white pt-40 pb-12 font-inter">
              <div className="container mx-auto px-6">
                <EditableText
                    tag="h1"
                    contentKey="blog.mainTitle"
                    isAdminAuthenticated={isAdminAuthenticated}
                    className="text-4xl sm:text-5xl font-extrabold text-center mb-12 text-green-400 animate-fade-in-down animate-vibrate" /* Ajusté pour mobile */
                />
                <EditableText
                    tag="p"
                    contentKey="blog.description"
                    isAdminAuthenticated={isAdminAuthenticated}
                    className="text-xl text-center text-gray-300 max-w-3xl mx-auto mb-10 animate-fade-in-up"
                />

                <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-10">
                  {blogPosts.length > 0 ? (
                    blogPosts.map((post, index) => (
                      <BlogPostCard
                        key={post.id || `blog-post-${index}`}
                        post={post}
                        style={{ '--delay-factor': `${index * 150}ms` }}
                        openLightbox={openLightbox} // Pass openLightbox function
                      />
                    ))
                  ) : (
                    <p className="col-span-full text-center text-gray-400 text-2xl mt-10">
                      Aucun article de blog à afficher pour le moment.
                    </p>
                  )}
                </div>
              </div>
              {isLightboxOpen && (
                  <Lightbox
                      images={lightboxImages}
                      currentIndex={currentLightboxImageIndex}
                      onClose={closeLightbox}
                      onNavigate={navigateLightbox}
                  />
              )}
            </div>
          );
        };


        // Composant Input Field (réutilisable)
        const InputField = ({ label, type, placeholder, required = false, value, onChange, name }) => (
          <div>
            <label htmlFor={name || label} className="block text-gray-300 text-sm font-bold mb-2"> {/* Utilise name comme id si fourni */}
              {label} {required && <span className="text-red-500">*</span>}
            </label>
            <input
              id={name || label} // Utilise name comme id si fourni
              type={type}
              name={name} // Ajout de l'attribut name
              placeholder={placeholder}
              required={required}
              value={value}
              onChange={onChange}
              className="shadow appearance-none border border-gray-700 rounded-lg w-full py-3 px-4 bg-gray-700 text-white leading-tight focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent transition duration-200"
            />
          </div>
        );

        // Composant TextArea Field (réutilisable)
        const TextAreaField = ({ label, placeholder, required = false, value, onChange, name }) => (
          <div>
            <label htmlFor={name || label} className="block text-gray-300 text-sm font-bold mb-2"> {/* Utilise name comme id si fourni */}
              {label} {required && <span className="text-red-500">*</span>}
            </label>
            <textarea
              id={name || label} // Utilise name comme id si fourni
              name={name} // Ajout de l'attribut name
              placeholder={placeholder}
              required={required}
              rows="5"
              value={value}
              onChange={onChange}
              className="shadow appearance-none border border-gray-700 rounded-lg w-full py-3 px-4 bg-gray-700 text-white leading-tight focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent transition duration-200 resize-y"
            ></textarea>
          </div>
        );


        // Composant Page Qui Sommes-nous
        const AboutUsPage = ({ isAdminAuthenticated }) => {
            return (
                <div className="min-h-screen bg-gradient-to-br from-blue-950 to-emerald-950 text-white pt-40 pb-12 font-inter">
                    <div className="container mx-auto px-6 max-w-4xl">
                        <EditableText
                            tag="h1"
                            contentKey="aboutUs.mainTitle"
                            isAdminAuthenticated={isAdminAuthenticated}
                            className="text-4xl sm:text-5xl font-extrabold text-center mb-12 text-yellow-400 animate-fade-in-down animate-vibrate" /* Ajusté pour mobile */
                        />
                        <EditableText
                            tag="p"
                            contentKey="aboutUs.description"
                            isAdminAuthenticated={isAdminAuthenticated}
                            className="text-xl text-center text-gray-300 max-w-3xl mx-auto mb-10 animate-fade-in-up"
                        />

                        <section className="bg-gray-800 p-8 rounded-2xl shadow-xl border border-gray-700 mb-12 animate-fade-in-up">
                            <EditableText
                                tag="h2"
                                contentKey="aboutUs.historyTitle"
                                isAdminAuthenticated={isAdminAuthenticated}
                                className="text-3xl sm:text-4xl font-bold mb-6 text-yellow-300 text-center" /* Ajusté pour mobile */
                            />
                            <EditableText
                                tag="p"
                                contentKey="aboutUs.historyParagraph1"
                                isAdminAuthenticated={isAdminAuthenticated}
                                className="text-lg text-gray-300 leading-relaxed mb-6"
                            />
                            <EditableText
                                tag="p"
                                contentKey="aboutUs.historyParagraph2"
                                isAdminAuthenticated={isAdminAuthenticated}
                                className="text-lg text-gray-300 leading-relaxed"
                            />
                        </section>

                        <section className="bg-gray-800 p-8 rounded-2xl shadow-xl border border-gray-700 animate-fade-in-up">
                            <EditableText
                                tag="h2"
                                contentKey="aboutUs.valuesTitle"
                                isAdminAuthenticated={isAdminAuthenticated}
                                className="text-3xl sm:text-4xl font-bold mb-6 text-yellow-300 text-center" /* Ajusté pour mobile */
                            />
                            <div className="grid grid-cols-1 md:grid-cols-2 gap-8">
                                <ValueCard
                                    titleKey="aboutUs.value1Title"
                                    descriptionKey="aboutUs.value1Description"
                                    icon={<WrenchIcon />}
                                    isAdminAuthenticated={isAdminAuthenticated}
                                />
                                <ValueCard
                                    titleKey="aboutUs.value2Title"
                                    descriptionKey="aboutUs.value2Description"
                                    icon={<span className="text-3xl">✨</span>}
                                    isAdminAuthenticated={isAdminAuthenticated}
                                />
                                <ValueCard
                                    titleKey="aboutUs.value3Title"
                                    descriptionKey="aboutUs.value3Description"
                                    icon={<span className="text-3xl">✅</span>}
                                    isAdminAuthenticated={isAdminAuthenticated}
                                />
                                <ValueCard
                                    titleKey="aboutUs.value4Title"
                                    descriptionKey="aboutUs.value4Description"
                                    icon={<span className="text-3xl">❤️</span>}
                                    isAdminAuthenticated={isAdminAuthenticated}
                                />
                            </div>
                        </section>
                    </div>
                </div>
            );
        };

        // Composant Carte de Valeur
        const ValueCard = ({ icon, titleKey, descriptionKey, isAdminAuthenticated }) => (
          <div className="group bg-gray-700 p-6 rounded-lg shadow-md flex items-start space-x-4 transition duration-300 ease-in-out transform hover:scale-105 border border-gray-600 hover:border-yellow-400">
            <div className="text-yellow-400 mb-4 text-4xl transition-colors duration-300 group-hover:text-yellow-300">{icon}</div>
            <div>
              <EditableText
                tag="h3"
                contentKey={titleKey}
                isAdminAuthenticated={isAdminAuthenticated}
                className="text-xl sm:text-2xl font-semibold mb-2 text-white transition-colors duration-300 group-hover:text-yellow-100" /* Ajusté pour mobile */
              />
              <EditableText
                tag="p"
                contentKey={descriptionKey}
                isAdminAuthenticated={isAdminAuthenticated}
                className="text-gray-300"
              />
            </div>
          </div>
        );

        // Composant Page Contact
        const ContactPage = ({ isAdminAuthenticated }) => {
            const { content } = useContext(ContentContext);
            return (
                <div className="min-h-screen bg-gradient-to-br from-blue-950 to-emerald-950 text-white pt-40 pb-12 font-inter">
                    <div className="container mx-auto px-6 max-w-2xl">
                        <EditableText
                            tag="h1"
                            contentKey="contact.mainTitle"
                            isAdminAuthenticated={isAdminAuthenticated}
                            className="text-4xl sm:text-5xl font-extrabold text-center mb-12 text-pink-400 animate-fade-in-down animate-vibrate" /* Ajusté pour mobile */
                        />
                        <EditableText
                            tag="p"
                            contentKey="contact.description"
                            isAdminAuthenticated={isAdminAuthenticated}
                            className="text-xl text-center text-gray-300 max-w-xl mx-auto mb-10 animate-fade-in-up"
                        />

                        <div className="bg-gray-800 p-8 rounded-2xl shadow-xl border border-gray-700 animate-fade-in-up space-y-8">
                            <div className="flex flex-col items-center text-center">
                                <MailIcon className="text-pink-500 w-12 h-12 mb-4" />
                                <EditableText
                                    tag="h3"
                                    contentKey="contact.emailTitle"
                                    isAdminAuthenticated={isAdminAuthenticated}
                                    className="text-xl sm:text-2xl font-semibold mb-2 text-white" /* Ajusté pour mobile */
                                />
                                <a href={`mailto:${content.contact.email}`} className="text-blue-400 hover:underline text-lg transition duration-300">
                                    <EditableText
                                        tag="span"
                                        contentKey="contact.email"
                                        isAdminAuthenticated={isAdminAuthenticated}
                                        className="text-blue-400 hover:underline text-lg"
                                    />
                                </a>
                            </div>

                            <div className="flex flex-col items-center text-center">
                                <PhoneIcon className="text-pink-500 w-12 h-12 mb-4" />
                                <EditableText
                                    tag="h3"
                                    contentKey="contact.phoneTitle"
                                    isAdminAuthenticated={isAdminAuthenticated}
                                    className="text-xl sm:text-2xl font-semibold mb-2 text-white" /* Ajusté pour mobile */
                                />
                                <a href={`tel:${content.contact.phoneNumber.replace(/\./g, '')}`} className="text-blue-400 hover:underline text-lg transition duration-300">
                                    <EditableText
                                        tag="span"
                                        contentKey="contact.phoneNumber"
                                        isAdminAuthenticated={isAdminAuthenticated}
                                        className="text-blue-400 hover:underline text-lg"
                                    />
                                </a>
                            </div>

                            <div className="flex flex-col items-center text-center">
                                <InstagramIcon className="text-pink-500 w-12 h-12 mb-4" />
                                <EditableText
                                    tag="h3"
                                    contentKey="contact.instagramTitle"
                                    isAdminAuthenticated={isAdminAuthenticated}
                                    className="text-xl sm:text-2xl font-semibold mb-2 text-white" /* Ajusté pour mobile */
                                />
                                <a href={`https://www.instagram.com/${content.contact.instagramHandle.replace('@', '')}`} target="_blank" rel="noopener noreferrer" className="text-blue-400 hover:underline text-lg transition duration-300">
                                    <EditableText
                                        tag="span"
                                        contentKey="contact.instagramHandle"
                                        isAdminAuthenticated={isAdminAuthenticated}
                                        className="text-blue-400 hover:underline text-lg"
                                    />
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        // Composant pour la page des mentions légales
        const LegalMentionsPage = ({ isAdminAuthenticated }) => {
            return (
                <div className="min-h-screen bg-gradient-to-br from-blue-950 to-emerald-950 text-white pt-40 pb-12 font-inter">
                    <div className="container mx-auto px-6 max-w-4xl">
                        <EditableText
                            tag="h1"
                            contentKey="legalMentions.mainTitle"
                            isAdminAuthenticated={isAdminAuthenticated}
                            className="text-4xl sm:text-5xl font-extrabold text-center mb-12 text-teal-400 animate-fade-in-down animate-vibrate" /* Ajusté pour mobile */
                        />
                        <div className="bg-gray-800 p-8 rounded-2xl shadow-xl border border-gray-700 animate-fade-in-up space-y-6">
                            <EditableText
                                tag="h2"
                                contentKey="legalMentions.sectionTitle"
                                isAdminAuthenticated={isAdminAuthenticated}
                                className="text-2xl sm:text-3xl font-bold mb-4 text-white" /* Ajusté pour mobile */
                            />
                            <EditableText
                                tag="p"
                                contentKey="legalMentions.paragraph1"
                                isAdminAuthenticated={isAdminAuthenticated}
                                className="text-lg text-gray-300 leading-relaxed"
                            />
                            <EditableText
                                tag="p"
                                contentKey="legalMentions.paragraph2"
                                isAdminAuthenticated={isAdminAuthenticated}
                                className="text-lg text-gray-300 leading-relaxed"
                            />
                            <ul className="list-disc list-inside text-lg text-gray-300 pl-4 space-y-2">
                                <li>
                                    <EditableText
                                        tag="span"
                                        contentKey="legalMentions.list1Item1"
                                        isAdminAuthenticated={isAdminAuthenticated}
                                        className="text-lg text-gray-300"
                                    />
                                </li>
                                <li>
                                    <EditableText
                                        tag="span"
                                        contentKey="legalMentions.list1Item2"
                                        isAdminAuthenticated={isAdminAuthenticated}
                                        className="text-lg text-gray-300"
                                    />
                                </li>
                                <li>
                                    <EditableText
                                        tag="span"
                                        contentKey="legalMentions.list1Item3"
                                        isAdminAuthenticated={isAdminAuthenticated}
                                        className="text-lg text-gray-300"
                                    />
                                </li>
                            </ul>
                            <EditableText
                                tag="p"
                                contentKey="legalMentions.paragraph3"
                                isAdminAuthenticated={isAdminAuthenticated}
                                className="text-lg text-gray-300 leading-relaxed"
                            />
                            <ul className="list-disc list-inside text-lg text-gray-300 pl-4 space-y-2">
                                <li>
                                    <EditableText
                                        tag="span"
                                        contentKey="legalMentions.list2Item1"
                                        isAdminAuthenticated={isAdminAuthenticated}
                                        className="text-lg text-gray-300"
                                    />
                                </li>
                                <li>
                                    <EditableText
                                        tag="span"
                                        contentKey="legalMentions.list2Item2"
                                        isAdminAuthenticated={isAdminAuthenticated}
                                        className="text-lg text-gray-300"
                                    />
                                </li>
                                <li>
                                    <EditableText
                                        tag="span"
                                        contentKey="legalMentions.list2Item3"
                                        isAdminAuthenticated={isAdminAuthenticated}
                                        className="text-lg text-gray-300"
                                    />
                                </li>
                            </ul>
                            <EditableText
                                tag="p"
                                contentKey="legalMentions.paragraph4"
                                isAdminAuthenticated={isAdminAuthenticated}
                                className="text-lg text-gray-300 leading-relaxed"
                            />
                        </div>
                    </div>
                </div>
            );
        };

        // Composant pour la page de politique de confidentialité
        const PrivacyPolicyPage = ({ isAdminAuthenticated }) => {
            return (
                <div className="min-h-screen bg-gradient-to-br from-blue-950 to-emerald-950 text-white pt-40 pb-12 font-inter">
                    <div className="container mx-auto px-6 max-w-4xl">
                        <EditableText
                            tag="h1"
                            contentKey="privacyPolicy.mainTitle"
                            isAdminAuthenticated={isAdminAuthenticated}
                            className="text-4xl sm:text-5xl font-extrabold text-center mb-12 text-purple-400 animate-fade-in-down animate-vibrate" /* Ajusté pour mobile */
                        />
                        <div className="bg-gray-800 p-8 rounded-2xl shadow-xl border border-gray-700 animate-fade-in-up space-y-6">
                            <EditableText
                                tag="h2"
                                contentKey="privacyPolicy.introTitle"
                                isAdminAuthenticated={isAdminAuthenticated}
                                className="text-2xl sm:text-3xl font-bold mb-4 text-white" /* Ajusté pour mobile */
                            />
                            <EditableText
                                tag="p"
                                contentKey="privacyPolicy.introText"
                                isAdminAuthenticated={isAdminAuthenticated}
                                className="text-lg text-gray-300 leading-relaxed"
                            />

                            <EditableText
                                tag="h2"
                                contentKey="privacyPolicy.collectionTitle"
                                isAdminAuthenticated={isAdminAuthenticated}
                                className="text-2xl sm:text-3xl font-bold mb-4 text-white" /* Ajusté pour mobile */
                            />
                            <EditableText
                                tag="p"
                                contentKey="privacyPolicy.collectionText"
                                isAdminAuthenticated={isAdminAuthenticated}
                                className="text-lg text-gray-300 leading-relaxed"
                            />

                            <EditableText
                                tag="h2"
                                contentKey="privacyPolicy.usageTitle"
                                isAdminAuthenticated={isAdminAuthenticated}
                                className="text-2xl sm:text-3xl font-bold mb-4 text-white" /* Ajusté pour mobile */
                            />
                            <ul className="list-disc list-inside text-lg text-gray-300 pl-4 space-y-2">
                                <li>
                                    <EditableText
                                        tag="span"
                                        contentKey="privacyPolicy.usageListItem1"
                                        isAdminAuthenticated={isAdminAuthenticated}
                                        className="text-lg text-gray-300"
                                    />
                                </li>
                                <li>
                                    <EditableText
                                        tag="span"
                                        contentKey="privacyPolicy.usageListItem2"
                                        isAdminAuthenticated={isAdminAuthenticated}
                                        className="text-lg text-gray-300"
                                    />
                                </li>
                                <li>
                                    <EditableText
                                        tag="span"
                                        contentKey="privacyPolicy.usageListItem3"
                                        isAdminAuthenticated={isAdminAuthenticated}
                                        className="text-lg text-gray-300"
                                    />
                                </li>
                            </ul>

                            <EditableText
                                tag="h2"
                                contentKey="privacyPolicy.protectionTitle"
                                isAdminAuthenticated={isAdminAuthenticated}
                                className="text-2xl sm:text-3xl font-bold mb-4 text-white" /* Ajusté pour mobile */
                            />
                            <EditableText
                                tag="p"
                                contentKey="privacyPolicy.protectionText"
                                isAdminAuthenticated={isAdminAuthenticated}
                                className="text-lg text-gray-300 leading-relaxed"
                            />

                            <EditableText
                                tag="h2"
                                contentKey="privacyPolicy.rightsTitle"
                                isAdminAuthenticated={isAdminAuthenticated}
                                className="text-2xl sm:text-3xl font-bold mb-4 text-white" /* Ajusté pour mobile */
                            />
                            <EditableText
                                tag="p"
                                contentKey="privacyPolicy.rightsText"
                                isAdminAuthenticated={isAdminAuthenticated}
                                className="text-lg text-gray-300 leading-relaxed"
                            />
                            {/* Assurez-vous que ce champ existe et est une chaîne de caractères dans content.json */}
                            <EditableText
                                tag="p"
                                contentKey="privacyPolicy.disclaimerText"
                                isAdminAuthenticated={isAdminAuthenticated}
                                className="text-lg text-gray-300 leading-relaxed"
                            />
                        </div>
                    </div>
                </div>
            );
        };

        // Composant pour la page Voiture Vitrine
        const ShowcaseCarPage = ({ isAdminAuthenticated }) => {
            const { content } = useContext(ContentContext);
            // Les images sont maintenant chargées depuis le contexte global (content.json)
            const images = content?.showcaseCar?.images || [];

            const [currentImageIndex, setCurrentImageIndex] = useState(0);
            const [isPlaying, setIsPlaying] = useState(true); // Auto-play by default

            // Lightbox state for ShowcaseCarPage
            const [isLightboxOpen, setIsLightboxOpen] = useState(false);
            const [lightboxImages, setLightboxImages] = useState([]);
            const [currentLightboxImageIndex, setCurrentLightboxImageIndex] = useState(0);

            // Function to open the lightbox
            const openLightbox = (imagesToDisplay, initialIndex) => {
                setLightboxImages(imagesToDisplay);
                setCurrentLightboxImageIndex(initialIndex);
                setIsLightboxOpen(true);
            };

            // Function to close the lightbox
            const closeLightbox = () => {
                setIsLightboxOpen(false);
                setLightboxImages([]);
                setCurrentLightboxImageIndex(0);
            };

            // Function to navigate the lightbox
            const navigateLightbox = (newIndex) => {
                setCurrentLightboxImageIndex(newIndex);
            };


            // Gère la lecture automatique du diaporama
            useEffect(() => {
                let interval;
                if (isPlaying && images.length > 1) { // Vérifie qu'il y a plus d'une image pour le diaporama
                    interval = setInterval(() => {
                        setCurrentImageIndex((prevIndex) =>
                            (prevIndex + 1) % images.length
                        );
                    }, 3000); // Change l'image toutes les 3 secondes
                }
                return () => clearInterval(interval); // Nettoyage de l'intervalle
            }, [isPlaying, images.length]); // Dépendances: isPlaying et la longueur du tableau d'images

            // Fonction pour passer à l'image précédente
            const goToPrevious = (e) => {
                e.stopPropagation(); // Prevent opening lightbox
                if (images.length === 0) return;
                setCurrentImageIndex((prevIndex) =>
                    prevIndex === 0 ? images.length - 1 : prevIndex - 1
                );
                setIsPlaying(false); // Met en pause la lecture automatique lors de l'interaction manuelle
            };

            // Fonction pour passer à l'image suivante
            const goToNext = (e) => {
                e.stopPropagation(); // Prevent opening lightbox
                if (images.length === 0) return;
                setCurrentImageIndex((prevIndex) =>
                    (prevIndex + 1) % images.length
                );
                setIsPlaying(false); // Met en pause la lecture automatique lors de l'interaction manuelle
            };

            // Fonction pour basculer entre lecture et pause de l'autoplay
            const togglePlayPause = (e) => {
                e.stopPropagation(); // Prevent opening lightbox
                setIsPlaying(!isPlaying);
            };

            return (
                <div className="min-h-screen bg-gradient-to-br from-blue-950 to-emerald-950 text-white pt-40 pb-12 font-inter">
                    <div className="container mx-auto px-6 max-w-5xl">
                        <EditableText
                            tag="h1"
                            contentKey="showcaseCar.mainTitle"
                            isAdminAuthenticated={isAdminAuthenticated}
                            className="text-4xl sm:text-5xl font-extrabold text-center mb-12 text-yellow-400 animate-fade-in-down animate-vibrate" /* Ajusté pour mobile */
                        />
                        <EditableText
                            tag="p"
                            contentKey="showcaseCar.description"
                            isAdminAuthenticated={isAdminAuthenticated}
                            className="text-xl text-center text-gray-300 max-w-3xl mx-auto mb-10 animate-fade-in-up"
                        />

                        <div className="bg-gray-800 p-8 rounded-2xl shadow-xl border border-gray-700 animate-fade-in-up space-y-8">
                            {/* Conteneur du carrousel avec centrage flexbox */}
                            <div
                                className="relative w-full h-96 md:h-[500px] overflow-hidden rounded-lg shadow-2xl border-4 border-red-700 group flex items-center justify-center cursor-pointer"
                                onClick={() => images.length > 0 && openLightbox(images, currentImageIndex)}
                            >
                                {/* Image actuelle du diaporama - Utilise object-contain pour afficher l'image entière */}
                                {images.length > 0 ? (
                                    <img
                                        src={images[currentImageIndex]}
                                        alt={`Volkswagen Scirocco R - Image ${currentImageIndex + 1}`}
                                        className="w-full h-full object-contain object-center animate-fade-in transition-opacity duration-700"
                                        onError={(e) => {
                                            console.error(
                                                `ERREUR DE CHARGEMENT D'IMAGE dans le diaporama:
                                                Vérifiez l'URL exacte affichée ci-dessous dans votre navigateur.
                                                Vérifiez la CASSE (majuscules/minuscules) et l'EXTENSION du nom de fichier sur votre dépôt GitHub.
                                                URL échouée: ${e.target.src}`,
                                                e
                                            );
                                            e.target.onerror = null;
                                            e.target.src="https://placehold.co/800x500/FF0000/FFFFFF?text=Erreur+chargement+image";
                                        }}
                                    />
                                ) : (
                                    <p className="text-gray-400">Aucune image à afficher pour la voiture vitrine.</p>
                                )}


                                {/* Boutons de navigation (précédent/suivant) */}
                                {images.length > 1 && (
                                    <>
                                        <button
                                            onClick={goToPrevious}
                                            className="absolute left-4 top-1/2 -translate-y-1/2 bg-black bg-opacity-50 text-white p-3 rounded-full hover:bg-opacity-80 transition duration-300 opacity-0 group-hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-white"
                                            aria-label="Image précédente"
                                        >
                                            <ArrowLeftIcon />
                                        </button>
                                        <button
                                            onClick={goToNext}
                                            className="absolute right-4 top-1/2 -translate-y-1/2 bg-black bg-opacity-50 text-white p-3 rounded-full hover:bg-opacity-80 transition duration-300 opacity-0 group-hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-white"
                                            aria-label="Image suivante"
                                        >
                                            <ArrowRightIcon />
                                        </button>

                                        {/* Bouton Play/Pause pour le diaporama automatique */}
                                        <button
                                            onClick={togglePlayPause}
                                            className="absolute bottom-4 left-1/2 -translate-x-1/2 bg-black bg-opacity50 text-white p-3 rounded-full hover:bg-opacity-80 transition duration-300 focus:outline-none focus:ring-2 focus:ring-white"
                                            aria-label={isPlaying ? "Mettre en pause le diaporama" : "Lancer le diaporama"}
                                        >
                                            {isPlaying ? <PauseIcon /> : <PlayIcon />}
                                        </button>

                                        {/* Indicateurs de pagination (points) */}
                                        <div className="absolute bottom-4 flex justify-center w-full space-x-2">
                                            {images.map((_, index) => (
                                                <button
                                                    key={index}
                                                    onClick={(e) => { e.stopPropagation(); setCurrentImageIndex(index); setIsPlaying(false); }}
                                                    className={`w-3 h-3 rounded-full transition-colors duration-300 ${
                                                        index === currentImageIndex ? 'bg-red-500' : 'bg-gray-400 hover:bg-gray-300'
                                                    }`}
                                                    aria-label={`Voir l'image ${index + 1}`}
                                                />
                                            ))}
                                        </div>
                                    </>
                                )}
                            </div>

                            <EditableText
                                tag="h2"
                                contentKey="showcaseCar.preparationTitle"
                                isAdminAuthenticated={isAdminAuthenticated}
                                className="text-2xl sm:text-3xl font-bold mb-4 text-white" /* Ajusté pour mobile */
                            />
                            <EditableText
                                tag="p"
                                contentKey="showcaseCar.preparationDescription"
                                isAdminAuthenticated={isAdminAuthenticated}
                                className="text-lg text-gray-300 leading-relaxed"
                            />

                            <ul className="list-disc list-inside text-lg text-gray-300 pl-6 space-y-2">
                                <li>
                                    <EditableText
                                        tag="span"
                                        contentKey="showcaseCar.piston"
                                        isAdminAuthenticated={isAdminAuthenticated}
                                        className="text-lg text-gray-300"
                                    />
                                </li>
                                <li>
                                    <EditableText
                                        tag="span"
                                        contentKey="showcaseCar.bielles"
                                        isAdminAuthenticated={isAdminAuthenticated}
                                        className="text-lg text-gray-300"
                                    />
                                </li>
                                <li>
                                    <EditableText
                                        tag="span"
                                        contentKey="showcaseCar.soupapes"
                                        isAdminAuthenticated={isAdminAuthenticated}
                                        className="text-lg text-gray-300"
                                    />
                                </li>
                                <li>
                                    <EditableText
                                        tag="span"
                                        contentKey="showcaseCar.adm"
                                        isAdminAuthenticated={isAdminAuthenticated}
                                        className="text-lg text-gray-300"
                                    />
                                </li>
                                <li>
                                    <EditableText
                                        tag="span"
                                        contentKey="showcaseCar.ressort"
                                        isAdminAuthenticated={isAdminAuthenticated}
                                        className="text-lg text-gray-300"
                                    />
                                </li>
                                <li>
                                    <EditableText
                                        tag="span"
                                        contentKey="showcaseCar.viserie"
                                        isAdminAuthenticated={isAdminAuthenticated}
                                        className="text-lg text-gray-300"
                                    />
                                </li>
                                <li>
                                    <EditableText
                                        tag="span"
                                        contentKey="showcaseCar.pompeHuile"
                                        isAdminAuthenticated={isAdminAuthenticated}
                                        className="text-lg text-gray-300"
                                    />
                                </li>
                                <li>
                                    <EditableText
                                        tag="span"
                                        contentKey="showcaseCar.turbo"
                                        isAdminAuthenticated={isAdminAuthenticated}
                                        className="text-lg text-gray-300"
                                    />
                                </li>
                                <li>
                                    <EditableText
                                        tag="span"
                                        contentKey="showcaseCar.wastegate"
                                        isAdminAuthenticated={isAdminAuthenticated}
                                        className="text-lg text-gray-300"
                                    />
                                </li>
                                <li>
                                    <EditableText
                                        tag="span"
                                        contentKey="showcaseCar.injecteurs"
                                        isAdminAuthenticated={isAdminAuthenticated}
                                        className="text-lg text-gray-300"
                                    />
                                </li>
                                <li>
                                    <EditableText
                                        tag="span"
                                        contentKey="showcaseCar.pipAdmission"
                                        isAdminAuthenticated={isAdminAuthenticated}
                                        className="text-lg text-gray-300"
                                    />
                                </li>
                                <li>
                                    <EditableText
                                        tag="span"
                                        contentKey="showcaseCar.wmi"
                                        isAdminAuthenticated={isAdminAuthenticated}
                                        className="text-lg text-gray-300"
                                    />
                                </li>
                                <li>
                                    <EditableText
                                        tag="span"
                                        contentKey="showcaseCar.embrayage"
                                        isAdminAuthenticated={isAdminAuthenticated}
                                        className="text-lg text-gray-300"
                                    />
                                </li>
                            </ul>

                            <EditableText
                                tag="p"
                                contentKey="showcaseCar.finalDescription"
                                isAdminAuthenticated={isAdminAuthenticated}
                                className="text-lg text-gray-300 leading-relaxed"
                            />
                        </div>
                    </div>
                    {isLightboxOpen && (
                        <Lightbox
                            images={lightboxImages}
                            currentIndex={currentLightboxImageIndex}
                            onClose={closeLightbox}
                            onNavigate={navigateLightbox}
                        />
                    )}
                </div>
            );
        };

        // Composant de la page de connexion administrateur
        const AdminLoginPage = ({ setIsAdminAuthenticated, setCurrentPage }) => {
            const [password, setPassword] = useState('');
            const [error, setError] = useState('');

            // Mot de passe pour l'administrateur. ATTENTION: Ce n'est PAS sécurisé pour une production !
            // Pour une production, ce mot de passe ne devrait pas être dans le code client.
            // Il serait envoyé à un backend pour vérification.
            const ADMIN_PASSWORD_FRONTEND = 'Remy03200!';

            const handleSubmit = (e) => {
                e.preventDefault();
                if (password === ADMIN_PASSWORD_FRONTEND) {
                    setIsAdminAuthenticated(true);
                    localStorage.setItem('isAdminAuthenticated', 'true'); // Stocke l'état d'authentification
                    setCurrentPage('admin-panel'); // Redirige vers le panneau admin
                } else {
                    setError('Mot de passe incorrect.');
                }
            };

            return (
                <div className="min-h-screen bg-gradient-to-br from-gray-900 to-black text-white pt-40 pb-12 font-inter flex items-center justify-center">
                    <div className="bg-gray-800 p-8 rounded-2xl shadow-xl border border-gray-700 w-full max-w-md animate-fade-in-up">
                        <h1 className="text-3xl sm:text-4xl font-extrabold text-center mb-4 text-orange-400">Accès Administrateur</h1> {/* Ajusté pour mobile */}
                        {/* Nouvelle phrase ajoutée ici */}
                        <p className="text-center text-sm text-gray-400 mb-6 italic">Giovanni te souhaite la bienvenue et un bon courage !</p>
                        <form onSubmit={handleSubmit} className="space-y-6">
                            <InputField
                                label="Mot de passe"
                                type="password"
                                placeholder="Entrez votre mot de passe"
                                required={true}
                                value={password}
                                onChange={(e) => { setPassword(e.target.value); setError(''); }}
                                name="adminPassword"
                            />
                            {error && <p className="text-red-500 text-sm text-center">{error}</p>}
                            <button
                                type="submit"
                                className="w-full bg-orange-600 hover:bg-orange-700 text-white font-bold py-3 px-4 rounded-lg shadow-md transition duration-300 ease-in-out transform hover:scale-105 active:scale-95"
                            >
                                Se connecter
                            </button>
                        </form>
                    </div>
                </div>
            );
        };

        // Composant réutilisable pour la gestion d'un tableau d'images (ajout, suppression, aperçu)
        const AdminImageArrayEditor = ({ label, imagesArray, onAddImage, onRemoveImage }) => {
            const [newImageUrl, setNewImageUrl] = useState('');
            const [currentPreviewImageIndex, setCurrentPreviewImageIndex] = useState(0);
            const [isPlaying, setIsPlaying] = useState(true);
            const [zoom, setZoom] = useState(1);
            const [offsetX, setOffsetX] = useState(0);
            const [offsetY, setOffsetY] = useState(0);
            const [isPanDragging, setIsPanDragging] = useState(false);
            const [startX, setStartX] = useState(0);
            const [startY, setStartY] = useState(0);

            // Reset zoom/pan when the image changes
            useEffect(() => {
                resetImage();
            }, [currentPreviewImageIndex]);

            // Autoplay for the carousel preview
            useEffect(() => {
                let interval;
                if (isPlaying && imagesArray && imagesArray.length > 1) {
                    interval = setInterval(() => {
                        setCurrentPreviewImageIndex((prevIndex) =>
                            (prevIndex + 1) % imagesArray.length
                        );
                    }, 3000);
                }
                return () => clearInterval(interval);
            }, [isPlaying, imagesArray]);

            // Réinitialise le zoom et la position
            const resetImage = () => {
                setZoom(1);
                setOffsetX(0);
                setOffsetY(0);
            };

            // Centre l'image (réinitialise seulement la position, pas le zoom)
            const centerImage = () => {
                setOffsetX(0);
                setOffsetY(0);
            };

            // Gère le zoom
            const handleZoom = (factor) => {
                setZoom(prevZoom => Math.max(0.5, prevZoom + factor));
            };

            // Gère le début du glisser-déposer (pan)
            const handlePanStart = (e) => {
                if (zoom <= 1) return;
                e.preventDefault();
                setIsPanDragging(true);
                setStartX(e.clientX - offsetX);
                setStartY(e.clientY - offsetY);
            };

            // Gère le glisser-déposer (pan)
            const handlePanMove = (e) => {
                if (!isPanDragging) return;
                setOffsetX(e.clientX - startX);
                setOffsetY(e.clientY - startY);
            };

            // Gère la fin du glisser-déposer (pan)
            const handlePanEnd = () => {
                setIsPanDragging(false);
            };

            const goToPreviousImage = () => {
                if (!imagesArray || imagesArray.length === 0) return;
                setCurrentPreviewImageIndex((prevIndex) =>
                    prevIndex === 0 ? imagesArray.length - 1 : prevIndex - 1
                );
                setIsPlaying(false);
            };

            const goToNextImage = () => {
                if (!imagesArray || imagesArray.length === 0) return;
                setCurrentPreviewImageIndex((prevIndex) =>
                    (prevIndex + 1) % imagesArray.length
                );
                setIsPlaying(false);
            };

            const togglePreviewPlayPause = () => {
                setIsPlaying(!isPlaying);
            };

            const displayImage = imagesArray && imagesArray.length > 0 ? imagesArray[currentPreviewImageIndex] : "https://placehold.co/600x400/000/FFF?text=Image+non+trouvée";

            const handleFileSelect = (e) => {
                const file = e.target.files[0];
                if (file) {
                    // Simuler l'upload: dans une vraie application, vous enverriez ce fichier à un serveur
                    // et le serveur vous retournerait l'URL de l'image stockée.
                    // Ici, nous utilisons une URL de placeholder pour la démonstration.
                    const simulatedImageUrl = `https://placehold.co/600x400/FFF/000?text=${encodeURIComponent(file.name)}`;
                    onAddImage(simulatedImageUrl);
                    setNewImageUrl(''); // Clear input after "upload"
                    e.target.value = ''; // Clear file input
                }
            };

            return (
                <div className="mt-4 border-t border-gray-500 pt-4">
                    <label className="block text-gray-300 text-sm font-bold mb-2">{label}:</label>
                    <div className="flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-2 mb-2">
                        {/* Simuler l'upload via un champ fichier */}
                        <input
                            type="file"
                            accept="image/*"
                            onChange={handleFileSelect}
                            className="flex-grow p-2 rounded bg-gray-500 text-white border border-gray-400 focus:ring-blue-500 focus:border-blue-500 cursor-pointer text-sm"
                        />
                        {/* Option pour ajouter une URL manuellement */}
                        <input
                            type="text"
                            placeholder="Ou collez une URL d'image existante"
                            value={newImageUrl}
                            onChange={(e) => setNewImageUrl(e.target.value)}
                            className="flex-grow p-2 rounded bg-gray-500 text-white border border-gray-400 focus:ring-blue-500 focus:border-blue-500"
                        />
                        <button
                            onClick={() => {
                                if (newImageUrl.trim()) {
                                    onAddImage(newImageUrl.trim());
                                    setNewImageUrl('');
                                }
                            }}
                            className="bg-blue-500 hover:bg-blue-600 text-white p-2 rounded-lg text-sm transition-all duration-200 flex-shrink-0"
                        >
                            Ajouter URL
                        </button>
                    </div>
                    <p className="text-gray-400 text-xs mt-1 mb-2">
                        Pour un véritable upload, un backend est nécessaire. Ici, l'upload simule l'ajout d'un nom de fichier (ou une URL).
                    </p>
                    <ul className="space-y-2 max-h-40 overflow-y-auto pr-2">
                        {imagesArray && imagesArray.map((imgUrl, imgIdx) => (
                            <li key={imgIdx} className="flex items-center justify-between bg-gray-700 p-2 rounded">
                                <span className="text-gray-300 text-sm truncate mr-2">{imgUrl}</span>
                                <button
                                    onClick={() => onRemoveImage(imgIdx)}
                                    className="bg-red-500 hover:bg-red-600 text-white p-1 rounded-full text-xs"
                                    aria-label={`Supprimer l'image ${imgUrl}`}
                                >
                                    <XIcon className="w-3 h-3"/>
                                </button>
                            </li>
                        ))}
                        {(!imagesArray || imagesArray.length === 0) && (
                            <p className="text-gray-400 text-sm italic">Aucune image ajoutée.</p>
                        )}
                    </ul>

                    {/* Aperçu de l'image (carrousel avec zoom/pan) */}
                    <div className="mt-4 border-t border-gray-500 pt-4">
                        <label className="block text-gray-300 text-sm font-bold mb-2">Aperçu de l'image:</label>
                        <div className="relative w-full h-48 bg-gray-700 flex items-center justify-center overflow-hidden rounded-lg border-2 border-gray-400">
                            {imagesArray && imagesArray.length > 0 ? (
                                <>
                                    <img
                                        src={displayImage}
                                        alt="Aperçu de l'image"
                                        className="object-contain max-w-full max-h-full transition-transform duration-100 ease-out"
                                        style={{
                                            transform: `scale(${zoom}) translate(${offsetX}px, ${offsetY}px)`,
                                            cursor: zoom > 1 ? (isPanDragging ? 'grabbing' : 'grab') : 'default',
                                        }}
                                        onMouseDown={handlePanStart}
                                        onMouseMove={handlePanMove}
                                        onMouseUp={handlePanEnd}
                                        onMouseLeave={handlePanEnd}
                                        onError={(e) => { e.target.onerror = null; e.target.src=`https://placehold.co/600x400/000/FFF?text=Image+non+trouvée`; }}
                                    />
                                    {imagesArray.length > 1 && (
                                        <>
                                            <button
                                                onClick={goToPreviousImage}
                                                className="absolute left-2 top-1/2 -translate-y-1/2 bg-black bg-opacity-50 text-white p-2 rounded-full hover:bg-opacity-80 transition duration-300 focus:outline-none"
                                                aria-label="Image précédente"
                                            ><ArrowLeftIcon className="w-5 h-5"/></button>
                                            <button
                                                onClick={goToNextImage}
                                                className="absolute right-2 top-1/2 -translate-y-1/2 bg-black bg-opacity-50 text-white p-2 rounded-full hover:bg-opacity-80 transition duration-300 focus:outline-none"
                                                aria-label="Image suivante"
                                            ><ArrowRightIcon className="w-5 h-5"/></button>
                                            <button
                                                onClick={togglePreviewPlayPause}
                                                className="absolute bottom-2 left-1/2 -translate-x-1/2 bg-black bg-opacity-50 text-white p-2 rounded-full hover:bg-opacity-80 transition duration-300 focus:outline-none"
                                                aria-label={isPlaying ? "Mettre en pause le diaporama" : "Lancer le diaporama"}
                                            >
                                                {isPlaying ? <PauseIcon className="w-5 h-5"/> : <PlayIcon className="w-5 h-5"/>}
                                            </button>
                                            <div className="absolute bottom-2 right-2 bg-black bg-opacity-70 text-white text-xs px-2 py-1 rounded">
                                                {currentPreviewImageIndex + 1} / {imagesArray.length}
                                            </div>
                                        </>
                                    )}
                                </>
                            ) : (
                                <p className="text-gray-400">Pas d'image à prévisualiser.</p>
                            )}
                            {zoom > 1 && (
                                <div className="absolute top-2 left-2 bg-black bg-opacity-70 text-white text-xs px-2 py-1 rounded">
                                    Zoom: {Math.round(zoom * 100)}%
                                </div>
                            )}
                        </div>
                        <div className="flex justify-center space-x-2 mt-3">
                            <button
                                onClick={() => handleZoom(0.1)}
                                className="bg-blue-500 hover:bg-blue-600 text-white p-2 rounded-full text-sm flex items-center justify-center transition-all duration-200"
                                title="Zoomer"
                            ><PlusIcon className="w-4 h-4"/></button>
                            <button
                                onClick={() => handleZoom(-0.1)}
                                className="bg-blue-500 hover:bg-blue-600 text-white p-2 rounded-full text-sm flex items-center justify-center transition-all duration-200"
                                title="Dézoomer"
                            ><MinusIcon className="w-4 h-4"/></button>
                            <button
                                onClick={centerImage}
                                className="bg-purple-500 hover:bg-purple-600 text-white p-2 rounded-full text-sm flex items-center justify-center transition-all duration-200"
                                title="Centrer l'image"
                            ><TargetIcon className="w-4 h-4"/></button>
                            <button
                                onClick={resetImage}
                                className="bg-red-500 hover:bg-red-600 text-white p-2 rounded-full text-sm flex items-center justify-center transition-all duration-200"
                                title="Réinitialiser le zoom et la position"
                            ><RotateCcwIcon className="w-4 h-4"/></button>
                        </div>
                    </div>
                </div>
            );
        };

        // Composant d'édition d'article de blog pour le panneau d'administration
        const AdminBlogPostCard = ({ post, index, handleLocalChange, handleRemoveBlogPost, handleDragStart, handleDragEnd, handleDragOver, handleDrop }) => {
            const [isDraggingOver, setIsDraggingOver] = useState(false);

            // Fonctions pour le glisser-déposer de la carte d'article
            const onDragEnter = (e) => {
                e.preventDefault();
                setIsDraggingOver(true);
            };

            const onDragLeave = () => {
                setIsDraggingOver(false);
            };

            // Fonctions d'ajout et de suppression d'images spécifiques à cet article
            const handleAddImage = (imageUrl) => {
                handleLocalChange('blog', `posts.${index}.images`, [...(post.images || []), imageUrl]);
            };

            const handleRemoveImage = (imageIdx) => {
                const newImages = (post.images || []).filter((_, idx) => idx !== imageIdx);
                handleLocalChange('blog', `posts.${index}.images`, newImages);
            };

            return (
                <div
                    draggable="true"
                    onDragStart={(e) => handleDragStart(e, index)}
                    onDragEnd={handleDragEnd}
                    onDragOver={handleDragOver}
                    onDrop={(e) => handleDrop(e, index)}
                    onDragEnter={onDragEnter}
                    onDragLeave={onDragLeave}
                    className={`p-5 bg-gray-600 rounded-lg shadow-md border border-gray-500 relative cursor-grab ${isDraggingOver ? 'border-blue-400 scale-102' : ''} transition-all duration-200 ease-in-out`}
                >
                    <h4 className="text-xl font-semibold mb-3 text-white">Article #{index + 1}</h4>
                    <button
                        onClick={() => handleRemoveBlogPost(post.id)}
                        className="absolute top-3 right-3 bg-red-500 hover:bg-red-600 text-white p-2 rounded-full text-sm"
                        aria-label="Supprimer l'article"
                    >
                        <XIcon className="w-4 h-4"/>
                    </button>
                    <div className="space-y-4">
                        <div>
                            <label className="block text-gray-300 text-sm font-bold mb-2">Titre de l'article:</label>
                            <input
                                type="text"
                                value={post.title || ''}
                                onChange={(e) => handleLocalChange('blog', `posts.${index}.title`, e.target.value)}
                                className="w-full p-2 rounded bg-gray-500 text-white border border-gray-400 focus:ring-green-500 focus:border-green-500"
                            />
                        </div>
                        <div>
                            <label className="block text-gray-300 text-sm font-bold mb-2">Description de l'article:</label>
                            <textarea
                                value={post.description || ''}
                                onChange={(e) => handleLocalChange('blog', `posts.${index}.description`, e.target.value)}
                                rows={Math.max(3, (post.description || '').split('\n').length)}
                                className="w-full p-2 rounded bg-gray-500 text-white border border-gray-400 focus:ring-green-500 focus:border-green-500 resize-y"
                            />
                        </div>
                        {/* Utilisation du composant AdminImageArrayEditor pour les images du blog */}
                        <AdminImageArrayEditor
                            label="Gérer les images du blog"
                            imagesArray={post.images}
                            onAddImage={handleAddImage}
                            onRemoveImage={handleRemoveImage}
                        />
                    </div>
                </div>
            );
        };


        // Composant du panneau administrateur (contenu protégé)
        const AdminPanelPage = ({ setIsAdminAuthenticated, setCurrentPage }) => {
            const { content, updateContent } = useContext(ContentContext);
            const [localContent, setLocalContent] = useState(() => JSON.parse(JSON.stringify(content || {})));
            const [saveMessage, setSaveMessage] = useState('');
            const [isSaving, setIsSaving] = useState(false);
            const [activeTab, setActiveTab] = useState('home'); // Nouvelle gestion des onglets
            const [draggedIndex, setDraggedIndex] = useState(null); // État pour l'index de l'élément glissé

            useEffect(() => {
                setLocalContent(JSON.parse(JSON.stringify(content || {})));
                console.log("AdminPanelPage: Content state updated. localContent initialized:", JSON.parse(JSON.stringify(content || {})));
            }, [content]);

            const handleLocalChange = (pageKey, fieldKey, newValue) => {
                // console.log(`handleLocalChange: Attempting to update pageKey: "${pageKey}", fieldKey: "${fieldKey}", with newValue: "${newValue}"`);
                setLocalContent(prevContent => {
                    const newContent = JSON.parse(JSON.stringify(prevContent));
                    const targetPage = newContent[pageKey];

                    if (!targetPage) {
                        console.error(`handleLocalChange: Page key "${pageKey}" not found in localContent.`);
                        return prevContent;
                    }

                    setNestedProperty(targetPage, fieldKey, newValue);
                    // console.log(`handleLocalChange: Local change applied. New localContent:`, newContent);
                    return newContent;
                });
            };

            const handleAddBlogPost = () => {
                setLocalContent(prevContent => {
                    const newContent = JSON.parse(JSON.stringify(prevContent));
                    if (!newContent.blog || !Array.isArray(newContent.blog.posts)) {
                        newContent.blog = { ...newContent.blog, posts: [] };
                    }
                    newContent.blog.posts.push({
                        id: Date.now(), // Utiliser un timestamp unique pour l'ID
                        images: ["https://placehold.co/600x400/000/FFF?text=Nouvelle+image"], // Initialise avec une image par défaut
                        title: "Nouveau titre d'article",
                        description: "Nouvelle description d'article."
                    });
                    return newContent;
                });
            };

            const handleRemoveBlogPost = (idToRemove) => {
                setLocalContent(prevContent => {
                    const newContent = JSON.parse(JSON.stringify(prevContent));
                    if (newContent.blog && Array.isArray(newContent.blog.posts)) {
                        newContent.blog.posts = newContent.blog.posts.filter(post => post.id !== idToRemove);
                    }
                    return newContent;
                });
            };

            // Fonctions pour le glisser-déposer des articles de blog
            const handleDragStart = (e, index) => {
                setDraggedIndex(index);
                e.dataTransfer.effectAllowed = 'move';
                e.currentTarget.classList.add('opacity-50', 'border-dashed', 'border-4', 'border-blue-400'); // Feedback visuel
            };

            const handleDragEnd = (e) => {
                e.currentTarget.classList.remove('opacity-50', 'border-dashed', 'border-4', 'border-blue-400');
                setDraggedIndex(null);
            };

            const handleDragOver = (e) => {
                e.preventDefault(); // Nécessaire pour permettre le drop
                e.dataTransfer.dropEffect = 'move';
            };

            const handleDrop = (e, targetIndex) => {
                e.preventDefault();
                if (draggedIndex === null || draggedIndex === targetIndex) {
                    return;
                }

                setLocalContent(prevContent => {
                    const newContent = JSON.parse(JSON.stringify(prevContent));
                    const newPosts = [...newContent.blog.posts];
                    
                    const [reorderedItem] = newPosts.splice(draggedIndex, 1);
                    newPosts.splice(targetIndex, 0, reorderedItem);

                    return {
                        ...newContent,
                        blog: {
                            ...newContent.blog,
                            posts: newPosts
                        }
                    };
                });
                setDraggedIndex(null); // Réinitialiser l'index de l'élément glissé
            };

            // Fonctions de gestion des images pour la voiture vitrine
            const handleAddShowcaseImage = (imageUrl) => {
                setLocalContent(prevContent => {
                    const newContent = JSON.parse(JSON.stringify(prevContent));
                    if (!newContent.showcaseCar) newContent.showcaseCar = {};
                    if (!newContent.showcaseCar.images) newContent.showcaseCar.images = [];
                    newContent.showcaseCar.images.push(imageUrl);
                    return newContent;
                });
            };

            const handleRemoveShowcaseImage = (imageIndex) => {
                setLocalContent(prevContent => {
                    const newContent = JSON.parse(JSON.stringify(prevContent));
                    if (newContent.showcaseCar && Array.isArray(newContent.showcaseCar.images)) {
                        newContent.showcaseCar.images.splice(imageIndex, 1);
                    }
                    return newContent;
                });
            };

            const handleSaveChanges = async () => {
                setIsSaving(true);
                setSaveMessage('Sauvegarde en cours...');
                console.log("AdminPanelPage: Initiating save. Sending content:", JSON.parse(JSON.stringify(localContent)));

                try {
                    const response = await fetch('http://localhost:3001/api/save-content', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'Authorization': `Bearer Remy03200!`
                        },
                        body: JSON.stringify(localContent)
                    });

                    const data = await response.json();
                    if (response.ok) {
                        setSaveMessage(`Modifications sauvegardées avec succès sur GitHub ! ${data.commitUrl ? `Voir le commit: ${data.commitUrl}` : ''}`);
                        console.log("AdminPanelPage: Save successful. Response from backend:", data);
                        // Mettre à jour le contenu global après une sauvegarde réussie
                        updateContent('home', localContent.home);
                        updateContent('blog', localContent.blog);
                        updateContent('aboutUs', localContent.aboutUs);
                        updateContent('contact', localContent.contact);
                        updateContent('legalMentions', localContent.legalMentions);
                        updateContent('privacyPolicy', localContent.privacyPolicy);
                        updateContent('showcaseCar', localContent.showcaseCar);
                        updateContent('siteSettings', localContent.siteSettings);

                        console.log("AdminPanelPage: Global content update triggered.");
                    } else {
                        setSaveMessage(`Erreur de sauvegarde : ${data.message || 'Problème serveur'}`);
                        console.error('AdminPanelPage: Erreur backend:', data);
                    }
                } catch (error) {
                    console.error('AdminPanelPage: Erreur réseau lors de la sauvegarde:', error);
                    setSaveMessage(`Erreur réseau. Impossible de contacter le serveur backend. Assurez-vous qu'il est en ligne et accessible (${error.message}).`);
                } finally {
                    setIsSaving(false);
                    setTimeout(() => setSaveMessage(''), 10000);
                }
            };

            const handleLogout = () => {
                setIsAdminAuthenticated(false);
                localStorage.removeItem('isAdminAuthenticated');
                setCurrentPage('accueil');
            };

            // Fonction utilitaire pour générer les champs éditables
            const renderEditableFields = (pageData, pageKey) => {
                // Ensure pageData is an object before mapping
                if (!pageData || typeof pageData !== 'object') {
                    console.warn(`renderEditableFields received invalid pageData for key: ${pageKey}`, pageData);
                    return null;
                }

                return Object.keys(pageData).map(fieldKey => {
                    const fieldValue = pageData[fieldKey];
                    const contentPath = `${pageKey}.${fieldKey}`;

                    // Exclure les tableaux d'images qui seront gérés par AdminImageArrayEditor
                    if ((pageKey === 'blog' && fieldKey === 'posts') || (pageKey === 'showcaseCar' && fieldKey === 'images')) {
                        return null;
                    }

                     if (typeof fieldValue === 'object' && fieldValue !== null && !Array.isArray(fieldValue)) {
                        // If it's a nested object that's not an array, render its fields recursively
                        return (
                            <div key={contentPath} className="pb-4 border-b border-gray-600 last:border-b-0">
                                <h4 className="text-xl font-semibold mb-3 text-white capitalize">{fieldKey.replace(/([A-Z])/g, ' $1').trim()}:</h4>
                                {renderEditableFields(fieldValue, contentPath)}
                            </div>
                        );
                    }
                    // Handle specific types like numbers for volume
                    if (fieldKey === 'musicVolume' && typeof fieldValue === 'number') {
                        return (
                            <div key={contentPath} className="pb-4 border-b border-gray-600 last:border-b-0">
                                <label className="block text-gray-300 text-sm font-bold mb-2">
                                    Volume de la musique: ({Math.round(fieldValue * 100)}%)
                                </label>
                                <input
                                    type="range"
                                    min="0"
                                    max="1"
                                    step="0.01"
                                    value={fieldValue}
                                    onChange={(e) => handleLocalChange(pageKey, fieldKey, parseFloat(e.target.value))}
                                    className="w-full h-2 bg-gray-500 rounded-lg appearance-none cursor-pointer range-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                                />
                            </div>
                        );
                    }

                    const valueToDisplay = typeof fieldValue === 'string' ? fieldValue : '';
                    const inputType = (fieldKey.includes('Title') || fieldKey.includes('email') || fieldKey.includes('phone') || fieldKey.includes('instagram') || fieldKey.includes('Handle')) ? 'text' : 'textarea';
                    const rows = (inputType === 'textarea' && typeof valueToDisplay === 'string') ? Math.max(3, valueToDisplay.split('\n').length) : undefined;

                    return (
                        <div key={contentPath} className="pb-4 border-b border-gray-600 last:border-b-0">
                            <label className="block text-gray-300 text-sm font-bold mb-2">
                                {fieldKey.replace(/([A-Z])/g, ' $1').replace(/([0-9])/g, ' $1').trim()}:
                            </label>
                            {inputType === 'text' ? (
                                <input
                                    type="text"
                                    value={valueToDisplay}
                                    onChange={(e) => handleLocalChange(pageKey, fieldKey, e.target.value)}
                                    className="w-full p-2 rounded bg-gray-600 text-white border border-gray-500 focus:ring-blue-500 focus:border-blue-500"
                                />
                            ) : (
                                <textarea
                                    value={valueToDisplay}
                                    onChange={(e) => handleLocalChange(pageKey, fieldKey, e.target.value)}
                                    rows={rows}
                                    className="w-full p-2 rounded bg-gray-600 text-white border border-gray-500 focus:ring-blue-500 focus:border-blue-500 resize-y"
                                />
                            )}
                            {typeof fieldValue !== 'string' && typeof fieldValue !== 'number' && (
                                <p className="text-red-400 text-xs mt-1">
                                    Ce champ ({contentPath}) n'est pas une chaîne de caractères ou un nombre, ou est manquant.
                                </p>
                            )}
                        </div>
                    );
                });
            };

            const pageTabs = [
                { key: 'home', label: 'Accueil' },
                { key: 'blog', label: 'Blog' },
                { key: 'aboutUs', label: 'Qui sommes-nous' },
                { key: 'contact', label: 'Contact' },
                { key: 'legalMentions', label: 'Mentions Légales' },
                { key: 'privacyPolicy', label: 'Politique de Confidentialité' },
                { key: 'showcaseCar', label: 'Voiture Vitrine' },
                { key: 'siteSettings', label: 'Paramètres du Site' }
            ];

            return (
                <div className="min-h-screen bg-gradient-to-br from-gray-900 to-black text-white pt-40 pb-12 font-inter">
                    <div className="container mx-auto px-6 max-w-6xl">
                        <h1 className="text-4xl sm:text-5xl font-extrabold text-center mb-12 text-orange-400 animate-fade-in-down animate-vibrate"> {/* Ajusté pour mobile */}
                            Panneau d'Administration
                        </h1>
                        <p className="text-xl text-center text-gray-300 max-w-3xl mx-auto mb-10 animate-fade-in-up">
                            Bienvenue, administrateur. Ici, vous pouvez gérer le contenu du site.
                        </p>

                        <div className="bg-gray-800 p-8 rounded-2xl shadow-xl border border-gray-700 animate-fade-in-up space-y-8">
                            {/* Navigation par onglets */}
                            <div className="flex flex-wrap justify-center gap-4 mb-8 border-b border-gray-700 pb-4">
                                {pageTabs.map(tab => (
                                    <button
                                        key={tab.key}
                                        onClick={() => setActiveTab(tab.key)}
                                        className={`px-6 py-3 rounded-lg font-semibold transition duration-300 ease-in-out
                                                    ${activeTab === tab.key
                                                        ? 'bg-blue-600 text-white shadow-lg transform scale-105'
                                                        : 'bg-gray-700 text-gray-300 hover:bg-gray-600 hover:text-white'
                                                    }`}
                                    >
                                        {tab.label}
                                    </button>
                                ))}
                            </div>

                            {/* Contenu des onglets */}
                            {localContent && (
                                <div className="space-y-8">
                                    {/* Section Accueil */}
                                    {activeTab === 'home' && (
                                        <div className="p-6 bg-gray-700 rounded-xl shadow-inner border border-gray-600">
                                            <h2 className="text-3xl font-bold mb-6 text-blue-400 capitalize border-b-2 border-blue-600 pb-3">
                                                Page Accueil
                                            </h2>
                                            <div className="space-y-6">
                                                {renderEditableFields(localContent.home, 'home')}
                                                {localContent.home.offerTitle && (
                                                    <div className="mt-8 pt-6 border-t-2 border-red-600">
                                                        <h3 className="text-xl sm:text-2xl font-bold mb-4 text-red-300">Nos Offres</h3>
                                                        {renderEditableFields({
                                                            offer1Title: localContent.home.offer1Title,
                                                            offer1Description: localContent.home.offer1Description,
                                                            offer2Title: localContent.home.offer2Title,
                                                            offer2Description: localContent.home.offer2Description,
                                                            offer3Title: localContent.home.offer3Title,
                                                            offer3Description: localContent.home.offer3Description,
                                                            offer4Title: localContent.home.offer4Title,
                                                            offer4Description: localContent.home.offer4Description,
                                                        }, 'home')}
                                                    </div>
                                                )}
                                                {localContent.home.trustTitle && (
                                                    <div className="mt-8 pt-6 border-t-2 border-blue-600">
                                                        <h3 className="text-xl sm:text-2xl font-bold mb-4 text-blue-300">Pourquoi nous faire confiance</h3>
                                                        {renderEditableFields({
                                                            trust1Title: localContent.home.trust1Title,
                                                            trust1Description: localContent.home.trust1Description,
                                                            trust2Title: localContent.home.trust2Title,
                                                            trust2Description: localContent.home.trust2Description,
                                                            trust3Title: localContent.home.trust3Title,
                                                            trust3Description: localContent.home.trust3Description,
                                                            trust4Title: localContent.home.trust4Title,
                                                            trust4Description: localContent.home.trust4Description,
                                                        }, 'home')}
                                                    </div>
                                                )}
                                            </div>
                                        </div>
                                    )}

                                    {/* Section Blog */}
                                    {activeTab === 'blog' && (
                                        <div className="p-6 bg-gray-700 rounded-xl shadow-inner border border-gray-600">
                                            <h2 className="text-3xl font-bold mb-6 text-green-400 capitalize border-b-2 border-green-600 pb-3">
                                                Page Blog
                                            </h2>
                                            <div className="space-y-6">
                                                {renderEditableFields({
                                                    mainTitle: localContent.blog.mainTitle,
                                                    description: localContent.blog.description,
                                                }, 'blog')}
                                                <div className="mt-8 pt-6 border-t-2 border-green-600">
                                                    <h3 className="text-2xl font-bold mb-4 text-green-300">Articles de Blog</h3>
                                                    <button
                                                        onClick={handleAddBlogPost}
                                                        className="bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded-lg shadow-md transition duration-300 ease-in-out transform hover:scale-105 active:scale-95 mb-6"
                                                    >
                                                        Ajouter un nouvel article
                                                    </button>
                                                    <div className="space-y-8 mt-4">
                                                        {localContent.blog.posts && localContent.blog.posts.map((post, index) => (
                                                            <AdminBlogPostCard
                                                                key={post.id || `blog-edit-${index}`}
                                                                post={post}
                                                                index={index}
                                                                handleLocalChange={handleLocalChange}
                                                                handleRemoveBlogPost={handleRemoveBlogPost}
                                                                handleDragStart={handleDragStart}
                                                                handleDragEnd={handleDragEnd}
                                                                handleDragOver={handleDragOver}
                                                                handleDrop={handleDrop}
                                                            />
                                                        ))}
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    )}

                                    {/* Section Qui sommes-nous */}
                                    {activeTab === 'aboutUs' && (
                                        <div className="p-6 bg-gray-700 rounded-xl shadow-inner border border-gray-600">
                                            <h2 className="text-3xl font-bold mb-6 text-yellow-400 capitalize border-b-2 border-yellow-600 pb-3">
                                                Page Qui sommes-nous
                                            </h2>
                                            <div className="space-y-6">
                                                {renderEditableFields(localContent.aboutUs, 'aboutUs')}
                                                {localContent.aboutUs.historyTitle && (
                                                    <div className="mt-8 pt-6 border-t-2 border-yellow-600">
                                                        <h3 className="text-xl sm:text-2xl font-bold mb-4 text-yellow-300">Notre Histoire</h3>
                                                        {renderEditableFields({
                                                            historyTitle: localContent.aboutUs.historyTitle,
                                                            historyParagraph1: localContent.aboutUs.historyParagraph1,
                                                            historyParagraph2: localContent.aboutUs.historyParagraph2,
                                                        }, 'aboutUs')}
                                                    </div>
                                                )}
                                                {localContent.aboutUs.valuesTitle && (
                                                    <div className="mt-8 pt-6 border-t-2 border-yellow-600">
                                                        <h3 className="text-xl sm:text-2xl font-bold mb-4 text-yellow-300">Nos Valeurs</h3>
                                                        {renderEditableFields({
                                                            value1Title: localContent.aboutUs.value1Title,
                                                            value1Description: localContent.aboutUs.value1Description,
                                                            value2Title: localContent.aboutUs.value2Title,
                                                            value2Description: localContent.aboutUs.value2Description,
                                                            value3Title: localContent.aboutUs.value3Title,
                                                            value3Description: localContent.aboutUs.value3Description,
                                                            value4Title: localContent.aboutUs.value4Title,
                                                            value4Description: localContent.aboutUs.value4Description,
                                                        }, 'aboutUs')}
                                                    </div>
                                                )}
                                            </div>
                                        </div>
                                    )}

                                    {/* Section Contact */}
                                    {activeTab === 'contact' && (
                                        <div className="p-6 bg-gray-700 rounded-xl shadow-inner border border-gray-600">
                                            <h2 className="text-3xl font-bold mb-6 text-pink-400 capitalize border-b-2 border-pink-600 pb-3">
                                                Page Contact
                                            </h2>
                                            <React.Fragment>
                                                {renderEditableFields(localContent.contact, 'contact')}
                                            </React.Fragment>
                                        </div>
                                    )}

                                    {/* Section Mentions Légales */}
                                    {activeTab === 'legalMentions' && (
                                        <div className="p-6 bg-gray-700 rounded-xl shadow-inner border border-gray-600">
                                            <h2 className="text-3xl font-bold mb-6 text-teal-400 capitalize border-b-2 border-teal-600 pb-3">
                                                Page Mentions Légales
                                            </h2>
                                            <div className="space-y-6">
                                                {renderEditableFields(localContent.legalMentions, 'legalMentions')}
                                                {localContent.legalMentions.list1Item1 && (
                                                    <div className="mt-8 pt-6 border-t-2 border-teal-600">
                                                        <h3 className="text-xl sm:text-2xl font-bold mb-4 text-teal-300">Liste 1</h3>
                                                        {renderEditableFields({
                                                            list1Item1: localContent.legalMentions.list1Item1,
                                                            list1Item2: localContent.legalMentions.list1Item2,
                                                            list1Item3: localContent.legalMentions.list1Item3,
                                                        }, 'legalMentions')}
                                                    </div>
                                                )}
                                                {localContent.legalMentions.list2Item1 && (
                                                    <div className="mt-8 pt-6 border-t-2 border-teal-600">
                                                        <h3 className="text-xl sm:text-2xl font-bold mb-4 text-teal-300">Liste 2</h3>
                                                        {renderEditableFields({
                                                            list2Item1: localContent.legalMentions.list2Item1,
                                                            list2Item2: localContent.legalMentions.list2Item2,
                                                            list2Item3: localContent.legalMentions.list2Item3,
                                                        }, 'legalMentions')}
                                                    </div>
                                                )}
                                            </div>
                                        </div>
                                    )}

                                    {/* Section Politique de Confidentialité */}
                                    {activeTab === 'privacyPolicy' && (
                                        <div className="p-6 bg-gray-700 rounded-xl shadow-inner border border-gray-600">
                                            <h2 className="text-3xl font-bold mb-6 text-purple-400 capitalize border-b-2 border-purple-600 pb-3">
                                                Page Politique de Confidentialité
                                            </h2>
                                            <div className="space-y-6">
                                                {renderEditableFields(localContent.privacyPolicy, 'privacyPolicy')}
                                                {localContent.privacyPolicy.usageListItem1 && (
                                                    <div className="mt-8 pt-6 border-t-2 border-purple-600">
                                                        <h3 className="text-xl sm:text-2xl font-bold mb-4 text-purple-300">Utilisation des informations</h3>
                                                        {renderEditableFields({
                                                            usageListItem1: localContent.privacyPolicy.usageListItem1,
                                                            usageListItem2: localContent.privacyPolicy.usageListItem2,
                                                            usageListItem3: localContent.privacyPolicy.usageListItem3,
                                                        }, 'privacyPolicy')}
                                                    </div>
                                                )}
                                            </div>
                                        </div>
                                    )}

                                    {/* Section Voiture Vitrine */}
                                    {activeTab === 'showcaseCar' && (
                                        <div className="p-6 bg-gray-700 rounded-xl shadow-inner border border-gray-600">
                                            <h2 className="text-3xl font-bold mb-6 text-yellow-400 capitalize border-b-2 border-yellow-600 pb-3">
                                                Page Voiture Vitrine
                                            </h2>
                                            <div className="space-y-6">
                                                {renderEditableFields(localContent.showcaseCar, 'showcaseCar')}
                                                {localContent.showcaseCar.piston && (
                                                    <div className="mt-8 pt-6 border-t-2 border-yellow-600">
                                                        <h3 className="text-xl sm:text-2xl font-bold mb-4 text-yellow-300">Détails de la Préparation</h3>
                                                        {renderEditableFields({
                                                            piston: localContent.showcaseCar.piston,
                                                            bielles: localContent.showcaseCar.bielles,
                                                            soupapes: localContent.showcaseCar.soupapes,
                                                            adm: localContent.showcaseCar.adm,
                                                            ressort: localContent.showcaseCar.ressort,
                                                            viserie: localContent.showcaseCar.viserie,
                                                            pompeHuile: localContent.showcaseCar.pompeHuile,
                                                            turbo: localContent.showcaseCar.turbo,
                                                            wastegate: localContent.showcaseCar.wastegate,
                                                            injecteurs: localContent.showcaseCar.injecteurs,
                                                            pipAdmission: localContent.showcaseCar.pipAdmission,
                                                            wmi: localContent.showcaseCar.wmi,
                                                            embrayage: localContent.showcaseCar.embrayage,
                                                        }, 'showcaseCar')}
                                                    </div>
                                                )}
                                                {/* Gestion des images de la voiture vitrine */}
                                                <AdminImageArrayEditor
                                                    label="Gérer les images de la voiture vitrine"
                                                    imagesArray={localContent.showcaseCar?.images || []}
                                                    onAddImage={handleAddShowcaseImage}
                                                    onRemoveImage={handleRemoveShowcaseImage}
                                                />
                                            </div>
                                        </div>
                                    )}

                                    {/* Section Paramètres du Site */}
                                    {activeTab === 'siteSettings' && (
                                        <div className="p-6 bg-gray-700 rounded-xl shadow-inner border border-gray-600">
                                            <h2 className="text-3xl font-bold mb-6 text-red-400 capitalize border-b-2 border-red-600 pb-3">
                                                Paramètres du Site
                                            </h2>
                                            <div className="space-y-6">
                                                {localContent.siteSettings && renderEditableFields(localContent.siteSettings, 'siteSettings')}
                                            </div>
                                        </div>
                                    )}
                                </div>
                            )}

                            <div className="flex justify-center space-x-4 mt-8">
                                <button
                                    onClick={handleSaveChanges}
                                    className="bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-6 rounded-lg shadow-md transition duration-300 ease-in-out transform hover:scale-105 active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed"
                                    disabled={isSaving}
                                >
                                    {isSaving ? 'Sauvegarde...' : 'Enregistrer les modifications'}
                                </button>
                                <button
                                    onClick={handleLogout}
                                    className="bg-red-600 hover:bg-red-700 text-white font-bold py-3 px-6 rounded-lg shadow-md transition duration-300 ease-in-out transform hover:scale-105 active:scale-95"
                                >
                                    Déconnexion
                                </button>
                            </div>
                            {saveMessage && (
                                <p className="text-center text-yellow-400 mt-4 text-md animate-fade-in">
                                    {saveMessage}
                                </p>
                            )}
                        </div>
                    </div>
                </div>
            );
        };


        // Nouveau composant pour le contrôle de la musique
        const MusicControl = ({ volume }) => { // Accepte `volume` comme prop
            const audioRef = useRef(null);
            const [isPlaying, setIsPlaying] = useState(false);
            const [showAutoplayMessage, setShowAutoplayMessage] = useState(false); // Nouvel état pour le message d'autoplay

            useEffect(() => {
                const audio = document.getElementById('background-music');
                if (audio) {
                    audioRef.current = audio;

                    // Ajuster le volume initial et à chaque changement de la prop `volume`
                    audio.volume = volume;

                    // Tentative de lecture automatique
                    const playPromise = audio.play();
                    if (playPromise !== undefined) {
                        playPromise.then(() => {
                            // Lecture automatique réussie
                            setIsPlaying(true);
                        }).catch(error => {
                            // Lecture automatique bloquée
                            console.log("La lecture automatique de la musique a été bloquée. L'utilisateur peut la démarrer manuellement.", error);
                            setIsPlaying(false); // S'assurer que l'état reflète que la musique ne joue pas
                            setShowAutoplayMessage(true); // Afficher le message
                            // Masquer le message après 5 secondes si l'utilisateur n'interagit pas
                            setTimeout(() => {
                                setShowAutoplayMessage(false);
                            }, 5000);
                        });
                    }

                    // Mettre à jour l'état isPlaying si la lecture est interrompue par l'utilisateur ou le système
                    const handleAudioPause = () => setIsPlaying(false);
                    const handleAudioPlay = () => setIsPlaying(true);

                    audio.addEventListener('pause', handleAudioPause);
                    audio.addEventListener('play', handleAudioPlay);

                    // Nettoyage de l'effet
                    return () => {
                        audio.removeEventListener('pause', handleAudioPause);
                        audio.removeEventListener('play', handleAudioPlay);
                    };
                }
            }, []); // S'exécute une seule fois au montage du composant

            // Effet pour mettre à jour le volume lorsque la prop `volume` change
            useEffect(() => {
                if (audioRef.current) {
                    audioRef.current.volume = volume;
                }
            }, [volume]);


            const togglePlayPause = () => {
                const audio = audioRef.current;
                if (audio) {
                    if (isPlaying) {
                        audio.pause();
                    } else {
                        // Tenter de jouer la musique. C'est ici que le navigateur pourrait encore bloquer si ce n'est pas initié par un geste utilisateur fort.
                        audio.play().then(() => {
                            setIsPlaying(true);
                            setShowAutoplayMessage(false); // Masquer le message si l'utilisateur interagit
                        }).catch(error => {
                            console.error("Erreur lors de la tentative de lecture par le bouton:", error);
                            // Optionnel: Afficher un message à l'utilisateur si la lecture échoue même avec le clic
                            // Utilisez une modal personnalisée si vous voulez une meilleure UX que alert()
                             // alert("Impossible de lire la musique. Votre navigateur pourrait bloquer la lecture automatique.");
                        });
                    }
                    // La mise à jour de l'état isPlaying se fait maintenant dans les handlers 'play' et 'pause' ou dans le .then()
                }
            };

            return (
                <>
                    <button
                        onClick={togglePlayPause}
                        className="fixed bottom-8 right-8 bg-red-600 hover:bg-red-700 text-white p-4 rounded-full shadow-lg transition duration-300 ease-in-out transform hover:scale-110 active:scale-90 z-50 flex items-center justify-center w-14 h-14"
                        aria-label={isPlaying ? "Mettre la musique en pause" : "Jouer la musique"}
                    >
                        {isPlaying ? <PauseIcon /> : <PlayIcon />}
                    </button>
                    {showAutoplayMessage && (
                        <div className="fixed bottom-24 right-8 bg-yellow-500 text-gray-900 px-4 py-2 rounded-lg shadow-lg text-sm animate-fade-in-down z-50">
                            Cliquez sur le bouton de lecture pour lancer la musique !
                        </div>
                    )}
                </>
            );
        };

        // Composant pour le bouton de retour en haut de page
        const ScrollToTopButton = () => {
            const [isVisible, setIsVisible] = useState(false);

            // Gère la visibilité du bouton en fonction du défilement
            const toggleVisibility = () => {
                if (window.pageYOffset > 300) { // Rend le bouton visible après 300px de défilement
                    setIsVisible(true);
                } else {
                    setIsVisible(false);
                }
            };

            // Fait défiler la page vers le haut
            const scrollToTop = () => {
                window.scrollTo({
                    top: 0,
                    behavior: 'smooth' // Défilement doux
                });
            };

            useEffect(() => {
                window.addEventListener('scroll', toggleVisibility);
                return () => {
                    window.removeEventListener('scroll', toggleVisibility);
                };
            }, []);

            return (
                <button
                    onClick={scrollToTop}
                    className={`fixed bottom-24 right-8 bg-blue-600 hover:bg-blue-700 text-white p-4 rounded-full shadow-lg transition duration-300 ease-in-out transform hover:scale-110 active:scale-90 z-50 flex items-center justify-center w-14 h-14
                               ${isVisible ? 'scroll-to-top' : 'scroll-to-top hidden'}`}
                    aria-label="Retour en haut de page"
                >
                    <ArrowUpIcon />
                </button>
            );
        };

        // Composant principal de l'application
        const App = () => {
            // Initialise isAdminAuthenticated en lisant depuis localStorage
            const [isAdminAuthenticated, setIsAdminAuthenticated] = useState(
                localStorage.getItem('isAdminAuthenticated') === 'true'
            );
            const [currentPage, setCurrentPage] = useState('accueil');
            const [content, setContent] = useState(null); // Initialiser à null, sera chargé depuis le JSON
            const [loadingContent, setLoadingContent] = useState(true); // État de chargement du contenu
            const [errorContent, setErrorContent] = useState(null); // État d'erreur de chargement du contenu
            const [isNavbarVisible, setIsNavbarVisible] = useState(true); // État de visibilité de la navbar
            const lastScrollY = useRef(0); // Dernière position de défilement connue

            // Fonction pour charger le contenu depuis content.json
            useEffect(() => {
                const fetchContent = async () => {
                    console.log("App: Attempting to fetch content.json...");
                    try {
                        const response = await fetch('content.json'); // Assurez-vous que content.json est à la racine de votre dépôt
                        if (!response.ok) {
                            throw new Error(`Erreur HTTP: ${response.status}`);
                        }
                        const data = await response.json();
                        // Assurez-vous que les structures d'images existent avec des valeurs par défaut si absentes
                        if (!data.blog) data.blog = {};
                        if (!data.blog.posts) data.blog.posts = [];
                        data.blog.posts = data.blog.posts.map(post => ({
                            ...post,
                            images: post.images || []
                        }));

                        if (!data.showcaseCar) data.showcaseCar = {};
                        if (!data.showcaseCar.images) data.showcaseCar.images = [];

                        setContent(data);
                        console.log("App: content.json loaded successfully:", data);
                    } catch (error) {
                        console.error("App: Erreur lors du chargement de content.json:", error);
                        setErrorContent("Impossible de charger le contenu du site. Veuillez réessayer plus tard. Vérifiez que 'content.json' est bien présent à la racine.");
                        // Fallback vers un contenu par défaut si le chargement échoue
                        setContent({
                            home: {
                                mainTitle: "Libérez la <span class=\"text-red-500\">Puissance</span>. Redéfinissez la <span class=\"text-blue-500\">Performance</span>!", // Mise à jour du titre
                                description: "Spécialiste de la reprogrammation moteur et de l'optimisation de véhicules. Performance, fiabilité et satisfaction client sont nos maîtres mots.",
                                contactMessage: "Contactez-nous dès aujourd'hui pour transformer votre véhicule !",
                                offerTitle: "Nos Offres",
                                offer1Title: "Reprogrammation Moteur",
                                offer1Description: "Optimisation des performances et de la consommation de votre véhicule.",
                                offer2Title: "Diagnostic Électronique",
                                offer2Description: "Identification précise des problèmes moteur et électroniques.",
                                offer3Title: "Préparation de Véhicule",
                                offer3Description: "Solutions complètes pour piste et route, du châssis au moteur.",
                                offer4Title: "Conseil Personnalisé",
                                offer4Description: "Accompagnement expert pour tous vos projets automobiles.",
                                trustTitle: "Pourquoi nous faire confiance ?",
                                trust1Title: "Rapidité d'Intervention",
                                trust1Description: "Des délais optimisés pour que vous retrouviez votre véhicule au plus vite.",
                                trust2Title: "Transparence et Confiance",
                                trust2Description: "Une communication claire et honnête à chaque étape du processus.",
                                trust3Title: "Qualité Garantie",
                                trust3Description: "Des prestations de haute qualité avec des résultats mesurables.",
                                trust4Title: "Satisfaction Client",
                                trust4Description: "Votre plaisir de conduire est notre plus grande réussite.",
                                teamTitle: "Notre Équipe",
                                teamDescription: "Notre équipe est composée de professionnels passionnés et expérimentés, dévoués à l'excellence automobile."
                            },
                            blog: {
                                mainTitle: "Notre Blog BRMOTORSPORT",
                                description: "Découvrez nos dernières actualités, projets et optimisations automobiles.",
                                posts: [
                                    { id: 1, images: ["IMG_9611.png", "Photo1.png"], title: "Porsche Cayenne V8 Bi-Turbo : Optimisation Moteur", description: "Découvrez notre travail sur cette bête de course, avec des améliorations de performances significatives pour une expérience de conduite ultime." },
                                    { id: 2, images: ["IMG_9609.png"], title: "BMW Série 2 : Reprogrammation et FAP OFF", description: "Optimisation de la BMW Série 2 avec suppression du FAP et reprogrammation moteur pour une performance accrue et une meilleure réactivité." },
                                    { id: 3, images: ["IMG_9607.png"], title: "VW Golf GTI : Boost de Performance Ultime", description: "La Golf GTI a retrouvé sa jeunesse avec une augmentation de puissance notable. Un véritable plaisir de conduite redécouvert !" },
                                    { id: 4, images: ["Seat1.png"], title: "Seat Ibiza : Amélioration de la Réactivité Moteur", description: "Transformation de cette Seat Ibiza pour une meilleure réponse à l'accélération et à une conduite plus dynamique. Un plaisir garantini." },
                                    { id: 5, images: ["IMG_9610.png"], title: "VW Golf 5 GTI : Mise à Jour Cartographie", description: "Une mise à Jour complète de la cartographie pour cette Golf 5 GTI, optimisant la puissance et la consommation. Plus performante que jamais !" },
                                    { id: 6, images: ["Photopeugeot.png", "anciennevoiture.png"], title: "Peugeot 206 1.4 HDi : Préparation Complète et Optimisation", description: "Rien n'a été laissé au hasard sur cette magnifique 206 1.4 hdi : mécanique (embrayage renforcé, turbo 1.6hdi v2, graissage renforcé, EGR off, filtre à carburant modifié, collecteur d'échappement modifié, reprogrammation sur mesure, admission sur mesure, dégazage haut moteur réaspiré, ligne tube 51mm, boost contrôleur avec réglage optimum), châssis (décrantage train arrière, combinés KW, jantes alu 16, réflexion train roulant à neuf, esthétique (passage de coque en blanc, peinture banquette couleur carrosserie, béquet 206 Rc, peinture blanche jantes, intérieur complet 206 Rc, clignotant latéral led)." },
                                    { id: 7, images: ["Seat1.png"], title: "Seat Leon : Optimisation Moteur Stage 2 (2.0 TDI 170 @230)", description: "Découvrez l'optimisation de cette Seat Leon : FAP off, EGR off, et Reprogrammation Stage 2 pour des performances accrues, passant de 170 à 230 chevaux et un couple de 370 à 450 Nm." },
                                    { id: 8, images: ["anciennevoiture.png"], title: "Ancienne Voiture : Dépannage Express et Remplacement Bobine", description: "Tombée en panne un dimanche, nous avons diagnostiqué et résolu le problème en 1h. Notre client a pu repartir avec sa voiture, grâce à une recherche de panne efficace et le remplacement de la bobine. Votre tranquillité, notre priorité." },
                                    { id: 9, images: ["audi1.png"], title: "Audi 1.5 TFSI 150 : Optimisation Stage 1 et TCU", description: "Optimisation de cette Audi 1.5 TFSI, avec un passage de 150 à 180 chevaux (Stage 1) et une modification de l'unité de contrôle de la transmission (TCU mod 1) pour une meilleure réactivité." },
                                    { id: 10, images: ["gx.png"], title: "Triumph TR3 : Check-up Complet et Optimisation", description: "Réalisation d'un check-up complet sur cette Triumph TR3, assurant son bon fonctionnement et sa fiabilité. Votre sécurité et performance notre priorité." },
                                    { id: 11, images: ["mercedes2021.png"], title: "Mercedes (2021) : Solution ADBLUE", description: "Mise en place d'une solution AdBlue pour ce modèle Mercedes 2021, garantissant la conformité environnementale et le bon fonctionnement du système." }
                                ]
                            },
                            aboutUs: {
                                mainTitle: "Qui sommes-nous ?",
                                description: "BRMOTORSPORT est votre partenaire de confiance pour l'optimisation automobile. Fondée sur la passion de la performance et de la mécanique, notre entreprise s'engage à offrir des services de reprogrammation moteur, de préparation de véhicules et de diagnostics électroniques de pointe.",
                                historyTitle: "Notre Histoire",
                                historyParagraph1: "Notre aventure a débuté il y a plusieurs années, animée par une vision : celle de repousser les limites de la performance automobile tout en garantissant une fiabilité et une sécurité optimale. Forts d'une expertise technique approfondie et d'une passion inébranlable pour les voitures, nous avons bâti BRMOTORSPORT sur des valeurs de précision, d'innovation et de dévouement. Chaque véhicule qui passe entre nos mains est traité avec le plus grand soin, comme si c'était le nôtre.",
                                historyParagraph2: "Au fil des ans, nous avons développé des compétences uniques en reprogrammation sur mesure, en travaillant avec les technologies les plus avancées pour extraire le potentiel caché de chaque moteur. Notre histoire est marquée par des milliers de clients satisfaits, des voitures transformées et une réputation bâtie sur l'excellence. Nous sommes fiers de notre parcours et de l'impact que nous avons sur la performance et le plaisir de conduite de nos clients.",
                                valuesTitle: "Nos Valeurs",
                                value1Title: "Expertise Technique",
                                value1Description: "Une connaissance approfondie des systèmes moteurs et des technologies d'optimisation.",
                                value2Title: "Innovation Continue",
                                value2Description: "Veille technologique et développement de solutions toujours plus performantes.",
                                value3Title: "Qualité et Fiabilité",
                                value3Description: "Des interventions rigoureuses pour une durabilité et une sécurité maximales.",
                                value4Title: "Service Client Exceptionnel",
                                value4Description: "Écoute, conseil personnalisé et accompagnement pour une satisfaction totale."
                            },
                            contact: {
                                mainTitle: "Contactez-nous",
                                description: "Nous sommes là pour répondre à toutes vos questions et vous accompagner dans vos projets d'optimisation automobile.",
                                emailTitle: "Email",
                                email: "contact@brmotorsport.com",
                                phoneTitle: "Téléphone",
                                phoneNumber: "06.12.34.56.78",
                                instagramTitle: "Instagram",
                                instagramHandle: "@brmotorsport_official"
                            },
                            legalMentions: {
                                mainTitle: "Mentions Légales",
                                sectionTitle: "Informations Générales",
                                paragraph1: "Ce site web est édité par BRMOTORSPORT.",
                                paragraph2: "Adresse : [Votre Adresse Complète]",
                                list1Item1: "Numéro de téléphone : [Votre Numéro de Téléphone]",
                                list1Item2: "Adresse e-mail : [Votre E-mail]",
                                list1Item3: "Numéro d'immatriculation : [Votre Numéro SIRET/RCS]",
                                paragraph3: "Directeur de la publication : Monsieur [Votre Nom]",
                                list2Item1: "Hébergeur : GitHub Pages",
                                list2Item2: "Adresse : [Adresse de GitHub]",
                                list2Item3: "Site web : https://github.com",
                                paragraph4: "Propriété intellectuelle : L'ensemble des éléments de ce site (textes, images, graphismes, logos, icônes, etc.) est la propriété exclusive de BRMOTORSPORT, sauf mention contraire. Toute reproduction, représentation, modification, publication, adaptation de tout ou partie des éléments du site, quel que soit le moyen ou le procédé utilisé, est interdite, sauf autorisation écrite préalable de BRMOTORSPORT."
                            },
                            privacyPolicy: {
                                mainTitle: "Politique de Confidentialité",
                                introTitle: "Introduction",
                                introText: "La présente politique de confidentialité décrit comment BRMOTORSPORT collecte, utilise et protège vos informations personnelles lorsque vous utilisez notre site web.",
                                collectionTitle: "Collecte des Informations Personnelles",
                                collectionText: "Nous collectons des informations lorsque vous nous contactez via le formulaire de contact, lorsque vous naviguez sur notre site, ou lorsque vous interagissez avec nos services. Les informations collectées peuvent inclure votre nom, adresse e-mail, numéro de téléphone, et toute autre information que vous choisissez de nous fournir.",
                                usageTitle: "Utilisation des Informations",
                                usageListItem1: "Pour répondre à vos demandes et vous fournir les services que vous avez sollicités.",
                                usageListItem2: "Pour améliorer notre site web et nos offres de services.",
                                usageListItem3: "Pour vous envoyer des communications marketing (avec votre consentement).",
                                protectionTitle: "Protection des Informations",
                                protectionText: "Nous mettons en œuvre diverses mesures de sécurité pour maintenir la sûreté de vos informations personnelles. Seuls les employés qui ont besoin d'effectuer un travail spécifique (par exemple, la facturation ou le service client) ont accès aux informations personnelles identifiables.",
                                rightsTitle: "Vos Droits",
                                rightsText: "Conformément au Règlement Général sur la Protection des Données (RGPD), vous disposez d'un droit d'accès, de rectification, de suppression et d'opposition au traitement de vos données personnelles. Pour exercer ces droits, veuillez nous contacter à [Votre Adresse E-mail].",
                                disclaimerText: "Cette politique de confidentialité peut être mise à jour occasionnellement. Nous vous invitons à la consulter régulièrement."
                            },
                            showcaseCar: {
                                mainTitle: "Notre Voiture Vitrine",
                                description: "Découvrez notre dernière préparation exceptionnelle : une Volkswagen Scirocco R avec une optimisation Stage 3 poussée, développant plus de 500 chevaux.",
                                images: [ // Ajoutez cette structure d'images si elle n'existe pas
                                    "Photo1.png",
                                    "photo2.png",
                                    "photo3.png",
                                    "photo4.png",
                                    "photo5.png",
                                    "photo6.png",
                                    "photo7.png",
                                    "photo8.png",
                                    "photo9.png",
                                    "photo10.png"
                                ],
                                preparationTitle: "Détails de la Préparation Stage 3",
                                preparationDescription: "Ce véhicule a subi une transformation complète pour atteindre des niveaux de performance extrêmes, tout en conservant une fiabilité optimale.",
                                piston: "Pistons forgés",
                                bielles: "Bielles forgées",
                                soupapes: "Soupapes renforcées",
                                adm: "Admission gros volume",
                                ressort: "Ressorts de soupapes renforcés",
                                viserie: "Vis de bielles, vilebrequin et culasse renforcées",
                                pompeHuile: "Pompe à huile gros débit",
                                turbo: "Turbo hybride sur mesure",
                                wastegate: "Wastegate externe",
                                injecteurs: "Injecteurs gros débit",
                                pipAdmission: "Pipe d'admission gros volume",
                                wmi: "Système WMI (Water-Methanol Injection)",
                                embrayage: "Embrayage renforcé",
                                finalDescription: "Chaque composant a été soigneusement sélectionné et installé pour garantir une synergie parfaite et une expérience de conduite inégalée sur route comme sur circuit."
                            },
                            siteSettings: { // Nouvelle section pour les paramètres du site
                                musicVolume: 0.05 // Valeur par défaut pour le volume de la musique
                            }
                        });
                    } finally {
                        setLoadingContent(false);
                    }
                };

                fetchContent();
            }, []); // S'exécute une seule fois au montage du composant

            // Fonction pour mettre à jour une partie spécifique du contenu
            const updateContent = (keyPath, newValue) => {
                setContent(prevContent => {
                    const newContent = JSON.parse(JSON.stringify(prevContent)); // Deep copy
                    setNestedProperty(newContent, keyPath, newValue);
                    // console.log(`App: Global content updated via updateContent for ${keyPath}. New content state:`, newContent);
                    return newContent;
                });
            };

            // Fonction de déconnexion de l'administrateur
            const handleLogout = () => {
                setIsAdminAuthenticated(false);
                localStorage.removeItem('isAdminAuthenticated'); // Supprime l'état d'authentification de localStorage
                setCurrentPage('accueil'); // Redirige vers l'accueil après déconnexion
            };

            // Ajout d'un effet pour faire défiler la page vers le haut à chaque changement de page
            useEffect(() => {
                window.scrollTo(0, 0); // Fait défiler la fenêtre à la position 0, 0 (en haut à gauche)
            }, [currentPage]); // Se déclenche à chaque fois que `currentPage` change

            // Logique de visibilité de la navbar au défilement
            useEffect(() => {
                const handleScroll = () => {
                    const currentScrollY = window.scrollY;
                    // Détermine la direction du défilement
                    // Si l'utilisateur est tout en haut de la page, la navbar est toujours visible
                    // Sinon, si le défilement est vers le haut (currentScrollY < lastScrollY.current), la navbar est visible
                    // Si le défilement est vers le bas (currentScrollY > lastScrollY.current) et qu'on a dépassé un certain seuil (ex: 200px), la navbar est cachée
                    if (currentScrollY === 0) {
                        setIsNavbarVisible(true);
                    } else if (currentScrollY < lastScrollY.current) {
                        setIsNavbarVisible(true);
                    } else if (currentScrollY > lastScrollY.current && currentScrollY > 200) { // Cacher si on descend et qu'on est au-delà de 200px
                        setIsNavbarVisible(false);
                    }
                    lastScrollY.current = currentScrollY;
                };

                window.addEventListener('scroll', handleScroll);
                return () => {
                    window.removeEventListener('scroll', handleScroll);
                };
            }, []);


            if (loadingContent) {
                return (
                    <div className="min-h-screen flex flex-col items-center justify-center bg-gray-900 text-white text-3xl">
                        <div className="animate-spin rounded-full h-20 w-20 border-t-4 border-b-4 border-blue-500 mb-4"></div>
                        <p>Chargement du contenu...</p>
                    </div>
                );
            }

            if (errorContent) {
                return (
                    <div className="min-h-screen flex flex-col items-center justify-center bg-red-900 text-white text-xl p-4 text-center">
                        <svg xmlns="http://www.w3.org/2000/svg" width="60" height="60" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="lucide lucide-frown-square mb-4 text-red-300">
                            <rect width="18" height="18" x="3" y="3" rx="2"/><path d="M8 16h8"/><path d="M8 8h.01"/><path d="M16 8h.01"/>
                        </svg>
                        <p className="font-bold text-2xl mb-2">Oops ! Une erreur est survenue.</p>
                        <p>{errorContent}</p>
                    </div>
                );
            }

            // Fonction de rendu du contenu de la page en fonction de l'état
            const renderPage = () => {
              switch (currentPage) {
                case 'accueil':
                  return <HomePage setCurrentPage={setCurrentPage} isAdminAuthenticated={isAdminAuthenticated} />;
                case 'blog':
                  return <BlogPage isAdminAuthenticated={isAdminAuthenticated} />;
                case 'qui-sommes-nous':
                  return <AboutUsPage isAdminAuthenticated={isAdminAuthenticated} />;
                case 'contact':
                  return <ContactPage isAdminAuthenticated={isAdminAuthenticated} />;
                case 'mentions-legales':
                  return <LegalMentionsPage isAdminAuthenticated={isAdminAuthenticated} />;
                case 'confidentialite':
                  return <PrivacyPolicyPage isAdminAuthenticated={isAdminAuthenticated} />;
                case 'voiture-vitrine':
                  return <ShowcaseCarPage isAdminAuthenticated={isAdminAuthenticated} />;
                case 'admin-login':
                  return <AdminLoginPage setIsAdminAuthenticated={setIsAdminAuthenticated} setCurrentPage={setCurrentPage} />;
                case 'admin-panel':
                  // Si l'utilisateur n'est pas authentifié, le rediriger vers la page de connexion admin
                  if (!isAdminAuthenticated) {
                    setCurrentPage('admin-login');
                    return null; // ou un composant de chargement/redirection
                  }
                  return <AdminPanelPage setIsAdminAuthenticated={setIsAdminAuthenticated} setCurrentPage={setCurrentPage} />;
                default:
                  return <HomePage setCurrentPage={setCurrentPage} isAdminAuthenticated={isAdminAuthenticated} />;
              }
            };

            // Calcule le padding-top pour le main content en fonction de la visibilité de la navbar
            // La bannière défilante a une hauteur fixe de 40px (py-2 + text-lg).
            // La navbar a un padding de p-4 (16px vertical) et une hauteur de contenu d'environ 40px, soit ~56px.
            // Total visible: 40px (bannière) + 56px (navbar) = 96px.
            // On ajoute une petite marge supplémentaire pour l'esthétique, donc 104px (pt-26).
            const mainContentPaddingTop = isNavbarVisible ? 'pt-[96px]' : 'pt-[40px]';


            return (
                <ContentContext.Provider value={{ content, updateContent }}>
                    {/* Ajout de overflow-x-hidden sur le div racine de l'application React */}
                    <div className="min-h-screen bg-black font-inter overflow-x-hidden">
                        <ScrollingBanner /> {/* Nouvelle bannière défilante */}
                        {/* Passe isAdminAuthenticated et handleLogout à Navbar, ainsi que la nouvelle prop isVisible */}
                        <Navbar setCurrentPage={setCurrentPage} isAdminAuthenticated={isAdminAuthenticated} handleLogout={handleLogout} isVisible={isNavbarVisible} />
                        <main className={`flex-grow ${mainContentPaddingTop}`}> {/* Padding dynamique */}
                            {renderPage()}
                        </main>
                        {/* Passe le volume de la musique du content aux contrôles de musique */}
                        <MusicControl volume={content?.siteSettings?.musicVolume || 0.05} />
                        <ScrollToTopButton /> {/* Ajout du bouton de retour en haut */}
                        <footer className="bg-gray-900 bg-opacity-90 backdrop-blur-sm text-gray-400 py-6 text-center shadow-inner rounded-t-lg">
                            <div className="container mx-auto px-4">
                                <p>&copy; {new Date().getFullYear()} BRMOTORSPORT. Tous droits réservés.</p>
                                <div className="flex justify-center space-x-4 mt-3">
                                    <a href="#" onClick={(e) => { e.preventDefault(); setCurrentPage('confidentialite'); }} className="hover:text-red-500 transition duration-300">Confidentialité</a>
                                    <span className="text-gray-600">|</span>
                                    <a href="#" onClick={(e) => { e.preventDefault(); setCurrentPage('mentions-legales'); }} className="hover:text-red-500 transition duration-300">Mentions Légales</a>
                                    <span className="text-gray-600">|</span>
                                    {/* Lien Admin/Déconnexion conditionnel dans le footer */}
                                    {isAdminAuthenticated ? (
                                        <a href="#" onClick={(e) => { e.preventDefault(); handleLogout(); }} className="hover:text-red-500 transition duration-300">Déconnexion</a>
                                    ) : (
                                        <a href="#" onClick={(e) => { e.preventDefault(); setCurrentPage('admin-login'); }} className="hover:text-red-500 transition duration-300">Admin</a>
                                    )}
                                </div>
                                <p className="text-sm mt-2">Réalisé avec passion par Viremot Giovanni</p>
                            </div>
                        </footer>
                    </div>
                </ContentContext.Provider>
            );
        };

        // Rendu de l'application React dans l'élément HTML avec l'ID 'root'
        const container = document.getElementById('root');
        const root = ReactDOM.createRoot(container);
        root.render(<App />);
    </script>
</body>
</html>
