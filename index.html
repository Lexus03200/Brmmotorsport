<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BRMOTORSPORT - Performance Automobile</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <style>
        /* Importation des polices Inter et Montserrat */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&family=Montserrat:wght@700;800;900&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            margin: 0;
            padding: 0;
            /* overflow-x: hidden; /* Déplacé vers #root pour une meilleure portée avec React */
        }
        h1, h2, h3 {
            font-family: 'Montserrat', sans-serif; /* Nouvelle police pour les titres */
        }
        /* Keyframes pour les animations */
        @keyframes fadeInDown {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        @keyframes bounceIn {
            0%, 20%, 40%, 60%, 80%, 100% {
                transition-timing-function: cubic-bezier(0.215, 0.610, 0.355, 1.000);
            }
            0% { opacity: 0; transform: scale3d(.3, .3, .3); }
            20% { transform: scale3d(1.1, 1.1, 1.1); }
            40% { transform: scale3d(.9, .9, .9); }
            60% { opacity: 1; transform: scale3d(1.03, 1.03, 1.03); }
            80% { transform: scale3d(.97, .97, .97); }
            100% { opacity: 1; transform: scale3d(1, 1, 1); }
        }
        @keyframes blob {
            0% { transform: translate(0px, 0px) scale(1); }
            33% { transform: translate(30px, -50px) scale(1.1); }
            66% { transform: translate(-20px, 20px) scale(0.9); }
            100% { transform: translate(0px, 0px) scale(1); }
        }
        /* Nouvelle animation pour le défilement de la bannière */
        @keyframes scrollText {
            0% { transform: translateX(0%); }
            100% { transform: translateX(-100%); }
        }
        /* Nouvelle animation pour le titre - Coulissement depuis la gauche */
        @keyframes slideInFromLeft {
            from {
                transform: translateX(-100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
        /* Nouvelle animation pour l'effet de vibration (plus douce) */
        @keyframes vibrate {
            0% { transform: translate(0px, 0px); }
            25% { transform: translate(-0.5px, 0.5px); } /* Mouvement réduit */
            50% { transform: translate(0.5px, -0.5px); }
            75% { transform: translate(-0.5px, -0.5px); }
            100% { transform: translate(0px, 0px); }
        }

        .animate-fade-in-down { animation: fadeInDown 0.8s ease-out forwards; }
        .animate-fade-in-up { animation: fadeInUp 0.8s ease-out forwards; }
        .animate-fade-in { animation: fadeIn 0.8s ease-out forwards; }
        .animate-bounce-in { animation: bounceIn 1s; }
        .animate-blob { animation: blob 7s infinite; }
        .animate-vibrate { animation: vibrate 0.15s ease-in-out infinite; } /* Vitesse ajustée à 0.15s */
        .animation-delay-2000 { animation-delay: 2s; }
        .animation-delay-4000 { animation-delay: 4s; }
        /* Style pour l'animation de défilement */
        .scrolling-banner-text {
            display: inline-block;
            white-space: nowrap;
            animation: scrollText 30s linear infinite; /* 30s pour la durée, linear pour un mouvement fluide, infinite pour la répétition */
        }
        /* Pour assurer que le texte déborde et puisse défiler */
        .scrolling-banner-container {
            overflow: hidden;
        }
        /* Application de l'animation de coulissement pour le titre */
        .animate-slide-in-left {
            animation: slideInFromLeft 1s ease-out forwards; /* Durée et type d'animation */
        }

        /* Styles supplémentaires pour des effets visuels */
        h1, h2 {
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5); /* Ombre subtile pour la profondeur */
        }
        /* Utilitaire pour décalage d'animation */
        .delay-animation {
            animation-delay: var(--delay-factor);
        }

        /* Styles spécifiques pour la Lightbox (modale) */
        .lightbox-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 100;
            animation: fadeIn 0.3s ease-out forwards;
        }

        .lightbox-content {
            position: relative;
            max-width: 90%;
            max-height: 90%;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .lightbox-image {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
            border-radius: 0.75rem;
        }

        .lightbox-button {
            background-color: rgba(0, 0, 0, 0.5);
            color: white;
            padding: 0.75rem;
            border-radius: 9999px; /* fully rounded */
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background-color 0.2s ease-in-out;
            cursor: pointer;
            position: absolute;
            z-index: 101;
        }

        .lightbox-button:hover {
            background-color: rgba(0, 0, 0, 0.8);
        }

        .lightbox-close-button {
            top: 1rem;
            right: 1rem;
        }

        .lightbox-prev-button {
            left: 1rem;
            top: 50%;
            transform: translateY(-50%);
        }

        .lightbox-next-button {
            right: 1rem;
            top: 50%;
            transform: translateY(-50%);
        }

        /* Styles pour le bouton de retour en haut */
        .scroll-to-top {
            animation: fadeIn 0.5s ease-out forwards;
        }
        .scroll-to-top.hidden {
            animation: fadeOut 0.5s ease-out forwards;
            opacity: 0;
            pointer-events: none;
        }
        @keyframes fadeOut {
            from { opacity: 1; }
            to { opacity: 0; }
        }

        /* Styles pour la navbar dynamique */
        .navbar-hidden {
            transform: translateY(-100%);
        }
        .navbar-visible {
            transform: translateY(0);
        }
        .navbar-transition {
            transition: transform 0.3s ease-in-out;
        }
    </style>
</head>
<body class="min-h-screen bg-white text-gray-900 font-inter">
    <audio id="background-music" autoplay loop volume="0.01" style="display:none;">
        <source src="musique.mp3" type="audio/mpeg"> Votre navigateur ne supporte pas l'élément audio.
    </audio>

    <div id="root" class="overflow-x-hidden"></div>

    <script type="text/babel">
        // Récupère les hooks React depuis l'objet global React
        const { useState, useEffect, useRef, createContext, useContext } = React;

        // --- Icônes Lucide React ---
        // Composant d'icône de voiture
        const CarIcon = () => (
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="lucide lucide-car">
            <path d="M19 17H5c-1.1 0-2 .9-2 2v2h18v-2c0-1.1-.9-2-2-2Z"/><path d="M7 17V5h12v12"/><path d="M18 10h-8"/><path d="M10 10v7"/>
          </svg>
        );

        // Composant d'icône de poignée de main
        const HandshakeIcon = () => (
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="lucide lucude-handshake">
            <path d="M12.23 20.73a4.7 4.7 0 0 0 6.64-6.64L12.23 7.07l-2.06 2.06"/><path d="M16 16l-3.23 3.23a4.7 4.7 0 0 1-6.64-6.64L9.07 7.07l2.06 2.06"/><path d="M14 10l-2.06 2.06"/><path d="m10 14 2.06-2.06"/>
          </svg>
        );

        // Composant d'icône de clé à molette
        const WrenchIcon = () => (
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="lucide lucide-wrench">
            <path d="M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-3.77 3.77a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1 7.94-7.94l-3.77-3.77a1 1 0 0 0-1.4 0l-1.6 1.6a1 1 0 0 0 0 1.4Z"/>
            <path d="M5.5 12.5l-3-3L12.5 2.5l3 3z"/>
          </svg>
        );

        // Composant d'icône de calendrier
        const CalendarIcon = () => (
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="lucide lucide-calendar-days">
            <path d="M8 2v4"/><path d="M16 2v4"/><rect width="18" height="18" x="3" y="4" rx="2"/><path d="M3 10h18"/><path d="M8 14h.01"/><path d="M12 14h.01"/><path d="M16 14h.01"/><path d="M8 18h.01"/><path d="M12 18h.01"/><path d="M16 18h.01"/>
          </svg>
        );

        // Composant d'icône d'utilisateurs
        const UsersIcon = () => (
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="lucide lucide-users">
            <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M22 21v-2a4 4 0 0 0-3-3.87L16 16"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/>
          </svg>
        );

        // Composant d'icône RSS
        const RssIcon = () => (
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="lucide lucide-rss">
            <path d="M4 11a9 9 0 0 1 9 9"/><path d="M4 4a16 16 0 0 1 16 16"/><circle cx="5" cy="19" r="1"/>
          </svg>
        );

        // Composant d'icône de téléphone
        const PhoneIcon = () => (
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="lucide lucide-phone">
            <path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-3.07-8.63A2 2 0 0 1 4.11 2H7c.43 0 .79.27.94.66.14.39.07.82-.2 1.1L5.05 6.05c-.35.35-.5.85-.34 1.34A19.79 19.79 0 0 0 16.92 19c.49.16.99.01 1.34-.34l2.29-2.29c.28-.27.71-.34 1.1-.2.39.14.66.5.66.94Z"/>
          </svg>
        );

        // Composant d'icône de mail
        const MailIcon = () => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="lucide lucide-mail">
              <rect width="20" height="16" x="2" y="4" rx="2"/><path d="m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7"/>
            </svg>
        );

        // Composant d'icône Instagram
        const InstagramIcon = () => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="lucide lucide-instagram">
              <rect width="20" height="20" x="2" y="2" rx="5" ry="5"/><path d="M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z"/><line x1="17.5" x2="17.5" y1="6.5" y2="6.5"/>
            </svg>
        );

        // Composant d'icône Play
        const PlayIcon = () => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="lucide lucide-play">
                <polygon points="5 3 19 12 5 21 5 3"/>
            </svg>
        );

        // Composant d'icône Pause
        const PauseIcon = () => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="lucide lucide-pause">
                <rect x="6" y="4" width="4" height="16" rx="1"/><rect x="14" y="4" width="4" height="16" rx="1"/>
            </svg>
        );

        // Composant d'icône Étoile
        const StarIcon = () => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="lucide lucide-star">
                <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/>
            </svg>
        );

        // Composant d'icône Flèche Gauche
        const ArrowLeftIcon = () => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="lucide lucide-arrow-left">
                <path d="m12 19-7-7 7-7"/><path d="M19 12H5"/>
            </svg>
        );

        // Composant d'icône Flèche Droite
        const ArrowRightIcon = () => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="lucide lucide-arrow-right">
                <path d="M5 12h14"/><path d="m12 5 7 7-7 7"/>
            </svg>
        );

        // Composant d'icône X (fermer)
        const XIcon = () => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="lucide lucide-x">
                <path d="M18 6 6 18"/><path d="m6 6 12 12"/>
            </svg>
        );

        // Composant d'icône Plus (Zoom In)
        const PlusIcon = () => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="lucide lucide-plus">
                <path d="M12 5v14"/><path d="M5 12h14"/>
            </svg>
        );

        // Composant d'icône Moins (Zoom Out)
        const MinusIcon = () => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="lucide lucide-minus">
                <path d="M5 12h14"/>
            </svg>
        );

        // Composant d'icône de cible (Centrer)
        const TargetIcon = () => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="lucide lucide-target">
                <circle cx="12" cy="12" r="10"/><circle cx="12" cy="12" r="6"/><circle cx="12" cy="12" r="2"/>
            </svg>
        );

        // Composant d'icône de rotation (Réinitialiser)
        const RotateCcwIcon = () => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="lucide lucide-rotate-ccw">
                <path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.79 2.91L3 12H3z"/><path d="M3 3v.01"/>
            </svg>
        );

        // Composant d'icône Flèche vers le haut
        const ArrowUpIcon = () => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="lucide lucide-arrow-up">
                <path d="M12 19V5"/><path d="m5 12 7-7 7 7"/>
            </svg>
        );


        // --- Contexte pour la gestion du contenu éditable ---
        const ContentContext = createContext();

        // --- Objet de contenu initial pour éviter les messages [Contenu manquant] ---
        const initialContent = {
            home: {
                mainTitle: "Révolutionnez Votre Conduite.",
                subTitle: "Spécialistes de la reprogrammation moteur et de la performance automobile. Libérez le potentiel de votre véhicule.",
                aboutTitle: "À Propos de BRMOTORSPORT",
                aboutText: "Chez BRMOTORSPORT, nous sommes passionnés par la mécanique et l'optimisation automobile. Forts de notre expertise en **reprogrammation moteur**, nous offrons des solutions sur mesure pour améliorer la puissance, le couple et l'efficacité de votre voiture. Nous travaillons avec précision et professionnalisme pour garantir des résultats optimaux et la fiabilité de votre véhicule. Notre engagement : la performance et votre satisfaction.",
                service: [
                    {
                        title: "Reprogrammation Moteur (Stage 1/2)",
                        text: "Augmentation de la puissance et du couple par optimisation de la cartographie électronique. Gains garantis et personnalisés.",
                    },
                    {
                        title: "Diagnostic Électronique Avancé",
                        text: "Identification précise des pannes et des dysfonctionnements électroniques pour une réparation ciblée et efficace.",
                    },
                    {
                        title: "Entretien et Réparation Générales",
                        text: "Services d'entretien régulier, de vidange, de freins et de réparations mécaniques pour maintenir votre véhicule en parfait état.",
                    },
                ],
                team: {
                    title: "Notre Équipe d'Experts",
                    subtitle: "Des professionnels qualifiés et passionnés au service de votre performance.",
                }
            },
            blog: {
                mainTitle: "Actualités et Conseils Automobile",
                mainSubtitle: "Nos dernières publications, tutoriels et nouveautés dans le monde du tuning et de l'optimisation moteur.",
            },
            contact: {
                mainTitle: "Contactez l'Équipe BRMOTORSPORT",
                subTitle: "Prêt à optimiser votre véhicule ? Prenez rendez-vous ou demandez un devis personnalisé.",
                contactText: "N'hésitez pas à nous appeler ou à nous envoyer un email pour toute question ou demande spécifique. Nous vous répondrons dans les plus brefs délais. Vous pouvez également utiliser notre formulaire ci-dessous.",
                email: "contact@brmotorsport.fr",
                phone: "06 12 34 56 78",
            },
            about: {
                mainTitle: "Qui Sommes-nous ?",
                subTitle: "Notre histoire, notre mission et nos valeurs au cœur de la performance.",
                historyTitle: "Notre Histoire : Nés de la Passion",
                historyText: "Fondé il y a 5 ans par un passionné de sport automobile, BRMOTORSPORT est né d'une volonté simple : rendre la performance accessible sans compromettre la fiabilité. Notre garage a rapidement évolué pour devenir une référence locale en reprogrammation moteur, grâce à notre rigueur et l'utilisation d'outils de pointe.",
                missionTitle: "Notre Mission : Votre Satisfaction",
                missionText: "Notre mission est d'offrir le meilleur service possible à nos clients, en fournissant des solutions de performance et d'entretien sur mesure, transparentes et professionnelles. Chaque voiture est traitée avec le plus grand soin, comme si c'était la nôtre.",
            },
            legal: {
                title: "Mentions Légales",
                content: "<h2>Propriétaire du site</h2><p>BRMOTORSPORT</p><h2>Hébergeur</h2><p>Ce site est hébergé par...</p><h2>Conditions Générales d'Utilisation</h2><p>L'utilisation de ce site implique l'acceptation pleine et entière des conditions générales d'utilisation...</p>",
            },
            showcase: {
                mainTitle: "Voiture Vitrine",
                subTitle: "Découvrez nos projets les plus remarquables et les préparations moteur exceptionnelles réalisées par notre équipe.",
                description: "Chaque véhicule présenté ici est le fruit d'une optimisation minutieuse, que ce soit pour le circuit ou pour un usage routier quotidien. Nous mettons en lumière les gains de performance et les modifications techniques apportées.",
            }
        };


        // Fonction utilitaire pour définir une propriété imbriquée par un chemin (similaire à lodash.set)
        const setNestedProperty = (obj, path, value) => {
            const pathParts = path.split('.');
            let current = obj;
            for (let i = 0; i < pathParts.length; i++) {
                const part = pathParts[i];
                const isLastPart = (i === pathParts.length - 1);
                // Vérifie si la partie est un index numérique (pour les tableaux)
                const isArrayIndex = !isNaN(parseInt(part)) && String(parseInt(part)) === part;

                if (isLastPart) {
                    // C'est la dernière partie du chemin, définissez la valeur
                    current[isArrayIndex ? parseInt(part) : part] = value;
                    // console.log(`setNestedProperty: SETTING final value for path part "${part}" to:`, value);
                } else {
                    // Si ce n'est pas la dernière partie, naviguez plus profondément
                    if (isArrayIndex) {
                        if (!Array.isArray(current)) {
                            console.warn(`setNestedProperty: Attempted to navigate array index ${part} on non-array:`, current);
                            return obj; // Retourne l'objet original pour éviter de le corrompre
                        }
                        if (current[parseInt(part)] === undefined || current[parseInt(part)] === null) {
                            current[parseInt(part)] = {}; // Assurez-vous que l'objet à cet index existe
                            // console.log(`setNestedProperty: Created new object at array index ${part}.`);
                        }
                        current = current[parseInt(part)];
                    } else {
                        if (typeof current[part] !== 'object' || current[part] === null) {
                            current[part] = {}; // Initialise comme objet si ce n'est pas déjà le cas
                            // console.log(`setNestedProperty: Created new object for path part "${part}".`);
                        }
                        current = current[part];
                    }
                    // console.log(`setNestedProperty: Navigated to "${part}". Current nested object:`, current);
                }
            }
            return obj; // Retourne l'objet modifié
        };

        // Composant pour l'édition de texte in-situ (utilisé hors du panneau admin pour l'affichage direct)
        const EditableText = ({ tag: Tag, contentKey, isAdminAuthenticated, className }) => {
            const { content, updateContent } = useContext(ContentContext);
            const path = contentKey.split('.'); // Ex: "home.mainTitle" -> ["home", "mainTitle"]

            // Fonction récursive pour accéder à la valeur imbriquée
            const getValue = (obj, p) => {
                let current = obj;
                for (let i = 0; i < p.length; i++) {
                    const part = p[i];
                    const isArrayIndex = !isNaN(parseInt(part)) && String(parseInt(part)) === part;

                    if (isArrayIndex) {
                        if (Array.isArray(current) && current[parseInt(part)] !== undefined) {
                            current = current[parseInt(part)];
                        } else {
                            return `[Contenu manquant ou invalide: ${contentKey}]`;
                        }
                    } else {
                        if (current && typeof current === 'object' && current.hasOwnProperty(part)) {
                            current = current[part];
                        } else {
                            return `[Contenu manquant: ${contentKey}]`;
                        }
                    }
                }
                return current;
            };

            const textValue = content ? getValue(content, contentKey.split('.')) : `Chargement...`;


            // Gérer le changement du texte (seulement si isAdminAuthenticated)
            const handleChange = (e) => {
                const newValue = e.target.value;
                updateContent(contentKey, newValue); // Appelle la fonction de mise à jour du contexte
            };

            if (isAdminAuthenticated) {
                // Si c'est un h1 ou h2, utiliser un input, sinon un textarea
                if (Tag === 'h1' || Tag === 'h2') {
                    return (
                        <input
                            type="text"
                            value={typeof textValue === 'string' ? textValue : ''} // Assurer que la valeur est une string
                            onChange={handleChange}
                            className={`${className} bg-gray-700 text-white rounded p-2 focus:ring-2 focus:ring-blue-500 w-full`}
                        />
                    );
                }
                return (
                    <textarea
                        value={typeof textValue === 'string' ? textValue : ''} // Assurer que la valeur est une string
                        onChange={handleChange}
                        className={`${className} bg-gray-700 text-white rounded p-2 focus:ring-2 focus:ring-blue-500 w-full min-h-[50px]`}
                        rows={typeof textValue === 'string' ? Math.max(3, textValue.split('\n').length) : 3} // Ajuste le nombre de lignes
                    />
                );
            }

            // Rendu normal pour les clients
            // Vérifie si textValue est une chaîne avant de le rendre
            // Utilisation de dangerouslySetInnerHTML pour le rendu HTML
            return <Tag className={className} dangerouslySetInnerHTML={{ __html: typeof textValue === 'string' ? textValue : '' }} />;
        };

        // Composant de la bannière défilante
        const ScrollingBanner = () => {
            const bannerText = "BRMOTORSPORT • VOTRE SATISFACTION EST NOTRE PRIORITÉ • "; // Texte à répéter
            const repeatedText = Array(10).fill(bannerText).join(''); // Répéter le texte plusieurs fois pour l'effet de défilement continu

            return (
                <div className="w-full bg-red-700 text-white text-lg font-bold py-2 overflow-hidden whitespace-nowrap fixed top-0 left-0 z-50 shadow-md">
                    <div className="scrolling-banner-container">
                        <span className="scrolling-banner-text">
                            {repeatedText}
                        </span>
                        <span className="scrolling-banner-text" aria-hidden="true">
                            {repeatedText} {/* Une copie pour assurer la continuité du défilement */}
                        </span>
                    </div>
                </div>
            );
        };

        // Composant de la barre de navigation
        const Navbar = ({ setCurrentPage, isAdminAuthenticated, handleLogout, isVisible }) => {
          const [isOpen, setIsOpen] = useState(false); // État pour la visibilité du menu mobile

          const toggleMenu = () => {
            setIsOpen(!isOpen);
          };

          return (
            <nav className={`bg-gray-900 bg-opacity-90 backdrop-blur-sm p-4 fixed w-full z-50 shadow-lg rounded-b-lg top-[40px] navbar-transition ${isVisible ? 'navbar-visible' : 'navbar-hidden'}`}>
              <div className="container mx-auto flex justify-between items-center px-4">
                {/* Titre BRMOTORSPORT avec un style amélioré et des couleurs et l'animation de coulissement */}
                <div className="text-2xl sm:text-3xl md:text-4xl font-extrabold tracking-widest drop-shadow-lg opacity-0 animate-slide-in-left"> {/* Ajusté pour mobile */}
                  <span className="text-red-500">BR</span>
                  <span className="text-white">MOTOR</span>
                  {/* Titre classique sans icône pour SPORT */}
                  <span className="text-blue-500">SPORT</span>
                </div>

                {/* Icône du menu hamburger pour mobile */}
                <div className="md:hidden">
                  <button onClick={toggleMenu} className="text-gray-300 hover:text-red-500 focus:outline-none focus:ring-2 focus:ring-red-500 rounded-lg p-2">
                    <svg className="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                      <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d={isOpen ? "M6 18L18 6M6 6l12 12" : "M4 6h16M4 12h16M4 18h16"}></path>
                    </svg>
                  </button>
                </div>

                {/* Menu de bureau */}
                <div className="hidden md:flex space-x-8">
                  <NavItem icon={<CarIcon />} text="Accueil" page="accueil" setCurrentPage={setCurrentPage} />
                  <NavItem icon={<StarIcon />} text="Voiture Vitrine" page="voiture-vitrine" setCurrentPage={setCurrentPage} /> {/* Ajout du lien "Voiture Vitrine" */}
                  <NavItem icon={<RssIcon />} text="Blog" page="blog" setCurrentPage={setCurrentPage} />
                  <NavItem icon={<UsersIcon />} text="Qui Sommes-nous" page="qui-sommes-nous" setCurrentPage={setCurrentPage} />
                  <NavItem icon={<PhoneIcon />} text="Contact" page="contact" setCurrentPage={setCurrentPage} />
                  {/* Lien Admin/Déconnexion conditionnel */}
                  {isAdminAuthenticated ? (
                      <NavItem text="Déconnexion" page="accueil" setCurrentPage={setCurrentPage} onClick={handleLogout} />
                  ) : (
                      <NavItem text="Admin" page="admin-login" setCurrentPage={setCurrentPage} />
                  )}
                </div>
              </div>

              {/* Menu coulissant mobile */}
              <div className={`md:hidden absolute top-full left-0 w-full bg-gray-900 bg-opacity-95 backdrop-blur-sm shadow-lg
                             transform transition-transform duration-300 ease-in-out ${isOpen ? 'translate-x-0' : '-translate-x-full'} z-40`}>
                <div className="flex flex-col items-center py-4 space-y-4">
                  <NavItem icon={<CarIcon />} text="Accueil" page="accueil" setCurrentPage={setCurrentPage} onClick={() => setIsOpen(false)} />
                  <NavItem icon={<StarIcon />} text="Voiture Vitrine" page="voiture-vitrine" setCurrentPage={setCurrentPage} onClick={() => setIsOpen(false)} /> {/* Ajout du lien "Voiture Vitrine" pour mobile */}
                  <NavItem icon={<RssIcon />} text="Blog" page="blog" setCurrentPage={setCurrentPage} onClick={() => setIsOpen(false)} />
                  <NavItem icon={<UsersIcon />} text="Qui Sommes-nous" page="qui-sommes-nous" setCurrentPage={setCurrentPage} onClick={() => setIsOpen(false)} />
                  <NavItem icon={<PhoneIcon />} text="Contact" page="contact" setCurrentPage={setCurrentPage} onClick={() => setIsOpen(false)} />
                  {/* Lien Admin/Déconnexion conditionnel pour mobile */}
                  {isAdminAuthenticated ? (
                      <NavItem text="Déconnexion" page="accueil" setCurrentPage={setCurrentPage} onClick={() => { handleLogout(); setIsOpen(false); }} />
                  ) : (
                      <NavItem text="Admin" page="admin-login" setCurrentPage={setCurrentPage} onClick={() => setIsOpen(false)} />
                  )}
                </div>
              </div>
            </nav>
          );
        };

        // Composant d'élément de navigation
        const NavItem = ({ icon, text, page, setCurrentPage, onClick }) => (
          <button
            onClick={() => {
              setCurrentPage(page);
              if (onClick) onClick(); // Appelle onClick pour fermer le menu si fourni
            }}
            className="flex items-center text-gray-300 hover:text-red-500 transition duration-300 ease-in-out transform hover:scale-105
                       px-3 py-2 rounded-lg text-sm font-medium focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-opacity-50"
          >
            {icon && <span className="mr-2 text-xl">{icon}</span>}
            {text}
          </button>
        );

        // Nouveau composant Logo pour la page d'accueil
        const Logo = ({ className }) => {
            const imageUrl = "logo.png"; // Correction: Utilisez logo.png
            const fallbackImageUrl = "https://placehold.co/150x150/000/FFF?text=BRMS+Logo"; // Image de remplacement

            return (
                <img
                    src={imageUrl}
                    alt="Logo BRMOTORSPORT"
                    className={className}
                    // Gérer les erreurs de chargement d'image pour afficher une image de remplacement
                    onError={(e) => { e.target.onerror = null; e.target.src = fallbackImageUrl; }}
                />
            );
        };

        // Composant Page d'Accueil
        const HomePage = ({ setCurrentPage, isAdminAuthenticated }) => {
            const { content } = useContext(ContentContext);

            // Données des services pour l'itération
            const services = content.home && content.home.service ? content.home.service : initialContent.home.service;

            // Images des services (placeholders, à adapter)
            const serviceImages = [
                "service_reprogrammation.jpg", // Image 1
                "service_diagnostic.jpg",      // Image 2
                "service_entretien.jpg",      // Image 3
            ];

            // Composant de carte de service
            const ServiceCard = ({ titleKey, textKey, imageSrc, index }) => (
                <div className="bg-gray-800 bg-opacity-95 p-6 rounded-xl shadow-2xl transform transition duration-500 hover:scale-[1.03] hover:shadow-red-500/50 flex flex-col items-center text-center border-t-4 border-red-600 animate-fade-in-up" style={{ '--delay-factor': `${0.2 * index}s`, animationDelay: `${0.2 * index}s` }}>
                    <div className="w-full h-48 mb-4 overflow-hidden rounded-lg shadow-lg">
                        <img src={imageSrc} alt={`Illustration ${titleKey}`} className="w-full h-full object-cover transition duration-500 hover:scale-110" />
                    </div>
                    <EditableText tag="h3" contentKey={titleKey} isAdminAuthenticated={isAdminAuthenticated} className="text-2xl font-extrabold text-red-500 mb-3" />
                    <EditableText tag="p" contentKey={textKey} isAdminAuthenticated={isAdminAuthenticated} className="text-gray-300 leading-relaxed" />
                </div>
            );


            // Composant de carte de membre de l'équipe (Placeholder)
            const TeamMemberCard = ({ name, role, photoSrc, index }) => (
                <div className="bg-white p-6 rounded-xl shadow-2xl flex flex-col items-center text-center transform transition duration-500 hover:shadow-blue-500/50 animate-fade-in" style={{ '--delay-factor': `${0.1 * index}s`, animationDelay: `${0.1 * index}s` }}>
                    <div className="w-32 h-32 mb-4 overflow-hidden rounded-full border-4 border-red-600">
                        <img src={photoSrc} alt={name} className="w-full h-full object-cover" />
                    </div>
                    <h4 className="text-xl font-extrabold text-gray-900">{name}</h4>
                    <p className="text-red-600 font-semibold">{role}</p>
                </div>
            );

            // Données de l'équipe (placeholders, à personnaliser)
            const teamMembers = [
                { name: "Bryan R.", role: "Fondateur & Expert Reprogrammation", photoSrc: "team_bryan.jpg" },
                { name: "Manon T.", role: "Responsable Clientèle & Devis", photoSrc: "team_manon.jpg" },
                { name: "Giovanni V.", role: "Technicien Diagnostic", photoSrc: "team_giovanni.jpg" },
            ];

            return (
                <div className="min-h-screen bg-white">
                    {/* Section Héros - Grand Visuel et Slogan */}
                    <header className="relative h-screen flex items-center justify-center text-white overflow-hidden pt-[80px] md:pt-[100px]"> {/* Ajustement du padding top pour la navbar */}
                        {/* Image de fond avec effet de zoom subtil */}
                        <div className="absolute inset-0 bg-cover bg-center transition duration-1000 transform scale-105" style={{ backgroundImage: "url('background_hero.jpg')" }}>
                            {/* Overlay sombre pour la lisibilité */}
                            <div className="absolute inset-0 bg-gray-900 opacity-60"></div>
                        </div>

                        {/* Contenu du Héros */}
                        <div className="relative text-center max-w-4xl px-6 z-10 animate-fade-in-down">
                            <h1 className="text-5xl sm:text-7xl md:text-8xl font-black mb-4 tracking-tight uppercase leading-tight text-shadow-lg opacity-0 animate-slide-in-left">
                                <EditableText tag="h1" contentKey="home.mainTitle" isAdminAuthenticated={isAdminAuthenticated} className="text-white inline" />
                            </h1>
                            <h2 className="text-xl sm:text-2xl md:text-3xl font-light mb-8 text-red-400 drop-shadow-md opacity-0 animate-fade-in-up animation-delay-4000" style={{ animationDelay: '0.4s' }}>
                                <EditableText tag="h2" contentKey="home.subTitle" isAdminAuthenticated={isAdminAuthenticated} className="text-red-400 inline" />
                            </h2>
                            <button
                                onClick={() => setCurrentPage('contact')}
                                className="bg-red-600 hover:bg-red-700 text-white font-bold py-3 px-8 rounded-full text-lg uppercase tracking-wider shadow-lg transition duration-300 transform hover:scale-105 hover:animate-vibrate opacity-0 animate-fade-in-up animation-delay-2000" style={{ animationDelay: '0.8s' }}
                            >
                                Demander un Devis Gratuit
                            </button>
                        </div>
                    </header>

                    {/* Section À Propos - Texte d'introduction */}
                    <section className="py-20 bg-gray-50 text-gray-900">
                        <div className="container mx-auto px-6 max-w-6xl">
                            <div className="grid md:grid-cols-2 gap-12 items-center">
                                {/* Bloc de texte à propos */}
                                <div>
                                    <p className="text-red-600 font-bold mb-3 uppercase tracking-wider">Qui sommes-nous</p>
                                    <EditableText tag="h2" contentKey="home.aboutTitle" isAdminAuthenticated={isAdminAuthenticated} className="text-4xl font-extrabold mb-6 leading-tight text-gray-900" />
                                    <EditableText tag="p" contentKey="home.aboutText" isAdminAuthenticated={isAdminAuthenticated} className="text-lg leading-relaxed text-gray-700" />
                                    <button
                                        onClick={() => setCurrentPage('qui-sommes-nous')}
                                        className="mt-8 text-red-600 hover:text-red-700 font-semibold flex items-center transition duration-300 group"
                                    >
                                        En savoir plus sur notre histoire
                                        <ArrowRightIcon className="w-5 h-5 ml-2 transition-transform group-hover:translate-x-1" />
                                    </button>
                                </div>
                                {/* Image à propos de nous */}
                                <div className="hidden md:block">
                                    <img src="about_us_image.jpg" alt="Atelier BRMOTORSPORT" className="rounded-xl shadow-3xl transform rotate-3 hover:rotate-0 transition duration-500" />
                                </div>
                            </div>
                        </div>
                    </section>

                    {/* Section Services - Cartes de Services */}
                    <section className="py-20 bg-gray-900 text-white">
                        <div className="container mx-auto px-6 max-w-6xl text-center">
                            <p className="text-red-600 font-bold mb-2 uppercase tracking-wider">Nos Expertises</p>
                            <h2 className="text-4xl font-extrabold mb-12">Des Services de Performance</h2>

                            <div className="grid md:grid-cols-3 gap-8">
                                {services.map((service, index) => (
                                    <ServiceCard
                                        key={index}
                                        titleKey={`home.service.${index}.title`}
                                        textKey={`home.service.${index}.text`}
                                        imageSrc={serviceImages[index]}
                                        index={index}
                                    />
                                ))}
                            </div>
                            <button
                                onClick={() => setCurrentPage('contact')}
                                className="mt-12 bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-8 rounded-full text-lg uppercase tracking-wider shadow-xl transition duration-300 transform hover:scale-105"
                            >
                                Réserver Votre Service
                            </button>
                        </div>
                    </section>

                    {/* Section Équipe - Meet the Team */}
                    <section className="py-20 bg-gray-50 text-gray-900">
                        <div className="container mx-auto px-6 max-w-6xl text-center">
                            <EditableText tag="h2" contentKey="home.team.title" isAdminAuthenticated={isAdminAuthenticated} className="text-4xl font-extrabold mb-4 text-gray-900" />
                            <EditableText tag="p" contentKey="home.team.subtitle" isAdminAuthenticated={isAdminAuthenticated} className="text-lg text-gray-700 mb-12" />

                            <div className="grid sm:grid-cols-2 md:grid-cols-3 gap-10">
                                {teamMembers.map((member, index) => (
                                    <TeamMemberCard
                                        key={index}
                                        name={member.name}
                                        role={member.role}
                                        photoSrc={member.photoSrc}
                                        index={index}
                                    />
                                ))}
                            </div>
                        </div>
                    </section>
                </div>
            );
        };

        // Composant de la Page Blog
        const BlogPage = ({ isAdminAuthenticated }) => {
            const { content } = useContext(ContentContext);

            // Données d'articles de blog (placeholders, à adapter)
            const blogArticles = [
                {
                    id: 1,
                    title: "Comprendre le Stage 1 : Gains et Fiabilité",
                    excerpt: "La reprogrammation Stage 1 est le moyen le plus simple d'augmenter la puissance de votre moteur sans modifications mécaniques...",
                    date: "12 Octobre 2024",
                    image: "blog_stage1.jpg",
                },
                {
                    id: 2,
                    title: "Les 5 Signes d'un Moteur Malade : Quand consulter ?",
                    excerpt: "Un bruit étrange, une perte de puissance ou une surconsommation de carburant ? Ne tardez pas à faire diagnostiquer votre véhicule...",
                    date: "01 Septembre 2024",
                    image: "blog_diagnostic.jpg",
                },
                {
                    id: 3,
                    title: "Entretien Saisonnier : Préparer votre voiture pour l'hiver",
                    excerpt: "Un guide complet pour vous assurer que votre voiture est prête à affronter les conditions hivernales...",
                    date: "20 Août 2024",
                    image: "blog_hiver.jpg",
                },
            ];

            // Composant de carte d'article
            const ArticleCard = ({ article }) => (
                <div className="bg-white rounded-xl shadow-xl overflow-hidden transform transition duration-500 hover:shadow-red-500/50 hover:-translate-y-1">
                    <img src={article.image} alt={`Image de l'article : ${article.title}`} className="w-full h-56 object-cover" />
                    <div className="p-6">
                        <p className="text-sm font-semibold text-red-600 mb-2">{article.date}</p>
                        <h3 className="text-2xl font-bold text-gray-900 mb-3">{article.title}</h3>
                        <p className="text-gray-700 mb-4">{article.excerpt}</p>
                        <a href={`#article-${article.id}`} className="text-blue-600 font-semibold hover:text-blue-800 transition duration-300 flex items-center">
                            Lire la suite
                            <ArrowRightIcon className="w-4 h-4 ml-1" />
                        </a>
                    </div>
                </div>
            );

            return (
                <div className="min-h-screen pt-[120px] bg-white"> {/* Ajustement pour la navbar */}
                    {/* Section Entête Blog */}
                    <header className="bg-gray-900 text-white py-16 mb-12">
                        <div className="container mx-auto px-6 max-w-6xl text-center">
                            <EditableText tag="h1" contentKey="blog.mainTitle" isAdminAuthenticated={isAdminAuthenticated} className="text-5xl font-extrabold mb-3" />
                            <EditableText tag="p" contentKey="blog.mainSubtitle" isAdminAuthenticated={isAdminAuthenticated} className="text-xl text-gray-400" />
                        </div>
                    </header>

                    {/* Grille d'Articles */}
                    <section className="container mx-auto px-6 max-w-6xl pb-20">
                        <div className="grid md:grid-cols-3 gap-10">
                            {blogArticles.map(article => (
                                <ArticleCard key={article.id} article={article} />
                            ))}
                        </div>
                        {/* Bouton de pagination ou de chargement */}
                        <div className="text-center mt-12">
                            <button className="bg-red-600 hover:bg-red-700 text-white font-bold py-3 px-8 rounded-full text-lg uppercase tracking-wider shadow-lg transition duration-300 transform hover:scale-105">
                                Charger Plus d'Articles
                            </button>
                        </div>
                    </section>
                </div>
            );
        };

        // Composant de la Page Contact
        const ContactPage = ({ isAdminAuthenticated }) => {
            const { content } = useContext(ContentContext);

            // Fonction de soumission (Placeholder)
            const handleSubmit = (e) => {
                e.preventDefault();
                alert("Message envoyé ! (Fonctionnalité réelle à implémenter côté serveur)");
                e.target.reset(); // Réinitialise le formulaire
            };

            const emailAddress = content.contact && content.contact.email ? content.contact.email : initialContent.contact.email;
            const phoneNumber = content.contact && content.contact.phone ? content.contact.phone : initialContent.contact.phone;

            return (
                <div className="min-h-screen pt-[120px] bg-white">
                    {/* Section Entête Contact */}
                    <header className="bg-gray-900 text-white py-16 mb-12">
                        <div className="container mx-auto px-6 max-w-6xl text-center">
                            <EditableText tag="h1" contentKey="contact.mainTitle" isAdminAuthenticated={isAdminAuthenticated} className="text-5xl font-extrabold mb-3" />
                            <EditableText tag="p" contentKey="contact.subTitle" isAdminAuthenticated={isAdminAuthenticated} className="text-xl text-gray-400" />
                        </div>
                    </header>

                    {/* Section Formulaire et Infos */}
                    <section className="container mx-auto px-6 max-w-6xl pb-20">
                        <div className="grid lg:grid-cols-3 gap-12">
                            {/* Colonne 1 : Informations de contact */}
                            <div className="lg:col-span-1 bg-gray-100 p-8 rounded-xl shadow-lg h-full">
                                <h2 className="text-3xl font-bold text-gray-900 mb-6 flex items-center">
                                    <PhoneIcon className="w-7 h-7 mr-3 text-red-600" /> Nos Coordonnées
                                </h2>
                                <EditableText tag="p" contentKey="contact.contactText" isAdminAuthenticated={isAdminAuthenticated} className="text-gray-700 mb-8 leading-relaxed" />

                                <div className="space-y-4">
                                    {/* Email */}
                                    <div className="flex items-center text-gray-900">
                                        <MailIcon className="w-6 h-6 mr-3 text-blue-600" />
                                        <div>
                                            <p className="font-semibold">Email :</p>
                                            <p className="text-red-600 hover:underline">{emailAddress}</p>
                                        </div>
                                    </div>
                                    {/* Téléphone */}
                                    <div className="flex items-center text-gray-900">
                                        <PhoneIcon className="w-6 h-6 mr-3 text-blue-600" />
                                        <div>
                                            <p className="font-semibold">Téléphone :</p>
                                            <p className="text-red-600 hover:underline">{phoneNumber}</p>
                                        </div>
                                    </div>
                                    {/* Adresse (Placeholder) */}
                                    <div className="flex items-center text-gray-900">
                                        <CarIcon className="w-6 h-6 mr-3 text-blue-600" />
                                        <div>
                                            <p className="font-semibold">Adresse :</p>
                                            <p className="text-red-600">75000 Paris, France</p>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            {/* Colonne 2 : Formulaire de contact */}
                            <div className="lg:col-span-2 bg-gray-50 p-8 rounded-xl shadow-lg">
                                <h2 className="text-3xl font-bold text-gray-900 mb-8">Formulaire de Contact</h2>
                                <form onSubmit={handleSubmit} className="space-y-6">
                                    <div>
                                        <label htmlFor="name" className="block text-sm font-medium text-gray-700">Nom et Prénom</label>
                                        <input type="text" id="name" name="name" required className="mt-1 block w-full px-4 py-3 border border-gray-300 rounded-lg shadow-sm focus:ring-red-500 focus:border-red-500 bg-white text-gray-900" />
                                    </div>
                                    <div>
                                        <label htmlFor="email" className="block text-sm font-medium text-gray-700">Adresse Email</label>
                                        <input type="email" id="email" name="email" required className="mt-1 block w-full px-4 py-3 border border-gray-300 rounded-lg shadow-sm focus:ring-red-500 focus:border-red-500 bg-white text-gray-900" />
                                    </div>
                                    <div>
                                        <label htmlFor="subject" className="block text-sm font-medium text-gray-700">Sujet</label>
                                        <input type="text" id="subject" name="subject" required className="mt-1 block w-full px-4 py-3 border border-gray-300 rounded-lg shadow-sm focus:ring-red-500 focus:border-red-500 bg-white text-gray-900" />
                                    </div>
                                    <div>
                                        <label htmlFor="message" className="block text-sm font-medium text-gray-700">Message</label>
                                        <textarea id="message" name="message" rows="4" required className="mt-1 block w-full px-4 py-3 border border-gray-300 rounded-lg shadow-sm focus:ring-red-500 focus:border-red-500 bg-white text-gray-900"></textarea>
                                    </div>
                                    <button
                                        type="submit"
                                        className="w-full bg-red-600 hover:bg-red-700 text-white font-bold py-3 px-6 rounded-lg text-lg uppercase tracking-wider shadow-lg transition duration-300 transform hover:scale-[1.01]"
                                    >
                                        Envoyer le Message
                                    </button>
                                </form>
                            </div>
                        </div>
                    </section>
                </div>
            );
        };

        // Composant de la Page Qui Sommes-nous
        const QuiSommesNousPage = ({ isAdminAuthenticated }) => {
            return (
                <div className="min-h-screen pt-[120px] bg-white">
                    {/* Section Entête */}
                    <header className="bg-gray-900 text-white py-16 mb-12">
                        <div className="container mx-auto px-6 max-w-6xl text-center">
                            <EditableText tag="h1" contentKey="about.mainTitle" isAdminAuthenticated={isAdminAuthenticated} className="text-5xl font-extrabold mb-3" />
                            <EditableText tag="p" contentKey="about.subTitle" isAdminAuthenticated={isAdminAuthenticated} className="text-xl text-gray-400" />
                        </div>
                    </header>

                    {/* Section Histoire */}
                    <section className="py-16 bg-gray-50">
                        <div className="container mx-auto px-6 max-w-6xl">
                            <div className="grid md:grid-cols-2 gap-12 items-center">
                                {/* Image Histoire */}
                                <div className="order-2 md:order-1">
                                    <img src="about_history.jpg" alt="Atelier ancien" className="rounded-xl shadow-2xl transition duration-500 hover:shadow-red-500/50" />
                                </div>
                                {/* Texte Histoire */}
                                <div className="order-1 md:order-2">
                                    <p className="text-red-600 font-bold mb-3 uppercase tracking-wider">Notre Rétrospective</p>
                                    <EditableText tag="h2" contentKey="about.historyTitle" isAdminAuthenticated={isAdminAuthenticated} className="text-4xl font-extrabold mb-6 leading-tight text-gray-900" />
                                    <EditableText tag="p" contentKey="about.historyText" isAdminAuthenticated={isAdminAuthenticated} className="text-lg leading-relaxed text-gray-700" />
                                </div>
                            </div>
                        </div>
                    </section>

                    {/* Section Mission/Valeurs */}
                    <section className="py-16 bg-white">
                        <div className="container mx-auto px-6 max-w-6xl">
                            <div className="grid md:grid-cols-2 gap-12 items-center">
                                {/* Texte Mission */}
                                <div>
                                    <p className="text-red-600 font-bold mb-3 uppercase tracking-wider">Notre Engagement</p>
                                    <EditableText tag="h2" contentKey="about.missionTitle" isAdminAuthenticated={isAdminAuthenticated} className="text-4xl font-extrabold mb-6 leading-tight text-gray-900" />
                                    <EditableText tag="p" contentKey="about.missionText" isAdminAuthenticated={isAdminAuthenticated} className="text-lg leading-relaxed text-gray-700" />
                                </div>
                                {/* Image Mission */}
                                <div>
                                    <img src="about_mission.jpg" alt="Équipe travaillant" className="rounded-xl shadow-2xl transition duration-500 hover:shadow-blue-500/50" />
                                </div>
                            </div>
                            {/* Section Valeurs Clés (supplémentaire) */}
                            <div className="mt-16 text-center">
                                <h3 className="text-3xl font-extrabold text-gray-900 mb-8">Nos Valeurs Fondamentales</h3>
                                <div className="grid sm:grid-cols-3 gap-8">
                                    <ValuePillar icon={<HandshakeIcon />} title="Transparence" description="Honnêteté totale sur les diagnostics et les tarifs." />
                                    <ValuePillar icon={<WrenchIcon />} title="Expertise" description="Utilisation des meilleures techniques et outils de l'industrie." />
                                    <ValuePillar icon={<StarIcon />} title="Passion" description="L'amour de la mécanique automobile au cœur de notre travail." />
                                </div>
                            </div>
                        </div>
                    </section>
                </div>
            );
        };

        // Composant Pilier de Valeur (utilisé dans QuiSommesNousPage)
        const ValuePillar = ({ icon, title, description }) => (
            <div className="p-6 bg-gray-100 rounded-xl shadow-lg border-t-4 border-blue-600">
                <div className="text-blue-600 w-12 h-12 mx-auto mb-4">{icon}</div>
                <h4 className="text-xl font-bold text-gray-900 mb-2">{title}</h4>
                <p className="text-gray-700">{description}</p>
            </div>
        );


        // Composant de la Page Mentions Légales
        const MentionsLegalesPage = ({ isAdminAuthenticated }) => {
            const { content } = useContext(ContentContext);
            const legalContent = content.legal && content.legal.content ? content.legal.content : initialContent.legal.content;

            return (
                <div className="min-h-screen pt-[120px] bg-white">
                    {/* Section Entête */}
                    <header className="bg-gray-900 text-white py-16 mb-12">
                        <div className="container mx-auto px-6 max-w-6xl text-center">
                            <EditableText tag="h1" contentKey="legal.title" isAdminAuthenticated={isAdminAuthenticated} className="text-5xl font-extrabold mb-3" />
                        </div>
                    </header>

                    {/* Section Contenu Légal */}
                    <section className="container mx-auto px-6 max-w-4xl pb-20">
                        <div className="bg-gray-50 p-8 rounded-xl shadow-xl text-gray-900 prose lg:prose-lg max-w-none">
                            {/* Utilisation de dangerouslySetInnerHTML pour afficher le contenu HTML des mentions légales */}
                            {isAdminAuthenticated ? (
                                <textarea
                                    value={legalContent}
                                    onChange={(e) => {
                                        // Appel direct à updateContent pour la clé legal.content
                                        const { updateContent } = useContext(ContentContext);
                                        updateContent('legal.content', e.target.value);
                                    }}
                                    className="bg-gray-200 text-gray-900 rounded p-4 focus:ring-2 focus:ring-red-500 w-full min-h-[500px]"
                                    rows={20}
                                />
                            ) : (
                                <div dangerouslySetInnerHTML={{ __html: legalContent }} />
                            )}
                            {/* Note: Dans un environnement réel, la modification des Mentions Légales en direct via l'interface admin n'est pas recommandée pour des raisons de conformité légale/versioning. Un système de validation serait préférable. */}
                        </div>
                    </section>
                </div>
            );
        };

        // Composant de la Lightbox (Modale d'Image)
        const Lightbox = ({ images, currentIndex, onClose, onNext, onPrev }) => {
            if (currentIndex === null) return null;

            const currentImage = images[currentIndex];
            const [scale, setScale] = useState(1);
            const [offset, setOffset] = useState({ x: 0, y: 0 });
            const [isDragging, setIsDragging] = useState(false);
            const dragStart = useRef({ x: 0, y: 0, offsetX: 0, offsetY: 0 });

            useEffect(() => {
                // Réinitialiser le zoom et le décalage à chaque changement d'image
                setScale(1);
                setOffset({ x: 0, y: 0 });
            }, [currentIndex]);


            // --- Gestion du Zoom et du Déplacement ---
            const handleMouseDown = (e) => {
                e.preventDefault();
                if (scale > 1) { // Seulement pour les images zoomées
                    setIsDragging(true);
                    dragStart.current = {
                        x: e.clientX,
                        y: e.clientY,
                        offsetX: offset.x,
                        offsetY: offset.y,
                    };
                }
            };

            const handleMouseMove = (e) => {
                if (!isDragging || scale <= 1) return;
                const dx = e.clientX - dragStart.current.x;
                const dy = e.clientY - dragStart.current.y;
                setOffset({
                    x: dragStart.current.offsetX + dx,
                    y: dragStart.current.offsetY + dy,
                });
            };

            const handleMouseUp = () => {
                setIsDragging(false);
            };

            const handleZoom = (zoomFactor) => {
                // Limiter le zoom entre 1 (taille réelle) et 3 (300%)
                setScale(prevScale => Math.max(1, Math.min(3, prevScale * zoomFactor)));
            };

            const resetView = () => {
                setScale(1);
                setOffset({ x: 0, y: 0 });
            };


            useEffect(() => {
                // Ajouter les écouteurs d'événements globaux pour le glisser-déposer
                window.addEventListener('mousemove', handleMouseMove);
                window.addEventListener('mouseup', handleMouseUp);
                return () => {
                    window.removeEventListener('mousemove', handleMouseMove);
                    window.removeEventListener('mouseup', handleMouseUp);
                };
            }, [isDragging, scale]); // Dépend de isDragging et scale

            // Gestion du clavier pour la navigation et la fermeture
            useEffect(() => {
                const handleKeyDown = (e) => {
                    if (e.key === 'Escape') onClose();
                    if (e.key === 'ArrowRight') onNext();
                    if (e.key === 'ArrowLeft') onPrev();
                };
                window.addEventListener('keydown', handleKeyDown);
                return () => {
                    window.removeEventListener('keydown', handleKeyDown);
                };
            }, [onClose, onNext, onPrev]);

            // Style de l'image pour le zoom et le décalage
            const imageStyle = {
                transform: `scale(${scale}) translate(${offset.x / scale}px, ${offset.y / scale}px)`,
                cursor: scale > 1 ? (isDragging ? 'grabbing' : 'grab') : 'default', // Curseur 'grab' si zoomé
                transition: isDragging ? 'none' : 'transform 0.2s ease-out', // Pas de transition lors du drag
            };

            // Options de la Lightbox
            const isFirst = currentIndex === 0;
            const isLast = currentIndex === images.length - 1;

            return ReactDOM.createPortal(
                <div className="lightbox-overlay" onClick={onClose}>
                    {/* Conteneur principal de la Lightbox */}
                    <div className="lightbox-content" onClick={e => e.stopPropagation()}>
                        {/* Image avec gestion du zoom/drag */}
                        <img
                            src={currentImage.src}
                            alt={currentImage.alt}
                            className="lightbox-image"
                            style={imageStyle}
                            onMouseDown={handleMouseDown}
                        />

                        {/* Bouton Fermer (X) */}
                        <button className="lightbox-button lightbox-close-button" onClick={onClose}>
                            <XIcon />
                        </button>

                        {/* Boutons de navigation (Précédent) */}
                        {!isFirst && (
                            <button className="lightbox-button lightbox-prev-button hidden sm:flex" onClick={onPrev}>
                                <ArrowLeftIcon />
                            </button>
                        )}

                        {/* Boutons de navigation (Suivant) */}
                        {!isLast && (
                            <button className="lightbox-button lightbox-next-button hidden sm:flex" onClick={onNext}>
                                <ArrowRightIcon />
                            </button>
                        )}

                        {/* Barre d'outils de zoom/navigation en bas */}
                        <div className="absolute bottom-4 bg-gray-900 bg-opacity-70 p-3 rounded-xl shadow-2xl flex space-x-4 text-white">
                            <span className="flex items-center text-sm">Image {currentIndex + 1} / {images.length}</span>
                            <div className="flex space-x-2">
                                <button className="p-1 rounded-full hover:bg-gray-700 transition" onClick={() => handleZoom(1.2)}>
                                    <PlusIcon className="w-5 h-5" />
                                </button>
                                <button className="p-1 rounded-full hover:bg-gray-700 transition" onClick={() => handleZoom(0.8)}>
                                    <MinusIcon className="w-5 h-5" />
                                </button>
                                {scale > 1 && (
                                    <button className="p-1 rounded-full hover:bg-gray-700 transition" onClick={resetView}>
                                        <TargetIcon className="w-5 h-5" />
                                    </button>
                                )}
                            </div>
                        </div>
                    </div>
                </div>,
                document.body
            );
        };


        // Composant de la Page Voiture Vitrine
        const VoitureVitrinePage = ({ isAdminAuthenticated }) => {
            const { content } = useContext(ContentContext);
            const [lightboxIndex, setLightboxIndex] = useState(null); // État pour la Lightbox

            // Données des projets (placeholders)
            const projects = [
                {
                    id: 1,
                    title: "BMW M3 G80 - Stage 2 (510cv -> 650cv)",
                    description: "Reprogrammation Stage 2 avec ligne d'échappement complète et admission optimisée. Performances stupéfiantes, son agressif.",
                    specifications: [
                        { label: "Modèle", value: "BMW M3 G80" },
                        { label: "Année", value: "2023" },
                        { label: "Puissance Stock", value: "510 ch / 650 Nm" },
                        { label: "Puissance Modifiée", value: "650 ch / 800 Nm" },
                    ],
                    images: [
                        { src: "m3_g80_1.jpg", alt: "BMW M3 G80 Avant" },
                        { src: "m3_g80_2.jpg", alt: "BMW M3 G80 Moteur" },
                        { src: "m3_g80_3.jpg", alt: "BMW M3 G80 Arrière" },
                    ],
                },
                {
                    id: 2,
                    title: "Audi RS3 8V - Stage 1 (400cv -> 480cv)",
                    description: "Optimisation logicielle Stage 1 offrant un gain significatif et une meilleure réactivité du moteur 2.5 TFSI.",
                    specifications: [
                        { label: "Modèle", value: "Audi RS3 8V" },
                        { label: "Année", value: "2019" },
                        { label: "Puissance Stock", value: "400 ch / 480 Nm" },
                        { label: "Puissance Modifiée", value: "480 ch / 600 Nm" },
                    ],
                    images: [
                        { src: "rs3_8v_1.jpg", alt: "Audi RS3 8V Avant" },
                        { src: "rs3_8v_2.jpg", alt: "Audi RS3 8V Intérieur" },
                    ],
                },
                // Ajoutez plus de projets ici
            ];

            const handleImageClick = (project, imageIndex) => {
                const globalIndex = projects.findIndex(p => p.id === project.id) * 100 + imageIndex; // Une façon de gérer l'index si on voulait un carrousel global
                setLightboxIndex(imageIndex); // Simplification: on n'affiche que les images du projet sélectionné
                // Pour une implémentation complète, il faudrait passer le tableau d'images du projet, et le carrousel ne naviguerait qu'à l'intérieur de ce projet.
            };

            // Fonctionnalités de navigation de la lightbox pour le projet actuel
            const currentProjectImages = projects[0].images; // Simplification: utilise les images du premier projet
            const handleNext = () => {
                if (lightboxIndex < currentProjectImages.length - 1) {
                    setLightboxIndex(lightboxIndex + 1);
                }
            };
            const handlePrev = () => {
                if (lightboxIndex > 0) {
                    setLightboxIndex(lightboxIndex - 1);
                }
            };


            // Composant de carte de projet
            const ProjectCard = ({ project, index }) => (
                <div className="bg-white rounded-xl shadow-2xl overflow-hidden mb-12 transform transition duration-500 hover:shadow-red-500/50 hover:scale-[1.01] border-t-4 border-red-600">
                    <div className="p-6">
                        <h3 className="text-3xl font-extrabold text-gray-900 mb-3">{project.title}</h3>
                        <p className="text-gray-600 mb-6">{project.description}</p>

                        {/* Caractéristiques */}
                        <div className="grid grid-cols-2 sm:grid-cols-4 gap-4 mb-6 text-sm font-semibold">
                            {project.specifications.map((spec, i) => (
                                <div key={i} className="bg-gray-100 p-3 rounded-lg text-center">
                                    <p className="text-xs text-red-600 uppercase">{spec.label}</p>
                                    <p className="text-gray-900 font-bold">{spec.value}</p>
                                </div>
                            ))}
                        </div>

                        {/* Galerie d'images */}
                        <div className="grid grid-cols-2 md:grid-cols-3 gap-3">
                            {project.images.map((image, i) => (
                                <div key={i} className="relative aspect-video overflow-hidden rounded-lg cursor-pointer group" onClick={() => setLightboxIndex(i)}>
                                    <img src={image.src} alt={image.alt} className="w-full h-full object-cover transition duration-300 group-hover:scale-105" />
                                    <div className="absolute inset-0 bg-black bg-opacity-30 flex items-center justify-center opacity-0 group-hover:opacity-100 transition duration-300">
                                        <PlusIcon className="w-8 h-8 text-white" />
                                    </div>
                                </div>
                            ))}
                        </div>
                    </div>
                </div>
            );


            return (
                <div className="min-h-screen pt-[120px] bg-gray-50">
                    {/* Section Entête */}
                    <header className="bg-gray-900 text-white py-16 mb-12">
                        <div className="container mx-auto px-6 max-w-6xl text-center">
                            <EditableText tag="h1" contentKey="showcase.mainTitle" isAdminAuthenticated={isAdminAuthenticated} className="text-5xl font-extrabold mb-3" />
                            <EditableText tag="p" contentKey="showcase.subTitle" isAdminAuthenticated={isAdminAuthenticated} className="text-xl text-gray-400" />
                        </div>
                    </header>

                    {/* Description générale */}
                    <section className="container mx-auto px-6 max-w-4xl text-center mb-12">
                         <EditableText tag="p" contentKey="showcase.description" isAdminAuthenticated={isAdminAuthenticated} className="text-lg text-gray-700 leading-relaxed" />
                    </section>

                    {/* Grille des Projets */}
                    <section className="container mx-auto px-6 max-w-6xl pb-20">
                        {projects.map((project, index) => (
                            <ProjectCard key={project.id} project={project} index={index} />
                        ))}
                    </section>

                    {/* Lightbox pour la visualisation des images */}
                    <Lightbox
                        images={currentProjectImages} // Simplification
                        currentIndex={lightboxIndex}
                        onClose={() => setLightboxIndex(null)}
                        onNext={handleNext}
                        onPrev={handlePrev}
                    />
                </div>
            );
        };

        // Composant Page de Connexion Admin
        const AdminLoginPage = ({ handleLogin }) => {
            const [username, setUsername] = useState('');
            const [password, setPassword] = useState('');
            const [error, setError] = useState('');

            const handleSubmit = (e) => {
                e.preventDefault();

                // Logique de vérification simple (simulée)
                if (username === 'admin' && password === 'admin123') { // Mot de passe bidon
                    handleLogin();
                } else {
                    setError("Nom d'utilisateur ou mot de passe incorrect.");
                    // Vider les champs après l'erreur
                    setUsername('');
                    setPassword('');
                }
            };

            return (
                <div className="min-h-screen pt-[120px] flex items-center justify-center bg-gray-50">
                    <div className="w-full max-w-md bg-white p-8 rounded-xl shadow-2xl border-t-4 border-red-600">
                        <h2 className="text-4xl font-extrabold text-center text-gray-900 mb-6">Accès Administration</h2>
                        <p className="text-center text-gray-600 mb-8">Connectez-vous pour éditer le contenu de votre site.</p>

                        <form onSubmit={handleSubmit} className="space-y-6">
                            <div>
                                <label htmlFor="username" className="block text-sm font-medium text-gray-700">Nom d'utilisateur</label>
                                <input
                                    type="text"
                                    id="username"
                                    name="username"
                                    required
                                    value={username}
                                    onChange={(e) => setUsername(e.target.value)}
                                    className="mt-1 block w-full px-4 py-3 border border-gray-300 rounded-lg shadow-sm focus:ring-red-500 focus:border-red-500 bg-white text-gray-900"
                                />
                            </div>
                            <div>
                                <label htmlFor="password" className="block text-sm font-medium text-gray-700">Mot de passe</label>
                                <input
                                    type="password"
                                    id="password"
                                    name="password"
                                    required
                                    value={password}
                                    onChange={(e) => setPassword(e.target.value)}
                                    className="mt-1 block w-full px-4 py-3 border border-gray-300 rounded-lg shadow-sm focus:ring-red-500 focus:border-red-500 bg-white text-gray-900"
                                />
                            </div>

                            {error && (
                                <p className="text-red-600 text-sm font-semibold text-center">{error}</p>
                            )}

                            <button
                                type="submit"
                                className="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-6 rounded-lg text-lg uppercase tracking-wider shadow-lg transition duration-300 transform hover:scale-[1.01]"
                            >
                                Se Connecter
                            </button>
                        </form>
                    </div>
                </div>
            );
        };


        // Composant principal de l'application
        const App = () => {
            const [currentPage, setCurrentPage] = useState('accueil');
            const [isAdminAuthenticated, setIsAdminAuthenticated] = useState(false);
            // --- CORRECTION: Utiliser l'objet initial complet pour l'état du contenu ---
            const [content, setContent] = useState(initialContent);
            const [showScrollToTop, setShowScrollToTop] = useState(false);
            const [isNavbarVisible, setIsNavbarVisible] = useState(true);
            const lastScrollY = useRef(0);

            // Gestion de la navigation
            const renderPage = () => {
                switch (currentPage) {
                    case 'blog':
                        return <BlogPage isAdminAuthenticated={isAdminAuthenticated} />;
                    case 'qui-sommes-nous':
                        return <QuiSommesNousPage isAdminAuthenticated={isAdminAuthenticated} />;
                    case 'contact':
                        return <ContactPage isAdminAuthenticated={isAdminAuthenticated} />;
                    case 'admin-login':
                        return <AdminLoginPage handleLogin={handleLogin} />;
                    case 'mentions-legales':
                        return <MentionsLegalesPage isAdminAuthenticated={isAdminAuthenticated} />;
                    case 'voiture-vitrine':
                        return <VoitureVitrinePage isAdminAuthenticated={isAdminAuthenticated} />;
                    case 'accueil':
                    default:
                        return <HomePage setCurrentPage={setCurrentPage} isAdminAuthenticated={isAdminAuthenticated} />;
                }
            };

            // Fonction de mise à jour du contenu pour l'édition en direct
            const updateContent = (key, value) => {
                // console.log(`Attempting to update key: ${key} with value:`, value);
                setContent(prevContent => {
                    // Créer une copie profonde de l'état précédent
                    const newContent = JSON.parse(JSON.stringify(prevContent));
                    // Utiliser la fonction utilitaire pour définir la propriété imbriquée
                    setNestedProperty(newContent, key, value);
                    // console.log("New content after update:", newContent);
                    return newContent;
                });
            };

            // Fonctions de connexion/déconnexion
            const handleLogin = () => {
                setIsAdminAuthenticated(true);
                setCurrentPage('accueil'); // Retourne à l'accueil après connexion
            };

            const handleLogout = () => {
                setIsAdminAuthenticated(false);
                setCurrentPage('accueil');
            };

            // --- Logique de gestion du défilement (Scroll-to-Top et Navbar) ---
            useEffect(() => {
                const handleScroll = () => {
                    const currentScrollY = window.scrollY;

                    // Gérer le bouton Scroll-to-Top
                    setShowScrollToTop(currentScrollY > 300);

                    // Gérer la visibilité de la Navbar
                    // Masquer si on défile vers le bas et qu'on est au-delà de la zone de la bannière (ex: 100px)
                    if (currentScrollY > lastScrollY.current && currentScrollY > 100) {
                        setIsNavbarVisible(false);
                    }
                    // Afficher si on défile vers le haut ou si on est en haut de la page
                    if (currentScrollY < lastScrollY.current || currentScrollY < 100) {
                        setIsNavbarVisible(true);
                    }

                    lastScrollY.current = currentScrollY;
                };

                window.addEventListener('scroll', handleScroll, { passive: true });

                return () => window.removeEventListener('scroll', handleScroll);
            }, []); // Exécuté une seule fois

            // Fonction pour remonter en haut de page
            const scrollToTop = () => {
                window.scrollTo({
                    top: 0,
                    behavior: 'smooth'
                });
            };

            // --- Logique de gestion de l'audio ---
            useEffect(() => {
                const audio = document.getElementById('background-music');
                if (audio) {
                    // Tente de jouer l'audio. Peut échouer si le navigateur bloque l'autoplay.
                    audio.play().catch(error => {
                        console.log("Autoplay bloqué. L'utilisateur devra interagir pour activer l'audio.");
                        // Afficher un bouton de lecture ou un message si l'autoplay est bloqué.
                    });
                }
            }, []);

            // Composant de contrôle de l'audio
            const AudioControl = () => {
                const audio = document.getElementById('background-music');
                const [isPlaying, setIsPlaying] = useState(true); // Supposons qu'il doit jouer initialement

                useEffect(() => {
                    if (audio) {
                        const checkPlayStatus = () => {
                            setIsPlaying(!audio.paused);
                        };
                        audio.addEventListener('play', checkPlayStatus);
                        audio.addEventListener('pause', checkPlayStatus);

                        // Vérifier l'état initial après un court délai
                        setTimeout(checkPlayStatus, 100);

                        return () => {
                            audio.removeEventListener('play', checkPlayStatus);
                            audio.removeEventListener('pause', checkPlayStatus);
                        };
                    }
                }, []);

                const togglePlay = () => {
                    if (audio) {
                        if (audio.paused) {
                            audio.play();
                            setIsPlaying(true);
                        } else {
                            audio.pause();
                            setIsPlaying(false);
                        }
                    }
                };

                return (
                    <button
                        onClick={togglePlay}
                        className="bg-gray-900 bg-opacity-70 backdrop-blur-sm text-white p-3 rounded-full shadow-lg fixed bottom-6 right-6 z-[60] transition duration-300 hover:bg-red-600 focus:outline-none focus:ring-4 focus:ring-red-500"
                        title={isPlaying ? "Mettre en pause la musique de fond" : "Jouer la musique de fond"}
                    >
                        {isPlaying ? <PauseIcon /> : <PlayIcon />}
                    </button>
                );
            };


            return (
                <ContentContext.Provider value={{ content, updateContent }}>
                    <div className="relative">
                        {/* Bannière défilante tout en haut */}
                        <ScrollingBanner />
                        {/* Barre de navigation */}
                        <Navbar
                            setCurrentPage={setCurrentPage}
                            isAdminAuthenticated={isAdminAuthenticated}
                            handleLogout={handleLogout}
                            isVisible={isNavbarVisible}
                        />

                        <main>
                            {renderPage()}
                        </main>

                        {/* Bouton de retour en haut */}
                        <button
                            onClick={scrollToTop}
                            className={`scroll-to-top fixed bottom-24 right-6 bg-red-600 text-white p-3 rounded-full shadow-lg z-50 transition duration-300 hover:bg-red-700 ${showScrollToTop ? 'opacity-100' : 'opacity-0 pointer-events-none'}`}
                            title="Remonter en haut de page"
                        >
                            <ArrowUpIcon />
                        </button>

                        {/* Contrôle de l'audio */}
                        <AudioControl />

                        {/* Footer - Pied de page */}
                        <footer className="bg-gray-900 text-gray-400 py-10">
                            <div className="container mx-auto px-6 max-w-6xl text-center">
                                {/* Logo et Slogan */}
                                <div className="mb-6">
                                    <h3 className="text-3xl font-extrabold tracking-widest">
                                        <span className="text-red-500">BR</span>
                                        <span className="text-white">MOTOR</span>
                                        <span className="text-blue-500">SPORT</span>
                                    </h3>
                                    <p className="text-gray-500 mt-2">L'excellence au service de votre véhicule.</p>
                                </div>

                                {/* Liens Sociaux */}
                                <div className="flex justify-center space-x-6 mb-8">
                                    <a href="#" className="text-gray-400 hover:text-red-500 transition duration-300" title="Instagram">
                                        <InstagramIcon />
                                    </a>
                                    <a href="#" className="text-gray-400 hover:text-red-500 transition duration-300" title="Facebook">
                                        {/* Icône Facebook (Placeholder) */}
                                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" className="lucide lucide-facebook">
                                            <path d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z"/>
                                        </svg>
                                    </a>
                                    <a href={`mailto:${content.contact?.email || initialContent.contact.email}`} className="text-gray-400 hover:text-red-500 transition duration-300" title="Email">
                                        <MailIcon />
                                    </a>
                                    <a href={`tel:${content.contact?.phone || initialContent.contact.phone}`} className="text-gray-400 hover:text-red-500 transition duration-300" title="Téléphone">
                                        <PhoneIcon />
                                    </a>
                                </div>

                                {/* Navigation Footer */}
                                <div className="flex flex-wrap justify-center space-x-4 sm:space-x-6 text-sm font-medium">
                                    <a href="#" onClick={(e) => { e.preventDefault(); setCurrentPage('accueil'); }} className="hover:text-red-500 transition duration-300">Accueil</a>
                                    <span className="text-gray-600">|</span>
                                    <a href="#" onClick={(e) => { e.preventDefault(); setCurrentPage('voiture-vitrine'); }} className="hover:text-red-500 transition duration-300">Vitrine</a>
                                    <span className="text-gray-600">|</span>
                                    <a href="#" onClick={(e) => { e.preventDefault(); setCurrentPage('blog'); }} className="hover:text-red-500 transition duration-300">Blog</a>
                                    <span className="text-gray-600">|</span>
                                    <a href="#" onClick={(e) => { e.preventDefault(); setCurrentPage('qui-sommes-nous'); }} className="hover:text-red-500 transition duration-300">Qui Sommes-nous</a>
                                    <span className="text-gray-600">|</span>
                                    <a href="#" onClick={(e) => { e.preventDefault(); setCurrentPage('contact'); }} className="hover:text-red-500 transition duration-300">Contact</a>
                                    <span className="text-gray-600">|</span>
                                    <a href="#" onClick={(e) => { e.preventDefault(); setCurrentPage('mentions-legales'); }} className="hover:text-red-500 transition duration-300">Mentions Légales</a>
                                    <span className="text-gray-600">|</span>
                                    {/* Lien Admin/Déconnexion conditionnel dans le footer */}
                                    {isAdminAuthenticated ? (
                                        <a href="#" onClick={(e) => { e.preventDefault(); handleLogout(); }} className="hover:text-red-500 transition duration-300">Déconnexion</a>
                                    ) : (
                                        <a href="#" onClick={(e) => { e.preventDefault(); setCurrentPage('admin-login'); }} className="hover:text-red-500 transition duration-300">Admin</a>
                                    )}
                                </div>
                                <p className="text-sm mt-2">Réalisé avec passion par Viremot Giovanni</p>
                            </div>
                        </footer>
                    </div>
                </ContentContext.Provider>
            );
        };

        // Rendu de l'application React dans l'élément HTML avec l'ID 'root'
        const container = document.getElementById('root');
        const root = ReactDOM.createRoot(container);
        root.render(<App />);
    </script>
</body>
</html>
